# Power BI Solution Documentation

Generated by Langchain Documentation Agent
Date: 2025-04-24 15:29:52

## Table of Contents

* [1. Overview](#1-overview)
* [2. Data Model](#2-data-model)
  * [2.2 Tables](#22-tables)
  * [2.3 Measures](#23-measures)
  * [2.4 Relationships](#24-relationships)
* [3. Visuals (Based on Configuration)](#3-visuals-based-on-configuration)

---

## 1. Overview

The Power BI solution presented is designed to analyze and visualize timesheet data, focusing on key performance metrics such as sales amounts, hours worked, and project management statistics. The solution utilizes a complex data model that integrates multiple tables, including `vw_Timesheet`, `tbl_Project`, and `DimDate`, to provide a comprehensive view of employee performance and project profitability. Key measures such as total hours, sales amounts, average hourly rates, and project margins are calculated to facilitate in-depth analysis.

The primary components of this solution include various calculated measures and columns that summarize data, such as `Sum(vw_Timesheet.SalesAmount)` and `Sum(vw_Timesheet.Hours)`, which are pivotal for generating insights into revenue and resource allocation. Additionally, the solution features visual elements like pivot tables that allow users to drill down into specific projects, clients, and time periods, enhancing the ability to track performance over time. Overall, this Power BI solution serves as a powerful tool for organizations to monitor and optimize their project management and financial performance.

## 2. Data Model

### 2.1 Model Diagram

(Error generating diagram: "Input to ChatPromptTemplate is missing variables {' for OneToMany, '}.  Expected: [' for OneToMany, ', 'relationships', 'tables'] Received: ['tables', 'relationships']\nNote: if you intended { for OneToMany, } to be part of the string and not a variable, please escape it with double curly braces like: '{{ for OneToMany, }}'.\nFor troubleshooting, visit: https://python.langchain.com/docs/troubleshooting/errors/INVALID_PROMPT_INPUT ")

### 2.2 Tables

#### Table: `dim_date`

### Table: dim_date

**Description:**  
The `dim_date` table serves as a date dimension, providing various attributes related to dates for analytical purposes. It is used to facilitate time-based analysis in reporting and data visualization.

**Key Columns:**
- **DateKey** (int64): A unique identifier for each date.
- **ShortDate** (dateTime): The date in a long date format.
- **DayName** (string): The name of the day (e.g., Monday).
- **DayNumberOfWeek** (int64): The numerical representation of the day in the week (1-7).
- **DayNumberOfMonth** (int64): The day of the month (1-31).
- **DayNumberOfYear** (int64): The day of the year (1-365/366).
- **WeekNumberOfYear** (int64): The week number in the year.
- **MonthName** (string): The name of the month.
- **MonthNumberOfYear** (int64): The month number (1-12).
- **CalendarQuarter** (string): The quarter of the year (e.g., Q1).
- **CalendarYear** (int64): The year of the date.
- **CurrentYearFlag** (int64): A flag indicating if the date is in the current year (1 for yes, 0 for no).

#### Table: `onedrive_unit`

### Table: onedrive_unit

**Description:**  
The `onedrive_unit` table is designed to provide a lookup for organizational units, binding to the conceptual entity `lkp_Unit`. It serves as a reference for various unit-related attributes within the data model.

**Key Columns:**
- **Organisatorische eenheid**: (DataType: string) Represents the organizational unit.
- **BillableDep**: (DataType: int64) Indicates the billable department, summarized by sum.
- **Unit**: (DataType: string) Represents the unit name.
- **OWN-Sub-ExtT**: (DataType: string) Additional unit-related information.

#### Table: `tbl_project`

### Table: tbl_project

**Description:**  
The `tbl_project` table is designed to store information related to various projects, including their identifiers, descriptions, statuses, financial details, and key dates.

**Key Columns:**
- **ProjectKey** (int64): Unique identifier for each project.
- **Project** (string): Name of the project.
- **ProjectDescription** (string): Detailed description of the project.
- **ProjectGroup** (string): Group to which the project belongs.
- **ProjectGroupDescription** (string): Description of the project group.
- **Statuscode** (string): Code representing the project's status.
- **Status** (string): Current status of the project.
- **ProjectleaderId** (string): Identifier for the project leader.
- **Administration** (string): Administrative details related to the project.
- **Currency** (string): Currency used for financial transactions.
- **TotalContractSum** (decimal): Total sum of the contract associated with the project.
- **SalesPriceBaseCurrency** (decimal): Sales price in the base currency.
- **DateCreated** (dateTime): Date when the project was created.
- **Startdate** (dateTime): Start date of the project.
- **PlannedCompletionDate** (dateTime): Expected completion date of the project.

#### Table: `vw_Timesheet`

### Table: vw_Timesheet

**Purpose:** The `vw_Timesheet` table is designed to aggregate and analyze timesheet data, including employee hours, contract statuses, and project details.

**Key Columns:**
- **Approved_With_V_Z:** Indicates if a timesheet is approved or has a specific TimesheetCode ("V" or "Z").
- **Employee_WeeklyHours:** Concatenates employee names with their corresponding hours per week.
- **Join_Key:** A unique identifier for joining with other tables.
- **RReady_With_V_Z:** Indicates if a report is ready or has a specific TimesheetCode ("V" or "Z").
- **Own-Sub-ExtT:** Related information from the `lkp_Unit` table.
- **ContractStatusTodayPBI:** Current status of the contract.
- **Index:** A sequential identifier for each entry.
- **IPM_ManagerName:** Name of the IPM manager associated with the timesheet.
- **IPMIDName:** Identifier for the IPM.
- **ReportingEntity:** Classifies the reporting entity based on the employer.
- **cc_Employer:** Categorizes employers into specific groups based on predefined conditions.

**Measures:**
- **HoursDifference:** Calculates the difference between total hours and maximum hours per week.
- **ContractStatusMeasure:** Determines if a contract is active based on the end date.
- **TotalHoursTracked:** Sums the total hours tracked, handling blanks appropriately.
- **TotalContractedHours:** Sums the maximum hours per week for each employee.

This table serves as a comprehensive source for tracking employee hours, contract statuses, and project-related metrics.

#### Table: `vw_missing_timesheet`

### Table: vw_missing_timesheet

**Description:**  
The `vw_missing_timesheet` table is designed to track and analyze missing timesheet entries for employees. It provides insights into hours worked versus contracted hours, identifies employees with missing timesheets, and calculates various metrics related to timesheet completeness.

**Key Columns:**
- `Year_`: The year of the timesheet entry.
- `Week_`: The week number of the timesheet entry.
- `ShortDate`: The date of the timesheet entry.
- `ManagerID`: The identifier for the manager associated with the employee.
- `EmployeeID`: The unique identifier for the employee.
- `EmployeeName`: The name of the employee.
- `ContractHours`: The number of hours contracted for the employee.
- `Hours_`: The actual hours worked by the employee.
- `MissingHours`: The difference between contracted hours and actual hours worked.

### 2.3 Measures

#### Measure: `ContractStatus2`

### Measure: ContractStatus2

**Purpose:**  
The `ContractStatus2` measure evaluates the status of a contract based on the calculated `ContractStatusMeasure` and the difference in hours worked.

**Calculation Logic:**  
The measure uses an `IF` statement to check if the `ContractStatusMeasure` is "Active". If it is, it returns the value of the `HoursDifference` measure. If the contract status is not "Active", it returns "Not Active".

**Formula:**  
```DAX
IF(
    [ContractStatusMeasure] = "Active",
    [HoursDifference],
    "Not Active"
)
``` 

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `ContractStatusMeasure`

### ContractStatusMeasure

**Purpose:**  
The `ContractStatusMeasure` is used to determine the current status of a contract based on its end date.

**Calculation Logic:**  
The measure evaluates whether the maximum contract end date from the `vw_Timesheet` table is blank or greater than today's date. If either condition is true, it returns "Active"; otherwise, it returns "Not Active".

**Formula:**  
```DAX
IF(
    ISBLANK(MAX('vw_Timesheet'[ContractEndDate])) || MAX('vw_Timesheet'[ContractEndDate]) > TODAY(),
    "Active",
    "Not Active"
)
```

#### Measure: `CountNegativeMissingHours`

### Measure: CountNegativeMissingHours

**Purpose:**  
The `CountNegativeMissingHours` measure calculates the number of distinct employees who have negative missing hours recorded in the `vw_missing_timesheet` table.

**Calculation Logic:**  
The measure uses the `CALCULATE` function to modify the filter context and applies a condition to count only those employees whose `MissingHours` are less than zero. The formula is as follows:

```DAX
CountNegativeMissingHours = 
CALCULATE(
    DISTINCTCOUNT('vw_missing_timesheet'[EmployeeID]),
    'vw_missing_timesheet'[MissingHours] < 0
)
```

**Format:**  
The result is formatted as a whole number (0).

#### Measure: `Count_Negative_Consultant`

### Measure: Count_Negative_Consultant

**Purpose:**  
The `Count_Negative_Consultant` measure calculates the number of distinct consultants (employees) who have recorded negative missing hours in the `vw_missing_timesheet` table.

**Calculation Logic:**  
The measure uses the following DAX formula:

```DAX
Count_Negative_Consultant = 
CALCULATE(
    DISTINCTCOUNT('vw_missing_timesheet'[EmployeeName]),
    'vw_missing_timesheet'[MissingHours] < 0
)
```

This formula counts the unique `EmployeeName` entries where the `MissingHours` are less than zero. The result is formatted as a whole number (0).

#### Measure: `CurrentWeekCard`

### Measure: CurrentWeekCard

**Purpose:**  
The `CurrentWeekCard` measure is designed to return the current week number of the year based on the current date.

**Calculation Logic:**  
The measure is calculated using the DAX function `WEEKNUM(TODAY())`, which retrieves the week number for the current date. 

**Format:**  
The result is formatted as a general number (0).

#### Measure: `DISTINCT_COUNT_EMP`

### Measure: DISTINCT_COUNT_EMP

**Purpose:**  
The `DISTINCT_COUNT_EMP` measure calculates the distinct count of employees based on their names from the `vw_Timesheet` table.

**Calculation Logic:**  
The measure uses the `DISTINCTCOUNT` function to count unique entries in the `EmployeeName` column of the `vw_Timesheet` table.

**Formula:**  
```DAX
DISTINCT_COUNT_EMP = DISTINCTCOUNT(vw_Timesheet[EmployeeName])
```

**Format:**  
The result is formatted as a general number (0).

#### Measure: `Dax_EmpCount`

### DAX Measure: Dax_EmpCount

**Purpose:**  
The `Dax_EmpCount` measure calculates the distinct count of employees based on the `EmployeeName` field from the `vw_missing_timesheet` table.

**Calculation Logic:**  
The measure uses the `CALCULATE` function combined with `DISTINCTCOUNT` to count unique employee names. The formula is as follows:

```DAX
Dax_EmpCount = CALCULATE(DISTINCTCOUNT(vw_missing_timesheet[EmployeeName]))
```

**Format:**  
The result is formatted as a general number (0).

#### Measure: `Dax_EmpCount_Approved`

### DAX Measure: Dax_EmpCount_Approved

**Purpose:**  
The `Dax_EmpCount_Approved` measure calculates the distinct count of employees whose timesheets have not been approved.

**Calculation Logic:**  
The measure uses the `CALCULATE` function to modify the filter context, counting distinct employee names from the `vw_Timesheet` table where the `Approved` column is set to `FALSE()`. 

**Formula:**  
```DAX
Dax_EmpCount_Approved = 
CALCULATE(
    DISTINCTCOUNT(vw_Timesheet[EmployeeName]),
    vw_Timesheet[Approved] = FALSE()
)
```

**Format:**  
The result is formatted as a general number (0).

#### Measure: `Dax_EmpCount_MissingTS`

### DAX Measure: Dax_EmpCount_MissingTS

**Purpose:**  
The `Dax_EmpCount_MissingTS` measure calculates the count of active employees who have missing timesheet hours.

**Calculation Logic:**  
The measure uses the following logic:

1. It defines a variable `ActiveEmployees` that filters a summarized table (`vw_missing_timesheet`) based on the following criteria:
   - The minimum number of active employees (`MinActiveEmp`) is equal to 1.
   - The total missing hours (`MissingHours`) is less than 0, calculated as the sum of hours minus the maximum contract hours.

2. The measure then returns the count of rows in the `ActiveEmployees` variable, which represents the number of active employees with missing timesheet hours.

**Formula:**
```DAX
VAR ActiveEmployees = 
    FILTER(
        SUMMARIZE(
            vw_missing_timesheet,
            vw_missing_timesheet[EmployeeName],
            vw_missing_timesheet[Year_],
            vw_missing_timesheet[Week_],
            lkp_Unit[Unit],
            vw_missing_timesheet[SubUnit],
            "MissingHours", SUM(vw_missing_timesheet[Hours_]) - MAX(vw_missing_timesheet[ContractHours]),
            "MinActiveEmp", MIN(vw_missing_timesheet[CC_ActiveEmployees])
        ),
        [MinActiveEmp] = 1 && [MissingHours] < 0
    )
RETURN COUNTROWS(ActiveEmployees)
```

**Format:**  
The measure is formatted as a general number.

#### Measure: `Dax_EmpCount_RReady`

### DAX Measure: Dax_EmpCount_RReady

**Purpose:**  
The `Dax_EmpCount_RReady` measure calculates the distinct count of employees whose reports are not marked as ready.

**Calculation Logic:**  
The measure uses the `CALCULATE` function to modify the filter context and counts distinct employee names from the `vw_Timesheet` table where the `ReportReady` column is set to FALSE.

**Formula:**  
```DAX
Dax_EmpCount_RReady = 
CALCULATE(
    DISTINCTCOUNT(vw_Timesheet[EmployeeName]),
    vw_Timesheet[ReportReady] = FALSE()
)
```

**Format String:**  
0

#### Measure: `Dax_MissingHours`

### DAX Measure: Dax_MissingHours

**Purpose:**  
The `Dax_MissingHours` measure calculates the total missing hours for active employees who have reported negative missing hours in a given time frame.

**Calculation Logic:**  
The measure uses the following DAX formula:

```DAX
VAR ActiveEmployees = 
    FILTER(
        SUMMARIZE(
            vw_missing_timesheet,
            vw_missing_timesheet[EmployeeName],
            vw_missing_timesheet[Year_],
            vw_missing_timesheet[Week_],
            lkp_Unit[Unit],
            vw_missing_timesheet[SubUnit],
            "MissingHours", SUM(vw_missing_timesheet[Hours_]) - MAX(vw_missing_timesheet[ContractHours]),
            "MinActiveEmp", MIN(vw_missing_timesheet[CC_ActiveEmployees])
        ),
        [MinActiveEmp] = 1 && [MissingHours] < 0
    )

RETURN 
    SUMX(ActiveEmployees, [MissingHours])
```

This measure first creates a variable `ActiveEmployees` that filters and summarizes the `vw_missing_timesheet` table to identify employees with negative missing hours and a minimum active employee count of 1. It then calculates the sum of missing hours for these active employees. 

**Format:**  
The measure is formatted as a general number.

#### Measure: `ExpectedContractHoursWeekly`

### Measure: ExpectedContractHoursWeekly

**Purpose:**  
The `ExpectedContractHoursWeekly` measure calculates the total expected contract hours for each employee on a weekly basis, based on the maximum contract hours recorded for each employee in the `vw_missing_timesheet` table.

**Calculation Logic:**  
The measure uses the following DAX formula:

```DAX
SUMX(
    SUMMARIZE(
        vw_missing_timesheet,
        vw_missing_timesheet[Week_],
        vw_missing_timesheet[EmployeeID],
        "ContractHours", MAX(vw_missing_timesheet[ContractHours])
    ),
    [ContractHours]
)
```

This formula first summarizes the `vw_missing_timesheet` table by week and employee, retrieving the maximum contract hours for each employee. It then sums these maximum contract hours to provide the total expected contract hours for the week. 

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `HoursDifference`

### Measure: HoursDifference

**Purpose:**  
The `HoursDifference` measure calculates the difference between the total hours recorded in the `vw_Timesheet` table and the maximum hours per week defined for employees.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
HoursDifference = SUM('vw_Timesheet'[Hours]) - MAX('vw_Timesheet'[HoursperWeek])
```

This formula sums all the hours from the `Hours` column and subtracts the maximum value found in the `HoursperWeek` column, providing a measure of how many hours exceed the contracted weekly hours. 

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `MISSING%`

### Measure: MISSING%

**Purpose:**  
The MISSING% measure calculates the percentage of employees who are missing timesheet entries compared to the total number of distinct employees.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
MISSING% = DIVIDE([Dax_EmpCount] - [Dax_EmpCount_MissingTS], [Dax_EmpCount]) * 100
```

- **[Dax_EmpCount]**: This measure counts the distinct number of employees.
- **[Dax_EmpCount_MissingTS]**: This measure counts the distinct number of employees with missing timesheet entries.
- The formula subtracts the count of employees with missing timesheets from the total employee count, divides by the total employee count, and multiplies by 100 to express the result as a percentage. 

**Format:**  
The measure is formatted as a general number.

#### Measure: `MSR_%_Budget_Used`

### Measure: MSR_%_Budget_Used

**Purpose:**  
The measure `MSR_%_Budget_Used` calculates the percentage of the budget that has been utilized based on the total sales amount recorded in the timesheet compared to the total budget allocated for the project.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
DIVIDE(SUM(vw_Timesheet[SalesAmount]), SUM('tbl_Project'[SalesPriceBaseCurrency]), 0)
```

This formula sums the `SalesAmount` from the `vw_Timesheet` table and divides it by the total budget (`SalesPriceBaseCurrency`) from the `tbl_Project` table. If the denominator is zero, it returns 0 to avoid division errors.

**Format:**  
The result is formatted as a percentage with two decimal places.

#### Measure: `MSR_AVG_HOURLY_RATE`

### Measure: MSR_AVG_HOURLY_RATE

**Purpose:**  
The `MSR_AVG_HOURLY_RATE` measure calculates the average hourly rate based on sales amount and total hours worked.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
SUM(vw_Timesheet[SalesAmount]) / SUM(vw_Timesheet[Hours])
```

This formula sums the `SalesAmount` from the `vw_Timesheet` table and divides it by the total hours worked, also sourced from the same table. 

**Format Hint:**  
The measure is annotated with a format hint indicating it is a general number.

#### Measure: `MSR_Cumulative Cost`

### Measure: MSR_Cumulative Cost

**Purpose:**  
The 'MSR_Cumulative Cost' measure calculates the cumulative total of costs incurred up to the selected month in a Power BI report.

**Calculation Logic:**  
The measure uses the following DAX formula:

```DAX
VAR SelectedMonth = MAX('DimDate'[MonthNumberOfYear])  -- Get the selected month in the visual
RETURN 
CALCULATE(
    SUM(vw_Timesheet[CostAmount]),
    FILTER(
        ALLSELECTED('DimDate'),  
        'DimDate'[MonthNumberOfYear] <= SelectedMonth  -- Include all months up to the current one
    )
)
```

This formula first determines the maximum month number selected in the visual context. It then calculates the sum of the 'CostAmount' from the 'vw_Timesheet' table, filtering the results to include only those months that are less than or equal to the selected month. 

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `MSR_Cumulative Sales`

### Measure: MSR_Cumulative Sales

**Purpose:**  
The 'MSR_Cumulative Sales' measure calculates the cumulative sales amount up to the selected month in a Power BI visual.

**Calculation Logic:**  
The measure uses the following DAX formula:

```DAX
VAR SelectedMonth = MAX('DimDate'[MonthNumberOfYear])  -- Get the selected month in the visual
RETURN 
CALCULATE(
    SUM(vw_Timesheet[SalesAmount]),
    FILTER(
        ALLSELECTED('DimDate'),  
        'DimDate'[MonthNumberOfYear] <= SelectedMonth  -- Include all months up to the current one
    )
)
```

This formula first determines the maximum month number selected in the visual. It then calculates the total sales amount from the 'vw_Timesheet' table, filtering the dates to include only those up to and including the selected month. 

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `MSR_Cumulative_Revenue`

### Measure: MSR_Cumulative_Revenue

**Purpose:**  
The `MSR_Cumulative_Revenue` measure calculates the cumulative revenue over time, allowing users to analyze total sales amounts up to the current date in the selected context.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
CALCULATE(
    SUM(vw_Timesheet[SalesAmount]),
    FILTER(
        ALLSELECTED(DimDate[ShortDate]),
        DimDate[ShortDate] <= MAX(DimDate[ShortDate])
    )
)
```

This formula sums the `SalesAmount` from the `vw_Timesheet` table, applying a filter to include only those dates that are less than or equal to the maximum date in the current context. The use of `ALLSELECTED` ensures that the calculation respects any filters applied to the date dimension while still allowing for cumulative aggregation.

#### Measure: `MSR_PROJECT_%_REALIZATION`

### Measure: MSR_PROJECT_%_REALIZATION

**Purpose:**  
The `MSR_PROJECT_%_REALIZATION` measure calculates the percentage of project realization based on the sales amount relative to the total sales price in the base currency for the project.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
IF(sum(tbl_Project[SalesPriceBaseCurrency]) <> 0, 
   sum(vw_Timesheet[SalesAmount]) / sum(tbl_Project[SalesPriceBaseCurrency]))
```

This formula checks if the total sales price in the base currency is not zero. If true, it divides the total sales amount from the timesheet by the total sales price, yielding the percentage realization of the project. 

**Format:**  
The result is formatted as a percentage with two decimal places.

#### Measure: `MSR_ProjectMargin`

### MSR_ProjectMargin

**Purpose:**  
The `MSR_ProjectMargin` measure calculates the profit margin for projects by determining the difference between total sales and total costs.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
MSR_ProjectMargin = SUM(vw_Timesheet[SalesAmount]) - SUM(vw_Timesheet[CostAmount])
```

This formula sums the `SalesAmount` and subtracts the sum of `CostAmount` from it, providing the overall project margin. 

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `MissingHoursOut`

### Measure: MissingHoursOut

**Purpose:**  
The `MissingHoursOut` measure calculates the difference between the maximum contracted hours and the maximum hours worked for employees, indicating the total missing hours.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
MissingHoursOut = MAX(vw_missing_timesheet[ContractHours]) - MAX(vw_missing_timesheet[Hours_])
```

This formula retrieves the maximum value of `ContractHours` and subtracts the maximum value of `Hours_` from it. The result represents the total hours that are missing based on the contracted hours versus the actual hours recorded. 

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `Msr_ActiveContacts`

### Measure: Msr_ActiveContacts

**Purpose:**  
The `Msr_ActiveContacts` measure calculates the number of active contacts (employees) based on their contract dates within a specified date range.

**Calculation Logic:**  
The measure uses the following logic:

1. **Variables:**
   - `_MaxDate`: Retrieves the maximum date from the `DimDate[ShortDate]`.
   - `_MinDate`: Retrieves the minimum date from the `DimDate[ShortDate]`.
   - `_StartsBeforeMonthEnd`: Creates a table of unique `EmployeeID`s where the `ShortDate` is less than or equal to `_MaxDate`.
   - `_notEndAfterMonthEnd`: Creates a table of unique `EmployeeID`s where the `ShortDate` is greater than or equal to `_MinDate` or is blank, using a user-defined relationship with `vw_Timesheet[ContractEndDate]`.

2. **Return Value:**  
The measure returns the count of rows that are present in both `_notEndAfterMonthEnd` and `_StartsBeforeMonthEnd`, indicating the number of active contacts. 

The formula for the measure is as follows:
```DAX
VAR _MaxDate = MAX ( DimDate[ShortDate])
VAR _MinDate = MIN ( DimDate[ShortDate] )
VAR _StartsBeforeMonthEnd = CALCULATETABLE ( VALUES ( vw_Timesheet[EmployeeID] ), DimDate[ShortDate] <= _MaxDate )
VAR _notEndAfterMonthEnd = CALCULATETABLE (
    VALUES ( vw_Timesheet[EmployeeID] ),
    DimDate[ShortDate] >= _MinDate || ISBLANK ( DimDate[ShortDate] ),
    USERELATIONSHIP ( DimDate[ShortDate], vw_Timesheet[ContractEndDate] )
)
RETURN
    COUNTROWS ( INTERSECT ( _notEndAfterMonthEnd, _StartsBeforeMonthEnd ) )
```

#### Measure: `Msr_Budget`

### Measure: Msr_Budget

**Purpose:**  
The `Msr_Budget` measure calculates the most recent available budget value based on the selected week in the context of a timesheet.

**Calculation Logic:**  
1. It retrieves the current week number using `SELECTEDVALUE(DimDate[WeekNumberOfYear])`.
2. It calculates the previous budget value by filtering the `Msr_SalesPriceBaseCurrency` measure for weeks prior to the current week.
3. The measure returns the current budget value if it is not blank; otherwise, it returns the previous budget value.

**Formula:**
```DAX
VAR CurrentWeek = SELECTEDVALUE(DimDate[WeekNumberOfYear])
VAR PrevBudget = 
    CALCULATE(
        [Msr_SalesPriceBaseCurrency],
        FILTER(
            ALLSELECTED(DimDate),  
            DimDate[WeekNumberOfYear] < CurrentWeek
        )
    )
RETURN
    IF(
        NOT(ISBLANK([Msr_SalesPriceBaseCurrency])),
        [Msr_SalesPriceBaseCurrency],
        PrevBudget
    )
```

**Format:**  
"€"\ #,0.00;-"€"\ #,0.00;"€"\ #,0.00

#### Measure: `Msr_HoursPercentage`

### Msr_HoursPercentage

**Purpose:**  
The `Msr_HoursPercentage` measure calculates the percentage of hours worked by an employee relative to the total hours worked across selected categories, projects, and employees.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
VAR TotalValue = 
    CALCULATE(SUM(vw_Timesheet[Hours]), 
        ALLSELECTED(vw_Timesheet[GroupCat], vw_Timesheet[Project], vw_Timesheet[EmployeeName])
    )
RETURN 
    DIVIDE(SUM(vw_Timesheet[Hours]), TotalValue, 0)
```

This formula first computes the total hours across all selected categories, projects, and employees, and then divides the sum of hours for the current context by this total, returning 0 if the total is zero. 

**Format:**  
The result is formatted as a percentage with two decimal places (0.00%;-0.00%;0.00%).

#### Measure: `Msr_SalesPriceBaseCurrency`

### Measure: Msr_SalesPriceBaseCurrency

**Purpose:**  
The `Msr_SalesPriceBaseCurrency` measure calculates the total sales price in the base currency for each project and client combination.

**Calculation Logic:**  
The measure uses the `SUMX` function to iterate over a summarized table created from `vw_Timesheet`, grouping by `ProjectProfile` and `Client`. For each group, it retrieves the selected value of `SalesPriceBaseCurrency` from the `tbl_Project` table and sums these values.

**Formula:**
```DAX
SUMX(
    SUMMARIZE(
        vw_Timesheet, 
        vw_Timesheet[ProjectProfile], 
        vw_Timesheet[Client], 
        "MeasureValue", SELECTEDVALUE(tbl_Project[SalesPriceBaseCurrency])
    ), 
    [MeasureValue]
)
```

**Format:**  
The measure is formatted as currency with the following format string: `\$#,0.###############;(\$#,0.###############);\$#,0.###############`.

**Currency Culture:**  
The measure is set to use the "en-US" currency culture.

#### Measure: `PercentageCompleteness`

### Measure: PercentageCompleteness

**Purpose:**  
The `PercentageCompleteness` measure calculates the completeness percentage of expected contract hours based on the missing hours recorded.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
DIVIDE(
    SUM(vw_missing_timesheet[MissingHours]) - [ExpectedContractHoursWeekly],
    [ExpectedContractHoursWeekly],
    0
)
```

This formula computes the difference between the total missing hours and the expected contract hours for the week, then divides that difference by the expected contract hours to derive the completeness percentage. If the expected contract hours are zero, it returns zero to avoid division by zero errors.

#### Measure: `Static Total Employees`

### Measure: 'Static Total Employees'

**Purpose:**  
The 'Static Total Employees' measure calculates the total number of distinct employees whose contract status is currently valid.

**Calculation Logic:**  
The measure uses the `CALCULATE` function to count distinct employee names from the `vw_Timesheet` table while applying the following filters:
- It removes all existing filters on the `vw_Timesheet` table using `ALL(vw_Timesheet)`.
- It filters for records where the `ContractStatusToday` is "Valid".

**DAX Formula:**
```DAX
CALCULATE(
    DISTINCTCOUNT(vw_Timesheet[EmployeeName]), 
    ALL(vw_Timesheet),
    vw_Timesheet[ContractStatusToday] = "Valid"
)
```

**Format:**  
The measure is formatted as a general number (0).

#### Measure: `TotalActualHours`

### Measure: TotalActualHours

**Purpose:**  
The `TotalActualHours` measure calculates the total number of hours recorded in the `vw_Timesheet` table.

**Calculation Logic:**  
The measure is defined using the following DAX formula:

```DAX
SUM(vw_Timesheet[Hours])
```

This formula sums up all the values in the `Hours` column of the `vw_Timesheet` table.

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `TotalContractedHours`

### Measure: TotalContractedHours

**Purpose:**  
The `TotalContractedHours` measure calculates the total contracted hours for employees based on their maximum hours per week.

**Calculation Logic:**  
The measure uses the `SUMX` function to iterate over distinct employee names in the `vw_Timesheet` table, summing the maximum hours per week for each employee. The formula is as follows:

```DAX
SUMX(
    VALUES(vw_Timesheet[EmployeeName]),
    MAX(vw_Timesheet[HoursPerWeek])
)
```

**Format:**  
The result is formatted as a general number.

#### Measure: `TotalHoursDeltaComplete`

### Measure: TotalHoursDeltaComplete

**Purpose:**  
The `TotalHoursDeltaComplete` measure calculates the ratio of actual hours worked to contracted hours, providing insight into the completion status of hours relative to what was contracted.

**Calculation Logic:**  
The measure is defined using the following DAX formula:

```DAX
TotalHoursDeltaComplete =
    DIVIDE(
        [TotalActualHours],
        [TotalContractedHours],
        0
    )
```

This formula divides the total actual hours (`TotalActualHours`) by the total contracted hours (`TotalContractedHours`). If the denominator is zero, it returns 0 to avoid division errors.

**Format:**  
The result is formatted as a percentage with two decimal places, represented as `0.00%;-0.00%;0.00%`.

#### Measure: `TotalHoursDeltaCompleteNr`

### Measure: TotalHoursDeltaCompleteNr

**Purpose:**  
The `TotalHoursDeltaCompleteNr` measure calculates the difference between the total actual hours worked and the total contracted hours.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
[TotalActualHours] - [TotalContractedHours]
```

This formula subtracts the total contracted hours from the total actual hours, providing a numerical representation of the difference between hours worked and hours contracted. 

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `TotalHoursTracked`

### Measure: TotalHoursTracked

**Purpose:**  
The `TotalHoursTracked` measure calculates the total hours tracked from the `vw_Timesheet` table. It ensures that if there are no hours recorded, the measure returns zero instead of a blank value.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
IF (
    ISBLANK(SUM(vw_Timesheet[Hours])),
    0,
    SUM(vw_Timesheet[Hours])
)
```

This formula checks if the sum of hours is blank. If it is, the measure returns 0; otherwise, it returns the total sum of hours tracked. 

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `TotalHoursTrackedMissing`

### Measure: TotalHoursTrackedMissing

**Purpose:**  
The `TotalHoursTrackedMissing` measure is designed to evaluate the total hours tracked in the timesheet. It provides a way to identify whether the hours data is available or not.

**Calculation Logic:**  
The measure uses the following DAX formula:

```DAX
IF (
    ISBLANK(SUM(vw_Timesheet[Hours])),
    "Empty",
    SUM(vw_Timesheet[Hours])
)
```

This formula checks if the sum of hours from the `vw_Timesheet` table is blank. If it is blank, the measure returns the string "Empty"; otherwise, it returns the total sum of hours tracked. 

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `UTILIZATION_New`

### DAX Measure: UTILIZATION_New

**Purpose:**  
The `UTILIZATION_New` measure calculates the ratio of billable hours to total hours for active employees, providing insight into employee utilization rates.

**Calculation Logic:**  
The measure uses the following logic:
1. It retrieves the total billable hours using the measure `[UTI_TotalBillableHours]`.
2. It retrieves the total hours using the measure `[UTI_TOTALHOURS]`.
3. It checks if there are active contacts (`[Msr_ActiveContacts]`) and if total hours are not blank.
4. If the conditions are met, it calculates the ratio of total billable hours to total hours. If the division results in a blank, it returns 0.

**Formula:**
```DAX
VAR _TotalBillableHours = [UTI_TotalBillableHours]
VAR _TotalHours = [UTI_TOTALHOURS]

RETURN
    IF(NOT(ISBLANK([Msr_ActiveContacts])), 
        IF(NOT(ISBLANK([UTI_TOTALHOURS])), 
            IF(ISBLANK(DIVIDE(_TotalBillableHours, _TotalHours)), 0, DIVIDE(_TotalBillableHours, _TotalHours))
        )
    )
```

**Format:**  
0.00%;-0.00%;0.00%

#### Measure: `UTI_TOTALHOURS`

### Measure: UTI_TOTALHOURS

**Purpose:**  
The UTI_TOTALHOURS measure calculates the total hours worked by employees on projects that qualify for tracking.

**Calculation Logic:**  
The measure uses the `CALCULATE` function to sum the hours from the `vw_Timesheet` table, applying a filter to include only those records where the `QualifyPrj` column is equal to 1.

**Formula:**  
```DAX
UTI_TOTALHOURS = CALCULATE(SUM(vw_Timesheet[Hours]), vw_Timesheet[QualifyPrj] = 1)
```

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `UTI_TotalBillableHours`

### Measure: UTI_TotalBillableHours

**Purpose:**  
The `UTI_TotalBillableHours` measure calculates the total billable hours for projects that qualify as billable or are associated with "Customer Success Services."

**Calculation Logic:**  
The measure uses the following DAX formula:

```DAX
Var FilteredHours =
    Filter(
        vw_Timesheet,
        (
        vw_Timesheet[QualifyPrj] = 1 && 
        vw_Timesheet[BillablePrj] = 1) ||
            SEARCH("Customer Success Services", vw_Timesheet[Project], 1, 0) > 0
    )
RETURN 
    SUMX(FilteredHours, vw_Timesheet[Hours])
```

This formula filters the `vw_Timesheet` table to include only those entries where the project qualifies as billable or is related to "Customer Success Services," and then sums the hours for those filtered entries. 

**Format:**  
The result is formatted as a general number (0).

#### Measure: `UniqueEmployeesPerUnit`

### UniqueEmployeesPerUnit

**Purpose:**  
The `UniqueEmployeesPerUnit` measure calculates the number of unique employees associated with each unit, based on their incomplete status.

**Calculation Logic:**  
The measure uses the `SUMX` function in conjunction with `SUMMARIZE` to group data from the `vw_missing_timesheet` table by week, employee name, and main unit. It then evaluates the maximum value of the `IncompleteFlag` for each group, effectively counting unique employees who have an incomplete status.

**Formula:**  
```DAX
SUMX(
    SUMMARIZE(
        vw_missing_timesheet,
        vw_missing_timesheet[Week_],
        vw_missing_timesheet[EmployeeName],
        vw_missing_timesheet[MAIN_UNIT],
        "IncompleteFlag", MAX(vw_missing_timesheet[IncompleteFlag])
    ),
    [IncompleteFlag]
)
```

**Format:**  
The measure is formatted as a general number (0).

#### Measure: `trackedDiff`

### Measure: trackedDiff

**Purpose:**  
The `trackedDiff` measure calculates the difference between the total hours tracked and the maximum hours per week for each employee, providing insight into discrepancies in reported hours.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
[TotalHoursTracked] - 
    CALCULATE(
        MAXX(DISTINCT(vw_Timesheet[HoursPerWeek]), vw_Timesheet[HoursPerWeek]),
        ALLEXCEPT(vw_Timesheet, vw_Timesheet[EmployeeID])
    )
```

- It subtracts the maximum hours per week (considering distinct values) from the total hours tracked for each employee, while maintaining the context of the employee ID.

#### Measure: `trackedDiff2`

### Measure: trackedDiff2

**Purpose:**  
The `trackedDiff2` measure calculates the difference between the total hours tracked and the maximum hours per week for each employee, while removing filters on the `HoursPerWeek` column.

**Calculation Logic:**  
The measure is defined as follows:

```DAX
[TotalHoursTracked] - 
    CALCULATE(
        MAXX(
            DISTINCT(vw_Timesheet[HoursPerWeek]), 
            vw_Timesheet[HoursPerWeek]
        ),
        REMOVEFILTERS(vw_Timesheet[HoursPerWeek]),
        ALLEXCEPT(vw_Timesheet, vw_Timesheet[EmployeeID])
    )
```

This formula computes the total hours tracked and subtracts the maximum hours per week for the employee, ensuring that the calculation is not affected by filters on `HoursPerWeek` while retaining the context of the specific employee.

### 2.4 Relationships

The following relationships were identified:

* vw_Timesheet.Project -> lkp_Project.Project

vw_Timesheet.Unit -> lkp_Unit.'Organisatorische eenheid'

vw_Timesheet.TimesheetCode -> lkp_Code.Code

vw_Timesheet.TimesheetDate -> DimDate.ShortDate

vw_missing_timesheet.ShortDate -> DimDate.ShortDate

vw_missing_timesheet.TimesheetCode -> lkp_Code.Code

vw_missing_timesheet.SubUnit -> lkp_Unit.'Organisatorische eenheid'

vw_missing_timesheet.Project -> lkp_Project.Project

vw_Timesheet.ContractStartDate -> DimDate.ShortDate (inactive)

vw_Timesheet.ContractEndDate -> DimDate.ShortDate (inactive)

vw_Timesheet.ProjectCode -> tbl_Project.Project (both directions)

## 3. Visuals (Based on Configuration)

### Visual Identifier: `Report`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report`)

The visual is part of the "Devoteam Look" report, created from the cloud. It utilizes a custom theme named "Devotheme26253733243456856.json" and a base theme "CY24SU10". 

Key elements include:
- **Visual Type**: Not explicitly stated in the JSON context.
- **Main Data Fields**: Involves relationships between "vw_missing_timesheet", "onedrive_unit", and "onedrive_project".
- **Filters**: Default drill filter settings are enabled, and the filter pane is visible in edit mode.
- **Key Settings**: Enhanced tooltips are enabled, and the query limit option is set to 6. 

The layout is optimized for vertical alignment at the top, and the outspace pane is not expanded or visible.

### Visual Identifier: `000_Customer Analysis`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis`)

The visual in the specified context is configured with the following details:

- **Visual Type**: Not explicitly mentioned in the JSON context.
- **Main Data Fields**: 
  - Project Group Description from `tbl_Project`
  - Project from `vw_Timesheet`
  - Own-Sub-ExtT from `vw_Timesheet`
  - Employee Name from `vw_Timesheet`
- **Filters**: 
  - Time material
  - Fixed price
- **Key Settings**: 
  - Vertical alignment set to 'Top'
  - Filter pane is visible in edit mode
  - Enhanced tooltips are enabled
  - Default drill filter for other visuals is set to true

The visual utilizes a custom theme named "Devotheme26253733243456856.json" and is part of a report created from the cloud.

### Visual Identifier: `00000_Unit`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/00000_Unit`)

The visual is an image type with the following characteristics:

- **Visual Type**: Image
- **Main Data Fields**: The visual references the image resource "Devoteam_rgb_group8358853173377017.jpg".
- **Filters**: The visual includes a dropdown filter for the "Unit" field from the "vw_Timesheet.MAIN_UNIT" query.
- **Key Settings**:
  - Image scaling type is set to "Fit".
  - Border is shown with a radius of 5 and color #B4C0D2.
  - Drop shadow is disabled.
  - The header is hidden, and the background color is set to #3C6E71. 
  - Selection allows multiple selections with a "Select All" checkbox enabled.

### Visual Identifier: `01000_TimeSpan`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/01000_TimeSpan`)

The visual is a dropdown filter configured to display project-related data. It includes the following main data fields: 

- `tbl_Project.ProjectGroupDescription`
- `vw_Timesheet.Project`
- `vw_Timesheet.Own-Sub-ExtT`
- `vw_Timesheet.EmployeeName`

Key settings include:
- Dropdown mode for selection.
- Single select is disabled, allowing multiple selections.
- A "Select All" checkbox is enabled.
- The header is hidden, with a background color of `#3C6E71`.
- Labels are shown with a display unit of 1000.
- The legend is visible but does not show a title.

The visual is styled with the custom theme "Devotheme26253733243456856.json" and uses the font "Segoe UI" with a text size of 9D for items and 10D for numeric inputs.

### Visual Identifier: `02000_Year`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/02000_Year`)

**Visual Type:** Line Chart

**Main Data Fields:** 
- Values: Sum(vw_Timesheet.SalesAmount)
- Category: vw_Timesheet.MAIN_UNIT

**Filters:** 
- Default drill filter for other visuals is enabled.

**Key Settings:**
- Legend is shown but without a title, font size set to 9D.
- Labels are displayed with units set to thousands (1000D).
- Line styles include a stroke width of 2D, markers are shown with a size of 3D.
- Data points are filled with the color #6198CC.
- Category and value axis titles are hidden.
- Dropdown mode is used for data selection, with a select all checkbox enabled.

### Visual Identifier: `03000_Client`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/03000_Client`)

**Visual Type:** Dropdown

**Main Data Fields:** ClientName (from tbl_Project)

**Filters:** Self-filter enabled, select all checkbox enabled, multiple selection allowed.

**Key Settings:**
- Header visibility: hidden
- Background color: theme-based
- Font: Segoe UI, size 9D
- Mode: Dropdown

### Visual Identifier: `04000_Company`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/04000_Company`)

The visual is a dropdown selection type. It utilizes the "vw_Timesheet.MAIN_UNIT" as the main data field. Key settings include:

- **Display Mode**: Dropdown
- **Font Family**: Segoe UI
- **Text Size**: 9D for items, 10D for numeric input
- **Single Select**: Disabled
- **Select All Checkbox**: Enabled
- **Header Background Color**: #3C6E71
- **Include Today in Date Range**: False

The visual is part of a report with a custom theme named "Devotheme26253733243456856.json" and is configured to allow changes in filter types.

### Visual Identifier: `05000_Employee`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/05000_Employee`)

The visual is a dropdown filter type. It utilizes the following main data fields: `tbl_Project.ProjectGroupDescription`, `vw_Timesheet.Project`, `vw_Timesheet.Own-Sub-ExtT`, and `vw_Timesheet.EmployeeName`. 

Key settings include:
- Single select is disabled, allowing multiple selections.
- A "Select All" checkbox is enabled.
- The header is hidden, with a background color of `#3C6E71`.
- Font family is set to "Segoe UI" with varying text sizes (9D for items and 10D for numeric input).

The visual is configured to allow drill filtering on other visuals and uses enhanced tooltips. The filter pane is visible in edit mode.

### Visual Identifier: `06000_pivotTable (8a02e)`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/06000_pivotTable (8a02e)`)

The visual is a **pivot table**. It includes the following main data fields:

- **Values**:
  - Sum of Hours (`Sum(vw_Timesheet.Hours)`)
  - Sum of Sales Amount (`Sum(vw_Timesheet.SalesAmount)`)
  - Average Hourly Rate (`vw_Timesheet.MSR_AVG_HOURLY_RATE`)

- **Rows**:
  - Client Name (`tbl_Project.ClientName`)
  - Project (`vw_Timesheet.Project`)
  - Own-Sub-ExtT (`vw_Timesheet.Own-Sub-ExtT`)
  - Employee Name (`vw_Timesheet.EmployeeName`)

- **Columns**:
  - Calendar Year (`DimDate.CalendarYear`)
  - Week Number of Year (`DimDate.WeekNumberOfYear`)

Key settings include:
- Active filter options for drill-down.
- The visual is positioned at coordinates (x: 9.43, y: 136.10) with a width of 595.09 and height of 575.65.
- The filter pane is visible in edit mode.

### Visual Identifier: `07000_Project Name`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/07000_Project Name`)

The visual is a dropdown filter type, utilizing the "tbl_Project.ProjectGroupDescription" and "vw_Timesheet" fields for filtering. It features a custom theme ("Devotheme26253733243456856.json") and a base theme ("CY24SU10"). Key settings include inverted selection mode enabled, a select all checkbox, and a hidden header with a background color of '#3C6E71'. The font used is "Segoe UI" with specific text sizes for items and numeric input. The visual allows multiple selections and has a query limit option set to 6.

### Visual Identifier: `08000_Sub-Own-Ext`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/08000_Sub-Own-Ext`)

The visual is a dropdown selection type. It utilizes data from the fields `vw_Timesheet.MAIN_UNIT` and `tbl_Project.DevoteamPillar`. 

Key settings include:
- **Dropdown Mode**: Enabled.
- **Single Select**: Disabled, allowing multiple selections.
- **Select All Checkbox**: Enabled.
- **Header**: Hidden with a background color of `#3C6E71`.
- **Font Family**: Set to `Segoe UI` with a text size of `9D` for items and `10D` for numeric input.

The visual supports filtering with the ability to toggle between different project groups and employee names, with some levels collapsed by default.

### Visual Identifier: `09000_Project Type`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/09000_Project Type`)

The visual is a dropdown filter type, configured to allow multiple selections with an enabled "Select All" checkbox. It utilizes the "DevoteamPillar" field from the "tbl_Project" entity as its main data field. The visual's header is hidden, and it features a background color of '#3C6E71'. The font used is 'Segoe UI' with a text size of 9D for items and 10D for numeric inputs. The selection mode is set to allow multiple selections, and the filter pane is visible in edit mode. The visual is pinned to the "ProjectGroupDescription" level and includes toggled options for "Time material" and "Fixed price".

### Visual Identifier: `10000_Revenue%2FWeek`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/10000_Revenue%2FWeek`)

**Visual Type:** Line Chart

**Main Data Fields:**
- X-Axis: `tbl_Project.ProjectGroupDescription`
- Y-Axis: `Sum(vw_Timesheet.SalesAmount)`

**Filters:**
- Project Group Description
- Project
- Own-Sub-ExtT
- Employee Name

**Key Settings:**
- Legend: Visible, Font Size: 9pt, Title: Hidden
- Category Axis: Title Hidden
- Value Axis: Title Hidden
- Labels: Visible, Display Units: Thousands, Position: Auto
- Line Styles: Area Hidden, Stroke Width: 2pt, Markers: Visible, Marker Size: 3pt
- Data Point Color: `#6198CC`
- Markers: Border Visible

**Theme:** Custom theme applied (Devotheme26253733243456856.json) with base theme CY24SU10.

### Visual Identifier: `11000_pivotTable (48569)`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/11000_pivotTable (48569)`)

The visual is a **pivot table**. 

**Main Data Fields:**
- **Rows:** 
  - DimDate.CalendarYear
  - vw_Timesheet.MAIN_UNIT
  - vw_Timesheet.Unit
  - vw_Timesheet.EmployeeName
- **Columns:** 
  - DimDate.WeekNumberOfYear
- **Values:** 
  - Sum(vw_Timesheet.SalesAmount)

**Key Settings:**
- The visual is positioned at (x: 610.998, y: 443.666) with a width of 658.134 and height of 268.085.
- The active section index is 0.
- The filter pane is visible in edit mode.
- Enhanced tooltips are enabled.

### Visual Identifier: `12000_SubUnit`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/12000_SubUnit`)

The visual is a dropdown filter. It utilizes the "vw_Timesheet.Unit" field as its main data field, allowing users to select from various units. The visual settings include:

- **Header**: Hidden.
- **Selection**: Allows multiple selections with a "Select All" checkbox enabled.
- **Font**: Uses "Segoe UI" with a text size of 9D for items and 10D for numeric input.
- **Background Color**: Set to a theme color (#3C6E71).

Filters are applied based on the "vw_Timesheet" entity, specifically for the "Unit" property. The visual is configured to allow dropdown mode for selection.

### Visual Identifier: `13000_image (6f358)`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/13000_image (6f358)`)

The visual is an **image** type. It displays an image sourced from the resource package, specifically "Devoteam_rgb_group8358853173377017.jpg". The image scaling is set to **Fit**. 

Key settings include:
- **Border**: Enabled with a radius of **5D** and a color of **#B4C0D2**.
- **Drop Shadow**: Disabled.
- **Visual Link**: Disabled.
- **Drill Filter Other Visuals**: Enabled.

The visual is positioned at coordinates (4.12, 0) with a width of approximately **59.51** and a height of approximately **58.92**.

### Visual Identifier: `14000_actionButton (88e87)`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/000_Customer Analysis/visualContainers/14000_actionButton (88e87)`)

The visual is an **action button** designed to reset slicers. 

**Key Settings:**
- **Text:** "Reset Slicers"
- **Font Family:** Segoe UI
- **Font Size:** 10D
- **Font Color:** White
- **Background Color:** #3C6E71
- **Icon Shape:** Reset icon with a line weight of 2L and line color white.
- **Tile Shape:** Rectangle
- **Horizontal Alignment:** Right
- **Vertical Alignment:** Middle

**Data Fields:**
- **Query Reference:** vw_Timesheet.MAIN_UNIT

**Filters:**
- **Drill Filter Other Visuals:** Enabled

**Layout:**
- Positioned at (x: 1153.36, y: 60.32) with a width of 120.64 and height of 37.40.

### Visual Identifier: `001_Project Details`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details`)

The visual is a hierarchical structure displaying project details. It includes the following levels:

1. **Project Group Description** from `tbl_Project` (pinned).
2. **Project** from `vw_Timesheet` (collapsed, pinned).
3. **Own-Sub-ExtT** from `vw_Timesheet` (collapsed, pinned).
4. **Employee Name** from `vw_Timesheet` (collapsed, pinned).

The root contains toggled identity values for:
- 'Time material'
- 'Fixed price'

Key settings include:
- Use of a custom theme (`Devotheme26253733243456856.json`).
- Enhanced tooltips enabled.
- Filter pane visible in edit mode.

The visual supports drill-down functionality and has a vertical alignment set to 'Top'.

### Visual Identifier: `00000_Pillar`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/00000_Pillar`)

The visual is a slicer that utilizes the "DevoteamPillar" field from the "tbl_Project" table. 

**Main Data Field:**
- DevoteamPillar

**Filters:**
- The slicer allows for multiple selections (not single select) and includes a "Select All" checkbox.

**Key Settings:**
- Display mode is set to "Dropdown."
- The header is hidden, with a background color of #3C6E71.
- Font family is set to "Segoe UI" with a text size of 9D.
- Enhanced tooltips are enabled, and the filter pane is visible in edit mode. 

**Layout:**
- Positioned at coordinates (385.1, 0) with a width of 192.2 and height of 59.0.

### Visual Identifier: `01000_TimeSpan`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/01000_TimeSpan`)

**Visual Type:** Dropdown

**Main Data Fields:**
- ProjectGroupDescription from `tbl_Project`
- Project from `vw_Timesheet`
- Own-Sub-ExtT from `vw_Timesheet`
- EmployeeName from `vw_Timesheet`
- MAIN_UNIT from `vw_Timesheet`

**Filters:**
- Time material
- Fixed price

**Key Settings:**
- Header: Hidden, background color `#3C6E71`
- Font: Segoe UI, size 9D for items and row headers, 10D for numeric input
- Selection: Multi-select enabled, select all checkbox enabled
- Background: Visible with 0% transparency
- Padding: Top and bottom set to 0
- Column width for Project set to approximately 421.16
- Blank rows: Not shown
- Show expand/collapse buttons: Enabled

### Visual Identifier: `02000_Year`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/02000_Year`)

**Visual Type:** Pivot Table

**Main Data Fields:**
- **Values:**
  - Min(tbl_Project.PlannedCompletionDate)
  - Min(vw_Timesheet.IPM_ManagerName)
  - Min(tbl_Project.Status)
  - CountNonNull(tbl_Project.SalesPriceBaseCurrency)
  - Sum(vw_Timesheet.Hours)
  - Sum(vw_Timesheet.SalesAmount)
  - vw_Timesheet.MSR_AVG_HOURLY_RATE
  - vw_Timesheet.MSR_PROJECT_%_REALIZATION
  - vw_Timesheet.MSR_ProjectMargin

- **Rows:**
  - tbl_Project.ProjectGroupDescription
  - vw_Timesheet.Project
  - vw_Timesheet.Own-Sub-ExtT
  - vw_Timesheet.EmployeeName

- **Columns:**
  - DimDate.CalendarYear
  - DimDate.WeekNumberOfYear

**Filters:** 
- Active filters on ProjectGroupDescription, Project, and CalendarYear.

**Key Settings:**
- Vertical alignment set to 'Top'.
- Filter pane visible in edit mode.
- Enhanced tooltips enabled.

### Visual Identifier: `03000_Client`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/03000_Client`)

The visual is a dropdown filter. 

**Main Data Field:**
- ClientName from the tbl_Project table.

**Filters:**
- Self-filtering is enabled.
- Select all checkbox is enabled.
- Single select is disabled.

**Key Settings:**
- Header is hidden.
- Background color is based on the theme.
- Font family is set to 'Segoe UI' with a text size of 9D.
- The visual is configured to use the new filter pane experience.

### Visual Identifier: `04000_Company`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/04000_Company`)

The visual is configured as a dropdown type. It utilizes the main data field "vw_Timesheet.MAIN_UNIT" and includes selections for "Unit." 

Key settings include:
- Font family set to "Segoe UI" with varying text sizes (9D for items, 10D for numeric input).
- The header is hidden, with a background color of "#3C6E71."
- Single selection is disabled, but a "select all" checkbox is enabled.
- The date range does not include today.

The visual is part of a theme named "Devotheme26253733243456856.json" and is optimized for layout with a focus on user interaction through dropdown selections.

### Visual Identifier: `05000_Status`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/05000_Status`)

The visual is a **slicer**. 

**Main Data Field:**
- `tbl_Project.Status`

**Filters:**
- The slicer is set to filter on the `Status` field, specifically including the value `'Realisation'`.

**Key Settings:**
- Display mode is set to **Dropdown**.
- Header visibility is turned **off**.
- Background color is based on the theme.
- Font family is set to **'Segoe UI'** with a text size of **9D**.
- Self-filtering is enabled.
- Selection allows for multiple selections (single select is **false**) and includes a **select all** checkbox.

### Visual Identifier: `06000_Employee`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/06000_Employee`)

The visual is a dropdown type. It utilizes the following main data fields: `ProjectGroupDescription` from `tbl_Project`, `Project`, `Own-Sub-ExtT`, and `EmployeeName` from `vw_Timesheet`. 

Key settings include:
- Self-filtering is enabled.
- The selection allows for multiple selections (singleSelect is false) and includes a "Select All" checkbox.
- The header is hidden.
- The font is set to "Segoe UI" with a text size of 9D.
- The background color is determined by the theme.

The visual has a pinned structure with some levels collapsed, and it supports toggling between values like 'Time material' and 'Fixed price'.

### Visual Identifier: `07000_pivotTable (08915)`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/07000_pivotTable (08915)`)

The visual is a **pivot table**. 

**Main Data Fields:**
- **Values:**
  - Min(tbl_Project.PlannedCompletionDate)
  - Min(vw_Timesheet.IPM_ManagerName)
  - Min(tbl_Project.Status)
  - CountNonNull(tbl_Project.SalesPriceBaseCurrency)
  - Sum(vw_Timesheet.Hours)
  - Sum(vw_Timesheet.SalesAmount)
  - vw_Timesheet.MSR_AVG_HOURLY_RATE
  - vw_Timesheet.MSR_PROJECT_%_REALIZATION
  - vw_Timesheet.MSR_ProjectMargin

- **Rows:**
  - tbl_Project.ProjectGroupDescription
  - vw_Timesheet.Project
  - vw_Timesheet.Own-Sub-ExtT
  - vw_Timesheet.EmployeeName

- **Columns:**
  - DimDate.CalendarYear
  - DimDate.WeekNumberOfYear

**Key Settings:**
- Position: x=9.65, y=136.33, width=1259.52, height=325.74
- Tab Order: 7000
- Active filters include DimDate.CalendarYear and tbl_Project.ProjectGroupDescription.

### Visual Identifier: `08000_Project Name`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/08000_Project Name`)

The visual is a dropdown filter. It utilizes the following main data fields: `tbl_Project.ProjectGroupDescription`, `vw_Timesheet.Project`, `vw_Timesheet.Own-Sub-ExtT`, and `vw_Timesheet.EmployeeName`. 

Key settings include:
- Inverted selection mode is enabled.
- Single select is disabled, allowing multiple selections.
- A "Select All" checkbox is enabled.
- The header is hidden, and the background color is set to `#3C6E71`.
- Font family is set to "Segoe UI" with a text size of 9D for items and 10D for numeric input.

The visual supports self-filtering and has a dropdown mode for selection.

### Visual Identifier: `09000_Sub-Own-Ext`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/09000_Sub-Own-Ext`)

The visual is a dropdown filter. 

**Main Data Fields:**
- ProjectGroupDescription from `tbl_Project`
- Project from `vw_Timesheet`
- Own-Sub-ExtT from `vw_Timesheet`
- EmployeeName from `vw_Timesheet`

**Filters:**
- Options for "Time material" and "Fixed price" are toggled on.

**Key Settings:**
- Header is hidden with a background color of `#3C6E71`.
- Font family is set to "Segoe UI" with text sizes of 9D for items and 10D for numeric input.
- Allows multiple selections with a "Select All" checkbox enabled.
- Dropdown mode is enabled, and the selection mode is inverted. 
- Today's date is not included in the date range.

### Visual Identifier: `10000_Project Type`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/10000_Project Type`)

The visual is a dropdown filter type. It utilizes the following main data fields: 

- **Values**: `tbl_Project.DevoteamPillar`
- **Values**: `vw_Timesheet.Project`
- **Values**: `vw_Timesheet.ProjectProfile`

Key settings include:
- **Selection**: Allows multiple selections (singleSelect is false) and has a select all checkbox enabled.
- **Self Filter**: Enabled.
- **Header**: Not shown.
- **Background**: Uses a solid color from the theme.
- **Font**: Segoe UI with a text size of 9D.

The visual is configured to allow inverted selection mode and is set to display in a dropdown format.

### Visual Identifier: `11000_Actual vs Budget`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/11000_Actual vs Budget`)

The visual is a **pivot table**. 

**Main Data Fields:**
- Values: 
  - Min(tbl_Project.PlannedCompletionDate)
  - Min(vw_Timesheet.IPM_ManagerName)
  - Min(tbl_Project.Status)
  - CountNonNull(tbl_Project.SalesPriceBaseCurrency)
  - Sum(vw_Timesheet.Hours)
  - Sum(vw_Timesheet.SalesAmount)
  - vw_Timesheet.MSR_AVG_HOURLY_RATE
  - vw_Timesheet.MSR_PROJECT_%_REALIZATION
  - vw_Timesheet.MSR_ProjectMargin
- Rows: 
  - tbl_Project.ProjectGroupDescription
  - vw_Timesheet.Project
  - vw_Timesheet.Own-Sub-ExtT
  - vw_Timesheet.EmployeeName
- Columns: 
  - DimDate.CalendarYear
  - DimDate.WeekNumberOfYear

**Filters:**
- Active filters include ProjectGroupDescription, Project, Own-Sub-ExtT, and EmployeeName.

**Key Settings:**
- The visual is set to use a dropdown mode for selection.
- The header is hidden with a background color of #3C6E71.
- Font family is set to 'Segoe UI' with a text size of 9D for items and 10D for numeric input.
- Single selection is disabled, but a select all checkbox is enabled.

### Visual Identifier: `12000_image (3e3f0)`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/12000_image (3e3f0)`)

The visual is an **image** type. It displays an image sourced from the resource package named **"RegisteredResources"**, specifically the file **"Devoteam_rgb_group8358853173377017.jpg"**. The image scaling is set to **"Fit"**.

Key settings include:
- **Border**: Enabled with a radius of **5D** and a color of **#B4C0D2**.
- **Drop Shadow**: Disabled.
- **Visual Link**: Disabled.
- **Drill Filter Other Visuals**: Enabled.

The visual is positioned at coordinates (x: 4.12, y: 0) with a width of approximately **59.51** and height of approximately **58.92**.

### Visual Identifier: `13000_Project Leader`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/13000_Project Leader`)

**Visual Type:** Dropdown

**Main Data Fields:**
- ProjectGroupDescription (from tbl_Project)
- Project (from vw_Timesheet)
- Own-Sub-ExtT (from vw_Timesheet)
- EmployeeName (from vw_Timesheet)
- ProjectProfile (from vw_Timesheet)
- DevoteamPillar (from tbl_Project)

**Filters:**
- Time material
- Fixed price

**Key Settings:**
- Self-filtering enabled
- Select all checkbox enabled
- Multi-select allowed
- Header hidden
- Background color based on theme
- Font: Segoe UI, size 9D
- Inverted selection mode enabled

### Visual Identifier: `14000_actionButton (f3f38)`
(Source Path Hint: `C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/14000_actionButton (f3f38)`)

The visual is an **action button** configured with a dropdown mode. It utilizes data from the following main fields: `tbl_Project.ProjectGroupDescription`, `vw_Timesheet.Project`, `vw_Timesheet.Own-Sub-ExtT`, and `vw_Timesheet.EmployeeName`. 

Key settings include:
- **Header**: Hidden with a background color of `#3C6E71`.
- **Font**: Uses 'Segoe UI' with a text size of 9D for items and 10D for numeric input.
- **Selection**: Allows multiple selections with a "Select All" checkbox enabled.
- **Date Range**: Excludes today from the selection.

The visual is pinned to specific identity keys and has toggled options for "Time material" and "Fixed price".

