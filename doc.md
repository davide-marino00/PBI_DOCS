# Power BI Solution Documentation

Generated by Langchain Documentation Agent
Date: 2025-04-24 19:15:41

## Table of Contents

* [1. Overview](#1-overview)
* [2. Data Model](#2-data-model)
  * [2.1 Tables](#21-tables)
  * [2.2 Measures](#22-measures)
  * [2.3 Relationships](#23-relationships)
* [3. Report Pages & Visuals](#3-report-pages--visuals)
  * [Page: 000_Customer Analysis](#page-000_customer-analysis)
  * [Page: 001_Project Details](#page-001_project-details)

---

## 1. Overview

Power BI is a powerful business analytics tool that enables users to visualize data and share insights across their organization or embed them in an app or website. This specific Power BI solution focuses on analyzing timesheet data, sales performance, and employee metrics, providing a comprehensive view of business operations. The solution integrates data from various sources, including SQL databases, to create a robust data model that supports detailed reporting and analysis.

Key components of this Power BI solution include measures and calculated columns that summarize critical business metrics such as Sales Amount, Hours Worked, and Project Margins. The data model leverages multiple tables, including `vw_Timesheet`, `tbl_Project`, and `DimDate`, to facilitate complex calculations and visualizations. Users can explore data through pivot tables and other visual elements, allowing for dynamic filtering and drill-down capabilities to gain deeper insights into performance metrics over time. Overall, this Power BI solution is designed to enhance decision-making by providing actionable insights derived from comprehensive data analysis.

## 2. Data Model

### 2.1 Tables

#### Table: `dim_date_has_date_key`

### Table: dim_date_has_date_key

**Purpose:**  
The `dim_date_has_date_key` table serves as a relationship mapping between the `DimDate` table and its various date attributes, facilitating the analysis of date-related data.

**Key Columns:**
- **DateKey**: (int64) A unique identifier for each date.
- **ShortDate**: (dateTime) The date in a long format.
- **DayName**: (string) The name of the day (e.g., Monday).
- **DayNumberOfWeek**: (int64) The numerical representation of the day in the week (1-7).
- **DayNumberOfMonth**: (int64) The day of the month (1-31).
- **DayNumberOfYear**: (int64) The day of the year (1-365).
- **WeekNumberOfYear**: (int64) The week number in the year.
- **MonthName**: (string) The name of the month.
- **MonthNumberOfYear**: (int64) The month number (1-12).
- **CalendarQuarter**: (string) The quarter of the year (e.g., Q1).
- **CalendarYear**: (int64) The year of the date.
- **CurrentYearFlag**: (int64) A flag indicating if the date is in the current year (1 for yes, 0 for no). 

**Annotations:**
- All columns are set to summarize automatically, indicating their values can be aggregated for reporting purposes.

#### Table: `onedrive_unit.OWNsubExtT`

### Table Documentation: `onedrive_unit.OWNsubExtT`

**Purpose:**  
The `onedrive_unit.OWNsubExtT` table is designed to provide a mapping or reference for organizational units, specifically focusing on the "OWN-Sub-ExtT" property within the `lkp_Unit` conceptual entity.

**Definition:**  
- **Binding:** 
  - **Conceptual Entity:** `lkp_Unit`
  - **Conceptual Property:** `OWN-Sub-ExtT`

**State:**  
- Generated

**Key Columns:**
- **OWN-Sub-ExtT**: 
  - Data Type: String
  - Summarization: None
  - Source Column: `OWN-Sub-ExtT`

**Additional Information:**
- The table includes terms related to the "OWN-Sub-ExtT" property, which are generated and suggested based on a thesaurus. 

This table serves as a reference for understanding the organizational structure and categorization within the system.

#### Table: `onedrive_unit_has_OWNsubExtT`

### Table: onedrive_unit_has_OWNsubExtT

**Purpose:**  
This table appears to link the `onedrive_unit` entity with the `OWN-Sub-ExtT` property from the `lkp_Unit` conceptual entity, facilitating the association of organizational units with their respective sub-extensions.

**Key Columns:**
- **OWN-Sub-ExtT**: This column is of type string and is used to represent the sub-extension type associated with the organizational unit.

**State:**  
Generated

**Binding:**  
- **ConceptualEntity**: lkp_Unit
- **ConceptualProperty**: OWN-Sub-ExtT

**Terms:**
- **OWN-sub-ExtT**: State is Generated
- **OWN sub ExtT**: State is Generated

This table is part of a broader data structure that includes various organizational units and their attributes, likely used for reporting or analytical purposes.

#### Table: `pbi_timesheet.IPMID_name`

### Table: pbi_timesheet.IPMID_name

**Purpose:**  
This table is designed to store and manage information related to IPMID names within the context of timesheet data.

**Definition:**  
- **Binding:** Connects to the conceptual entity `vw_Timesheet` with the property `IPMIDName`.

**State:**  
- Generated

**Key Terms:**  
- **IPMID name:** State - Generated
- **IPMIDName:** Type - Noun, State - Generated, Weight - 0.99
- **IPMID:** State - Generated, Weight - 0.97
- **ipmid nickname:** Type - Noun, State - Suggested, Weight - 0.727
- **ipmid title:** Type - Noun, State - Suggested, Weight - 0.727
- **ipmid label:** Type - Noun, State - Suggested, Weight - 0.727
- **ipmid tag:** Type - Noun, State - Suggested, Weight - 0.727

**Notes:**  
The table includes various suggested terms related to IPMID, indicating potential synonyms or alternative labels that may be used in different contexts.

#### Table: `pbi_timesheet.tier`

### Table Documentation: `pbi_timesheet.tier`

**Purpose**: The `pbi_timesheet.tier` table is designed to categorize and define tiers associated with timesheet entries in the `vw_Timesheet` conceptual entity.

**Definition**:
- **Binding**: 
  - **Conceptual Entity**: `vw_Timesheet`
  - **Conceptual Property**: `Tier`

**State**: Generated

**Key Columns**:
- **tier**: Represents the tier classification (State: Generated).
- **row**: A noun representing a row in the context of the table (Type: Noun, State: Suggested).
- **HoursType**: Indicates the type of hours associated with the tier (Type: Noun, State: Generated, Weight: 0.99).
- **type**: General classification type (State: Generated, Weight: 0.97).

**Terms**: 
- Various terms related to hours and classifications, including:
  - **hour category**
  - **hour genre**
  - **hour manner**
  - **hour variety**
  - **genre**
  - **manner**
  - **variety**
  - **hour brand**
  - **hour class**
  - **hour kind**

These terms are suggested nouns sourced from a thesaurus, indicating their relevance to the tier classification. 

This table serves as a foundational component for managing and analyzing timesheet data by categorizing entries into defined tiers.

#### Table: `pbi_timesheet.total_hours_delta`

# Documentation for Table: `pbi_timesheet.total_hours_delta`

## Purpose
The `pbi_timesheet.total_hours_delta` table is designed to track and summarize various metrics related to timesheet hours, including actual hours worked, missing hours, and approval statuses. It serves as a comprehensive overview of time tracking for projects and employees.

## Key Columns

- **Hours_**: 
  - **Data Type**: double
  - **Summary**: Sum of hours recorded.

- **ActualHours**: 
  - **Data Type**: double
  - **Summary**: Sum of actual hours worked.

- **MissingHours**: 
  - **Data Type**: double
  - **Summary**: Sum of hours that are missing.

- **Approved**: 
  - **Data Type**: boolean
  - **Summary**: Indicates if the timesheet is approved.

- **ReportReady**: 
  - **Data Type**: boolean
  - **Summary**: Indicates if the report is ready.

- **Rejected**: 
  - **Data Type**: boolean
  - **Summary**: Indicates if the timesheet is rejected.

- **TimesheetCode**: 
  - **Data Type**: string
  - **Summary**: Code associated with the timesheet.

- **TimesheetDescription**: 
  - **Data Type**: string
  - **Summary**: Description of the timesheet.

- **IngestDatetime**: 
  - **Data Type**: dateTime
  - **Summary**: Date and time when the data was ingested.

- **ContractStatusToday**: 
  - **Data Type**: string
  - **Summary**: Current status of the contract.

- **MAIN_UNIT**: 
  - **Data Type**: string
  - **Summary**: Unit associated with the timesheet, defaults to "Unknown" if not found.

- **ProjectCode**: 
  - **Data Type**: string
  - **Summary**: Code for the project associated with the timesheet.

- **Project**: 
  - **Data Type**: string
  - **Summary**: Name of the project associated with the timesheet.

- **BillableDep**: 
  - **Data Type**: integer (derived)
  - **Summary**: Indicates if the unit is billable.

- **YearWeek**: 
  - **Data Type**: string (derived)
  - **Summary**: Year and week number of the contract end date.

- **IncompleteFlag**: 
  - **Data Type**: integer (derived)
  - **Summary**: Flag indicating if there are missing hours.

- **SalesPrice**: 
  - **Data Type**: double
  - **Summary**: Sum of sales price associated with the hours.

This table is essential for analyzing time tracking data, ensuring accurate reporting, and managing project resources effectively.

#### Table: `pbi_timesheet_has_MSR__Budget_Used`

### Table Documentation: `pbi_timesheet_has_MSR__Budget_Used`

**Purpose**: This table serves to link the `pbi_timesheet` entity with the `pbi_timesheet.MSR__Budget_Used` entity, facilitating the analysis of budget usage in relation to timesheet entries.

**State**: Generated

**Key Roles**:
- **pbi_timesheet**: Represents the timesheet entries.
- **pbi_timesheet.MSR__Budget_Used**: Represents the budget used associated with the timesheet entries.

**Phrasings**:
- The relationship is expressed as: "pbi_timesheet has pbi_timesheet.MSR__Budget_Used".

**Key Columns**:
- **Hours_**: (Data Type: double) - Total hours recorded.
- **ActualHours**: (Data Type: double) - Actual hours worked.
- **MissingHours**: (Data Type: double) - Hours that are missing.
- **Approved**: (Data Type: boolean) - Indicates if the timesheet is approved.
- **ReportReady**: (Data Type: boolean) - Indicates if the report is ready.
- **Rejected**: (Data Type: boolean) - Indicates if the timesheet is rejected.
- **TimesheetCode**: (Data Type: string) - Code associated with the timesheet.
- **TimesheetDescription**: (Data Type: string) - Description of the timesheet.
- **IngestDatetime**: (Data Type: dateTime) - Date and time when the data was ingested.
- **ProjectCode**: (Data Type: string) - Code for the associated project.
- **SalesPrice**: (Data Type: double) - Sales price associated with the timesheet.

This table is essential for tracking and analyzing budget utilization against timesheet data, providing insights into project financials.

#### Table: `pbi_timesheet_has_msr_sales_price_base_currency`

### Table: `pbi_timesheet_has_msr_sales_price_base_currency`

**Purpose:**  
This table serves to link the `pbi_timesheet` entity with the `msr_sales_price_base_currency` attribute, facilitating the association of timesheet entries with their corresponding sales price in the base currency.

**State:**  
Generated

**Key Columns:**
- **pbi_timesheet**: Represents the timesheet entries.
- **msr_sales_price_base_currency**: Represents the sales price in the base currency.

**Roles:**
- **pbi_timesheet**: Target entity is `pbi_timesheet`.
- **pbi_timesheet.msr_sales_price_base_currency**: Target entity is `pbi_timesheet.msr_sales_price_base_currency`.

**Phrasings:**
- The table includes generated phrasing attributes linking the `pbi_timesheet` to the `msr_sales_price_base_currency`.

**Binding:**  
Conceptual entity is `vw_Timesheet`.

#### Table: `pbi_timesheet_has_total_hours_delta`

### Table: `pbi_timesheet_has_total_hours_delta`

**Purpose:**  
This table appears to be designed for tracking and summarizing various metrics related to timesheet entries, including total hours worked, actual hours, and missing hours. It likely serves as a data source for reporting and analysis in a business intelligence context.

**Key Columns:**

1. **Hours_**  
   - **Data Type:** Double  
   - **Summarization:** Sum  
   - **Source Column:** Hours_

2. **ActualHours**  
   - **Data Type:** Double  
   - **Summarization:** Sum  
   - **Source Column:** ActualHours

3. **MissingHours**  
   - **Data Type:** Double  
   - **Summarization:** Sum  
   - **Source Column:** MissingHours

4. **Approved**  
   - **Data Type:** Boolean  
   - **Format String:** """TRUE"";""TRUE"";""FALSE"""  
   - **Summarization:** None  
   - **Source Column:** Approved

5. **ReportReady**  
   - **Data Type:** Boolean  
   - **Format String:** """TRUE"";""TRUE"";""FALSE"""  
   - **Summarization:** None  
   - **Source Column:** ReportReady

6. **Rejected**  
   - **Data Type:** Boolean  
   - **Format String:** """TRUE"";""TRUE"";""FALSE"""  
   - **Summarization:** None  
   - **Source Column:** Rejected

7. **TimesheetCode**  
   - **Data Type:** String  
   - **Summarization:** None  
   - **Source Column:** TimesheetCode

8. **TimesheetDescription**  
   - **Data Type:** String  
   - **Summarization:** None  
   - **Source Column:** TimesheetDescription

9. **IngestDatetime**  
   - **Data Type:** DateTime  
   - **Format String:** General Date  
   - **Summarization:** None  
   - **Source Column:** IngestDatetime

10. **ContractStatusToday**  
    - **Data Type:** String  
    - **Summarization:** None  
    - **Source Column:** ContractStatusToday

11. **ProjectCode**  
    - **Data Type:** String  
    - **Summarization:** None  
    - **Source Column:** ProjectCode

12. **Project**  
    - **Data Type:** String  
    - **Summarization:** None  
    - **Source Column:** Project

**Additional Notes:**  
The table includes various calculated fields and measures that provide insights into employee hours, contract statuses, and project billing, which are essential for effective timesheet management and reporting.

#### Table: `tbl_Project`

# Documentation for Table `tbl_Project`

## Purpose
The `tbl_Project` table is designed to store detailed information about various projects, including their attributes, financial details, and status.

## Key Columns
- **ProjectKey** (int64): Unique identifier for each project.
- **Project** (string): Name of the project.
- **ProjectDescription** (string): Description of the project.
- **ProjectGroup** (string): Group to which the project belongs.
- **Statuscode** (string): Code representing the current status of the project.
- **Status** (string): Descriptive status of the project.
- **ProjectleaderId** (string): Identifier for the project leader.
- **TotalContractSum** (decimal): Total sum of the contract associated with the project.
- **SalesPriceBaseCurrency** (decimal): Sales price in the base currency.
- **DateCreated** (dateTime): Date when the project was created.
- **Startdate** (dateTime): Start date of the project.
- **PlannedCompletionDate** (dateTime): Expected completion date of the project.
- **ActualDateCompleted** (dateTime): Actual completion date of the project.
- **ClientNumber** (string): Identifier for the client associated with the project.
- **ClientName** (string): Name of the client associated with the project.

## Data Types
- **int64**: Integer values.
- **string**: Text values.
- **decimal**: Numeric values with decimal points.
- **dateTime**: Date and time values.

## Annotations
All columns have been set to automatic summarization, indicating that no specific summarization method has been applied. 

## Source
The data is imported from a SQL database (`AFASWarehouse`) and includes a transformation step to replace null values in the `ClientName` column with "Non-Project".

#### Table: `tbl_project`

# Documentation for Table `tbl_project`

## Purpose
The `tbl_project` table is designed to store detailed information about various projects, including their identifiers, descriptions, financial details, and status.

## Key Columns
- **ProjectKey**: Unique identifier for each project (int64).
- **Project**: Name of the project (string).
- **ProjectDescription**: Description of the project (string).
- **ProjectGroup**: Group to which the project belongs (string).
- **ProjectGroupDescription**: Description of the project group (string).
- **Statuscode**: Code representing the status of the project (string).
- **Status**: Current status of the project (string).
- **ProjectleaderId**: Identifier for the project leader (string).
- **Administration**: Administrative details related to the project (string).
- **Currency**: Currency used for financial transactions (string).
- **TotalContractSum**: Total sum of the contract (decimal).
- **SalesPriceBaseCurrency**: Sales price in base currency (decimal).
- **DateCreated**: Date when the project was created (dateTime).
- **Startdate**: Start date of the project (dateTime).
- **PlannedCompletionDate**: Expected completion date of the project (dateTime).

## Data Types
- **int64**: Integer type for numeric identifiers.
- **string**: Textual data for names and descriptions.
- **decimal**: Numeric type for financial values.
- **dateTime**: Date and time type for tracking dates.

## Annotations
All columns have been set to automatic summarization, indicating that they are intended for direct data entry and retrieval without aggregation.

#### Table: `tbl_project.changed_on`

### Documentation for Table `tbl_project.changed_on`

**Purpose:**  
The `tbl_project.changed_on` table is designed to track the date and time when a project was last modified. This information is crucial for project management and auditing purposes.

**Key Columns:**

- **Changed_on**  
  - **Data Type:** dateTime  
  - **Format String:** General Date  
  - **Description:** Records the timestamp of the last change made to the project.  
  - **State:** Generated  
  - **Weight:** 0.99  

**Additional Terms:**
- **changed on** (State: Generated)
- **Changed_on** (Type: Noun, State: Generated, Weight: 0.99)
- **date** (State: Generated, Weight: 0.7)

**Semantic Type:** Time

This table is part of the broader `tbl_Project` entity, which encompasses various attributes related to project management.

#### Table: `tbl_project.client_name`

### Documentation for Table `tbl_project.client_name`

**Purpose:**  
The `tbl_project.client_name` table is designed to store and manage client names associated with various projects within the `tbl_Project` entity. This table facilitates the identification and categorization of clients for project management purposes.

**Key Columns:**

- **ClientName**  
  - **Data Type:** string  
  - **Description:** Represents the name of the client associated with a project.  
  - **Source Column:** ClientName  
  - **Summarization:** None  

**Annotations:**  
- SummarizationSetBy = Automatic  

**Related Terms:**  
- client name (Generated)  
- ClientName (Generated, Weight: 0.99)  
- client nickname (Suggested)  
- client title (Suggested)  
- client label (Suggested)  
- client tag (Suggested)  

This table is integral for linking projects to their respective clients, ensuring clarity and organization in project reporting and management.

#### Table: `tbl_project.client_number`

### Documentation for Table `tbl_project.client_number`

**Purpose:**  
The `tbl_project.client_number` table is designed to store client identification numbers associated with various projects within the `tbl_Project` entity.

**Key Columns:**

- **ClientNumber**
  - **Data Type:** string
  - **Description:** Represents the unique identification number assigned to a client.
  - **Source Column:** ClientNumber
  - **Summarization:** None

**Annotations:**
- SummarizationSetBy: Automatic

**Related Concepts:**
- This table is conceptually linked to the `tbl_Project` entity, indicating that it serves as a property of the project records.

#### Table: `tbl_project.created_on`

### Documentation for Table `tbl_project.created_on`

**Purpose**: The `tbl_project.created_on` column records the date and time when a project was created within the `tbl_Project` entity.

**Key Attributes**:
- **Data Type**: `dateTime`
- **Format String**: General Date
- **Source Column**: `Created_on`
- **State**: Generated
- **Semantic Type**: Time

**Terms**:
- **created on**: State - Generated
- **Created_on**: Type - Noun, State - Generated, Weight - 0.99
- **date**: State - Generated, Weight - 0.7

This column is essential for tracking the creation timeline of projects and is part of the overall project management data structure.

#### Table: `tbl_project.planned_completion_date`

### Documentation for Table: `tbl_project.planned_completion_date`

**Purpose:**  
The `tbl_project.planned_completion_date` table is designed to store the planned completion dates for various projects within the `tbl_Project` entity. This information is crucial for project management and tracking timelines.

**Key Columns:**

1. **PlannedCompletionDate**
   - **Data Type:** dateTime
   - **Format String:** Short Date
   - **Source Column:** PlannedCompletionDate
   - **Annotations:**
     - SummarizationSetBy: Automatic
     - UnderlyingDateTimeDataType: Date

2. **ActualDateCompleted**
   - **Data Type:** dateTime
   - **Format String:** Short Date
   - **Source Column:** ActualDateCompleted
   - **Annotations:**
     - SummarizationSetBy: Automatic
     - UnderlyingDateTimeDataType: Date

3. **ClientNumber**
   - **Data Type:** string
   - **Source Column:** ClientNumber
   - **Annotations:**
     - SummarizationSetBy: Automatic

4. **ClientName**
   - **Data Type:** string
   - **Source Column:** ClientName
   - **Annotations:**
     - SummarizationSetBy: Automatic

5. **DevoteamPillar**
   - **Data Type:** string
   - **Source Column:** DevoteamPillar
   - **Annotations:**
     - SummarizationSetBy: Automatic

**Additional Information:**
- The table includes various terms related to planned completion dates, such as "completion date," "planned completion moment," and "completion period," indicating its semantic relevance to time management in projects.
- The state of the table is marked as "Generated," indicating that it is automatically populated or updated based on underlying data sources.

#### Table: `tbl_project.startdate`

### Documentation for Table `tbl_project.startdate`

**Purpose:**  
The `Startdate` column in the `tbl_Project` table is used to record the starting date of each project. This date is crucial for project management and tracking timelines.

**Key Column Details:**

- **Column Name:** Startdate
- **Data Type:** dateTime
- **Format String:** Long Date
- **Summarization:** None
- **Source Column:** Startdate
- **Annotations:**
  - SummarizationSetBy: Automatic
  - UnderlyingDateTimeDataType: Date

**Semantic Type:** Time

This column is essential for understanding the timeline of projects and is linked to other project attributes for comprehensive project management analysis.

#### Table: `tbl_project.status`

### Documentation for Table `tbl_project.status`

**Purpose:**  
The `tbl_project.status` table is designed to capture the status of various projects within the `tbl_Project` entity. It provides a way to categorize and track the current state of projects.

**Key Columns:**

- **Status**  
  - **Data Type:** string  
  - **Description:** Represents the current status of the project. 

- **Statuscode**  
  - **Data Type:** string  
  - **Description:** A code that corresponds to the status of the project, providing a standardized way to reference project states.

**Annotations:**  
Both columns are set to be summarized automatically, indicating that they are integral to the project's reporting and analysis processes.

#### Table: `tbl_project.statuscode`

### Documentation for Table `tbl_project.statuscode`

**Purpose**: The `tbl_project.statuscode` table is designed to represent the status codes associated with projects within the `tbl_Project` entity. It serves as a binding to the status codes that categorize the state of projects.

**Key Columns**:
- **statuscode**: This column holds the status code values for projects. It is of type `string` and is generated as part of the table's structure.

**State**: The table is marked as "Generated," indicating that it has been automatically created based on the underlying data model.

**Binding**:
- **Conceptual Entity**: `tbl_Project`
- **Conceptual Property**: `Statuscode` 

This table is integral for tracking and managing the various statuses that projects can have, facilitating better project management and reporting.

#### Table: `tbl_project_has_actual_date_completed`

### Table: `tbl_project_has_actual_date_completed`

**Purpose:**  
This table is designed to associate projects with their actual completion dates, providing a record of when each project was completed.

**Key Columns:**

1. **ActualDateCompleted**
   - **Data Type:** dateTime
   - **Format String:** Short Date
   - **Source Column:** ActualDateCompleted
   - **Annotations:** 
     - SummarizationSetBy = Automatic
     - UnderlyingDateTimeDataType = Date

2. **PlannedCompletionDate**
   - **Data Type:** dateTime
   - **Format String:** Short Date
   - **Source Column:** PlannedCompletionDate
   - **Annotations:** 
     - SummarizationSetBy = Automatic
     - UnderlyingDateTimeDataType = Date

3. **ClientNumber**
   - **Data Type:** string
   - **Source Column:** ClientNumber
   - **Annotations:** 
     - SummarizationSetBy = Automatic

4. **ClientName**
   - **Data Type:** string
   - **Source Column:** ClientName
   - **Annotations:** 
     - SummarizationSetBy = Automatic

5. **DevoteamPillar**
   - **Data Type:** string
   - **Source Column:** DevoteamPillar
   - **Annotations:** 
     - SummarizationSetBy = Automatic

**Binding:**  
- **Conceptual Entity:** `tbl_Project`
- **Roles:** 
  - `tbl_project` (Target: `tbl_project`)
  - `tbl_project.actual_date_completed` (Target: `tbl_project.actual_date_completed`)

**State:** Generated

**Phrasings:**  
- The table captures the relationship between projects and their actual completion dates, ensuring accurate tracking of project timelines.

#### Table: `tbl_project_has_changed_on`

### Documentation for Table: `tbl_project_has_changed_on`

**Purpose:**  
This table serves to establish a relationship between projects and their change timestamps, specifically tracking when a project was last modified.

**Key Columns:**
- **tbl_project**: Represents the project entity.
- **tbl_project.changed_on**: Indicates the date and time when the project was last changed.

**State:**  
Generated

**Roles:**
- **tbl_project**: Target entity representing the project.
- **tbl_project.changed_on**: Target entity representing the change timestamp of the project.

**Phrasings:**  
- "Projects have changed on" - Describes the relationship between projects and their change dates. 

This table is part of a broader schema that includes various attributes related to project management, focusing on tracking changes over time.

#### Table: `tbl_project_has_client_number`

### Documentation for Table: `tbl_project_has_client_number`

**Purpose:**  
The `tbl_project_has_client_number` table serves to establish a relationship between projects and their associated client numbers, linking project data with client identification.

**Key Columns:**
- **tbl_project**: Represents the project entity.
- **tbl_project.client_number**: Represents the client number associated with the project.

**State:**  
Generated

**Roles:**
- **tbl_project**: Target entity is `tbl_project`.
- **tbl_project.client_number**: Target entity is `tbl_project.client_number`.

**Phrasings:**  
- The table captures the relationship where a project has a corresponding client number.

#### Table: `tbl_project_has_pbi_timesheet_MSR__Budget_Used`

### Table Documentation: `tbl_project_has_pbi_timesheet_MSR__Budget_Used`

**Purpose:**  
This table serves as a binding entity that connects project data from `tbl_Project` with timesheet data related to budget usage, specifically for the `pbi_timesheet.MSR__Budget_Used` entity.

**Key Columns:**
- **ProjectKey** (int64): Unique identifier for each project.
- **Project** (string): Name of the project.
- **ProjectDescription** (string): Description of the project.
- **Statuscode** (string): Current status code of the project.
- **Status** (string): Current status of the project.
- **TotalContractSum** (decimal): Total sum of the contract associated with the project.
- **SalesPriceBaseCurrency** (decimal): Sales price in the base currency.
- **DateCreated** (dateTime): Date when the project was created.
- **Startdate** (dateTime): Start date of the project.
- **PlannedCompletionDate** (dateTime): Planned completion date of the project.
- **ActualDateCompleted** (dateTime): Actual completion date of the project.
- **ClientNumber** (string): Identifier for the client associated with the project.
- **ClientName** (string): Name of the client associated with the project.
- **DevoteamPillar** (string): Pillar under which the project falls.

**Annotations:**
- The table is generated and automatically summarizes data.
- It includes roles that link to both `tbl_project` and `pbi_timesheet.MSR__Budget_Used` entities, indicating its relational context within the data model.

#### Table: `tbl_project_has_planned_completion_date`

### Table Documentation: `tbl_project_has_planned_completion_date`

**Purpose:**  
This table is designed to associate projects with their planned completion dates, facilitating project management and tracking.

**Key Columns:**
- **PlannedCompletionDate**: 
  - **Data Type**: dateTime
  - **Format**: Short Date
  - **Description**: Represents the date when the project is planned to be completed.

**Additional Information:**
- The table is generated and includes roles that link to the `tbl_project` entity, indicating its relationship with project data.
- The semantic type associated with this table is "Time," highlighting its focus on date-related information. 

**State:** Generated

#### Table: `tbl_project_has_project`

### Table: `tbl_project_has_project`

**Purpose:**  
This table serves as a linking entity that associates projects with their respective attributes or descriptions, facilitating the management and retrieval of project-related information.

**Key Columns:**
- **tbl_project**: References the main project entity.
- **tbl_project.project**: Represents the specific project associated with the entry.

**Annotations:**
- The table is generated and maintains a conceptual binding to the `tbl_Project` entity, indicating its role in the overall project management schema. 

**State:**  
Generated

#### Table: `tbl_project_has_project_description`

### Table: `tbl_project_has_project_description`

**Purpose**: This table serves to establish a relationship between projects and their descriptions, linking the `tbl_Project` entity with the `ProjectDescription` attribute.

**Key Columns**:
- **tbl_project**: References the primary project entity.
- **tbl_project.project_description**: References the description associated with the project.

**State**: Generated

**Roles**:
- **tbl_project**: Target entity is `tbl_project`.
- **tbl_project.project_description**: Target entity is `tbl_project.project_description`.

**Phrasings**:
- The relationship is defined as: 
  - Subject: `tbl_project`
  - Object: `tbl_project.project_description`
  
**ID**: `tbl_projects_have_project_descriptions`

#### Table: `tbl_project_has_project_group`

### Table: `tbl_project_has_project_group`

**Purpose:**  
This table serves to establish a relationship between projects and their associated project groups, facilitating the organization and categorization of projects within a system.

**Key Columns:**
- **tbl_project**: References the project entity.
- **tbl_project.project_group**: References the project group entity.

**State:** Generated

**Roles:**
- **tbl_project**: Target entity representing the project.
- **tbl_project.project_group**: Target entity representing the project group.

**Phrasings:**
- Establishes a relationship where a project can have one or more associated project groups. 

This table is essential for managing project classifications and ensuring that projects are grouped appropriately for better tracking and reporting.

#### Table: `tbl_project_has_project_group_description`

### Table: `tbl_project_has_project_group_description`

**Purpose:**  
This table serves as a linking entity that associates projects with their respective project group descriptions, facilitating the organization and categorization of projects within a project management system.

**Key Columns:**
- **Binding:** 
  - **ConceptualEntity:** `tbl_Project`
  
- **Roles:**
  - **tbl_project:** 
    - **Target:** `tbl_project`
  - **tbl_project.project_group_description:** 
    - **Target:** `tbl_project.project_group_description`

**State:** Generated

**Phrasings:**
- **Attribute:** 
  - **Subject:** `tbl_project`
  - **Object:** `tbl_project.project_group_description`
  
**ID:** `tbl_projects_have_project_group_descriptions` 

This table is essential for establishing relationships between projects and their descriptions, enhancing data integrity and retrieval in project management applications.

#### Table: `tbl_project_has_projectleader_id`

### Table: `tbl_project_has_projectleader_id`

**Purpose:**  
This table serves to establish a relationship between projects and their respective project leaders, linking the `tbl_Project` entity with the `ProjectleaderId` attribute.

**Key Columns:**
- **tbl_project**: Represents the project entity.
- **tbl_project.projectleader_id**: Represents the identifier for the project leader associated with the project.

**State:** Generated

**Roles:**
- **tbl_project**: Target entity representing the project.
- **tbl_project.projectleader_id**: Target entity representing the project leader's identification.

**Phrasings:**
- The relationship is defined as "tbl_projects_have_projectleader_ids," indicating that multiple projects can be associated with a project leader.

#### Table: `tbl_project_has_status`

### Table: `tbl_project_has_status`

**Purpose:**  
This table serves to establish a relationship between projects and their corresponding status codes and descriptions, facilitating the tracking and management of project statuses.

**Key Columns:**
- **ProjectKey** (int64): Unique identifier for each project.
- **Statuscode** (string): Code representing the status of the project.
- **Status** (string): Descriptive label of the project's status.

**Annotations:**
- All columns are set to summarize by none, indicating that they are not aggregated in reports. 
- The table is generated and maintains a binding to the conceptual entity `tbl_Project`.

#### Table: `tbl_project_has_statuscode`

### Table Documentation: `tbl_project_has_statuscode`

**Purpose:**  
The `tbl_project_has_statuscode` table serves to establish a relationship between projects and their corresponding status codes within the `tbl_Project` entity. This linkage allows for the categorization and tracking of project statuses.

**Key Columns:**
- **tbl_project**: Represents the project entity.
- **tbl_project.statuscode**: Represents the status code associated with the project.

**State:**  
Generated

**Roles:**
- **tbl_project**: Target entity representing the project.
- **tbl_project.statuscode**: Target entity representing the status code.

**Phrasings:**
- The relationship is defined as: 
  - Subject: `tbl_project`
  - Object: `tbl_project.statuscode`
  
**ID:** `tbl_projects_have_statuscodes`

#### Table: `vw_missing_timesheet.dax_emp_count`

# Documentation for Table: `vw_missing_timesheet.dax_emp_count`

## Purpose
The `vw_missing_timesheet.dax_emp_count` table is designed to provide insights into the count of employees with missing timesheet entries, specifically focusing on those who have not reported their hours accurately against their contracted hours.

## Key Columns
- **Year_**: (int64) Represents the year of the timesheet entry.
- **Week_**: (int64) Represents the week number of the timesheet entry.
- **ShortDate**: (dateTime) The date of the timesheet entry.
- **ManagerID**: (string) Identifier for the manager associated with the employee.
- **ManagerName**: (string) Name of the manager associated with the employee.
- **EmployeeID**: (string) Unique identifier for the employee.
- **EmployeeName**: (string) Name of the employee.
- **ContractStartDate**: (dateTime) The start date of the employee's contract.
- **ContractEndDate**: (dateTime) The end date of the employee's contract.
- **ContractHours**: (int64) The total hours contracted for the employee.
- **SubUnit**: (string) The sub-unit within the organization the employee belongs to.
- **Hours_**: (double) The total hours reported by the employee.

## Measures
- **Dax_EmpCount_MissingTS**: Counts the number of active employees with missing timesheet hours.
- **Dax_EmpCount**: Calculates the distinct count of employees.
- **MISSING%**: Computes the percentage of missing timesheet entries relative to the total employee count.

## Annotations
- The table includes various annotations for formatting and summarization, ensuring that data is presented in a user-friendly manner. 

This table is essential for tracking employee compliance with timesheet reporting and identifying discrepancies in reported hours versus contracted hours.

#### Table: `vw_missing_timesheet.missing`

# Documentation for Table `vw_missing_timesheet.missing`

## Purpose
The `vw_missing_timesheet.missing` table is designed to track and analyze missing timesheet entries for employees, focusing on identifying negative hours and completeness of timesheet submissions.

## Key Columns
- **Year_**: (int64) Represents the year of the timesheet entry.
- **Week_**: (int64) Represents the week number of the timesheet entry.
- **ShortDate**: (dateTime) The short date format of the timesheet entry.
- **ManagerID**: (string) The ID of the manager associated with the employee.
- **ManagerName**: (string) The name of the manager.
- **EmployeeID**: (string) Unique identifier for the employee.
- **EmployeeName**: (string) Name of the employee.
- **ContractStartDate**: (dateTime) The start date of the employee's contract.
- **ContractEndDate**: (dateTime) The end date of the employee's contract.
- **ContractHours**: (int64) Total hours contracted for the employee.
- **SubUnit**: (string) The sub-unit within the organization.
- **Hours_**: (double) Total hours logged by the employee.
- **Approved_With_V_Z**: (int) Indicator if the timesheet is approved or has specific codes.
- **RReady_With_V_Z**: (int) Indicator if the report is ready or has specific codes.
- **Join_Key**: (string) Key for joining with other tables.
- **ContractStatusTodayPBI**: (string) Current status of the contract.
- **Index**: (int64) Index for the entry.
- **IPM_ManagerName**: (string) Name of the IPM manager.
- **IPMIDName**: (string) Name associated with the IPM ID.
- **ReportingEntity**: (string) Entity reporting the timesheet.
- **cc_Employer**: (string) Employer classification.

## Measures
- **Count_Negative_Consultant**: Counts distinct employees with negative missing hours.
- **CountNegativeMissingHours**: Counts distinct employee IDs with negative missing hours.
- **MissingHoursOut**: Calculates the difference between contracted hours and logged hours.
- **ExpectedContractHoursWeekly**: Sums expected contract hours weekly for employees.
- **PercentageCompleteness**: Calculates the percentage of completeness based on missing hours.
- **UniqueEmployeesPerUnit**: Counts unique employees per unit with incomplete flags.
- **Dax_MissingHours**: Calculates total missing hours for active employees.
- **Dax_EmpCount_MissingTS**: Counts active employees with missing timesheets.
- **Dax_EmpCount**: Counts distinct employees.
- **MISSING%**: Calculates the percentage of missing timesheets.

This table serves as a crucial resource for monitoring employee timesheet compliance and identifying discrepancies in logged hours.

### 2.2 Measures

#### Measure: `ContractStatus2`

### DAX Measure: ContractStatus2

**Purpose:**  
The `ContractStatus2` measure evaluates the status of a contract based on the `ContractStatusMeasure`. If the contract is active, it returns the difference in hours; otherwise, it indicates that the contract is "Not Active".

**Formula:**  
```DAX
IF(
    [ContractStatusMeasure] = "Active",
    [HoursDifference],
    "Not Active"
)
```

**Format Hint:**  
- General Number (isGeneralNumber: true)

#### Measure: `ContractStatusMeasure`

### Measure: ContractStatusMeasure

**Purpose:**  
The `ContractStatusMeasure` is designed to determine the current status of a contract based on its end date. It categorizes contracts as either "Active" or "Not Active".

**Formula:**  
```DAX
IF(
    ISBLANK(MAX('vw_Timesheet'[ContractEndDate])) || MAX('vw_Timesheet'[ContractEndDate]) > TODAY(),
    "Active",
    "Not Active"
)
```

**Output:**  
- Returns "Active" if the contract end date is blank or greater than today's date.
- Returns "Not Active" if the contract end date is less than or equal to today's date.

#### Measure: `CountNegativeMissingHours`

### Measure: CountNegativeMissingHours

**Purpose:**  
The `CountNegativeMissingHours` measure calculates the distinct count of employees who have negative missing hours recorded in the `vw_missing_timesheet` table. This measure helps identify employees with discrepancies in their reported hours.

**Formula:**  
```DAX
CountNegativeMissingHours = 
CALCULATE(
    DISTINCTCOUNT('vw_missing_timesheet'[EmployeeID]),
    'vw_missing_timesheet'[MissingHours] < 0
)
```

**Format String:**  
0

#### Measure: `Count_Negative_Consultant`

### DAX Measure: Count_Negative_Consultant

**Purpose:**  
The `Count_Negative_Consultant` measure calculates the number of distinct employees from the `vw_missing_timesheet` table who have negative missing hours.

**Formula:**  
```DAX
Count_Negative_Consultant = 
CALCULATE(
    DISTINCTCOUNT('vw_missing_timesheet'[EmployeeName]),
    'vw_missing_timesheet'[MissingHours] < 0
)
```

**Format String:**  
0

#### Measure: `CurrentWeekCard`

### DAX Measure: CurrentWeekCard

**Purpose:**  
The `CurrentWeekCard` measure is designed to return the current week number of the year based on the current date.

**Formula:**  
```DAX
CurrentWeekCard = WEEKNUM(TODAY())
```

**Format:**  
- Format String: 0

#### Measure: `DISTINCT_COUNT_EMP`

### DAX Measure: `DISTINCT_COUNT_EMP`

**Purpose:**  
The `DISTINCT_COUNT_EMP` measure calculates the distinct count of employees based on their names from the `vw_Timesheet` table.

**Formula:**  
```DAX
DISTINCT_COUNT_EMP = DISTINCTCOUNT(vw_Timesheet[EmployeeName])
```

**Format:**  
- Format String: `0` (General Number)

#### Measure: `Dax_EmpCount`

### DAX Measure: `Dax_EmpCount`

**Purpose:**  
The `Dax_EmpCount` measure calculates the distinct count of employees based on the `EmployeeName` field from the `vw_missing_timesheet` table. This measure is useful for understanding the number of unique employees present in the dataset.

**Formula:**  
```DAX
Dax_EmpCount = 
    CALCULATE(
        DISTINCTCOUNT(vw_missing_timesheet[EmployeeName])
    )
```

**Format:**  
- The measure is formatted as a general number (0).

#### Measure: `Dax_EmpCount_Approved`

### DAX Measure: `Dax_EmpCount_Approved`

**Purpose:**  
This measure calculates the distinct count of employees from the `vw_Timesheet` table who have not had their timesheets approved.

**Formula:**  
```DAX
Dax_EmpCount_Approved = 
CALCULATE(
    DISTINCTCOUNT(vw_Timesheet[EmployeeName]),
    vw_Timesheet[Approved] = FALSE()
)
```

**Format:**  
- Format String: 0 (General Number)

#### Measure: `Dax_EmpCount_MissingTS`

### DAX Measure: `Dax_EmpCount_MissingTS`

**Purpose:**  
This measure calculates the count of active employees who have missing timesheet hours, specifically those whose total hours worked are less than their contracted hours.

**Formula:**
```DAX
VAR ActiveEmployees = 
    FILTER(
        SUMMARIZE(
            vw_missing_timesheet,
            vw_missing_timesheet[EmployeeName],
            vw_missing_timesheet[Year_],
            vw_missing_timesheet[Week_],
            lkp_Unit[Unit],
            vw_missing_timesheet[SubUnit],
            "MissingHours", SUM(vw_missing_timesheet[Hours_]) - MAX(vw_missing_timesheet[ContractHours]),
            "MinActiveEmp", MIN(vw_missing_timesheet[CC_ActiveEmployees])
        ),
        [MinActiveEmp] = 1 && [MissingHours] < 0
    )

RETURN COUNTROWS(ActiveEmployees)
```

**Format:**  
- General Number (0)

#### Measure: `Dax_EmpCount_RReady`

### DAX Measure: `Dax_EmpCount_RReady`

**Purpose:**  
This measure calculates the distinct count of employees whose reports are not marked as ready.

**Formula:**  
```DAX
Dax_EmpCount_RReady = 
CALCULATE(
    DISTINCTCOUNT(vw_Timesheet[EmployeeName]),
    vw_Timesheet[ReportReady] = FALSE()
)
```

**Format String:**  
0

**Contextual Notes:**  
- The measure utilizes the `CALCULATE` function to modify the filter context, specifically filtering for employees where the `ReportReady` column is `FALSE`.
- It counts unique employee names from the `vw_Timesheet` table.

#### Measure: `Dax_MissingHours`

### DAX Measure: `Dax_MissingHours`

**Purpose:**  
The `Dax_MissingHours` measure calculates the total missing hours for active employees who have reported negative missing hours in their timesheets. It identifies employees with discrepancies between their reported hours and contracted hours.

**Formula:**  
```DAX
VAR ActiveEmployees = 
    FILTER(
        SUMMARIZE(
            vw_missing_timesheet,
            vw_missing_timesheet[EmployeeName],
            vw_missing_timesheet[Year_],
            vw_missing_timesheet[Week_],
            lkp_Unit[Unit],
            vw_missing_timesheet[SubUnit],
            "MissingHours", SUM(vw_missing_timesheet[Hours_]) - MAX(vw_missing_timesheet[ContractHours]),
            "MinActiveEmp", MIN(vw_missing_timesheet[CC_ActiveEmployees])
        ),
        [MinActiveEmp] = 1 && [MissingHours] < 0
    )

RETURN 
    SUMX(ActiveEmployees, [MissingHours])
```

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `ExpectedContractHoursWeekly`

### DAX Measure: ExpectedContractHoursWeekly

**Purpose:**  
Calculates the total expected contract hours for each employee on a weekly basis, based on the maximum contract hours recorded for each employee in the `vw_missing_timesheet` table.

**Formula:**  
```DAX
SUMX(
    SUMMARIZE(
        vw_missing_timesheet,
        vw_missing_timesheet[Week_],
        vw_missing_timesheet[EmployeeID],
        "ContractHours", MAX(vw_missing_timesheet[ContractHours])
    ),
    [ContractHours]
)
```

**Format Hint:**  
{"isGeneralNumber":true}

#### Measure: `HoursDifference`

### DAX Measure: HoursDifference

**Purpose:**  
The `HoursDifference` measure calculates the difference between the total hours recorded in the `vw_Timesheet` table and the maximum contracted hours per week for the employees.

**Formula:**  
```DAX
HoursDifference = SUM('vw_Timesheet'[Hours]) - MAX('vw_Timesheet'[HoursperWeek])
```

**Format Hint:**  
- The measure is formatted as a general number.

#### Measure: `MISSING%`

### DAX Measure: MISSING%

**Purpose:**  
The `MISSING%` measure calculates the percentage of employees who have missing timesheet entries compared to the total distinct count of employees.

**Formula:**  
```DAX
MISSING% = DIVIDE([Dax_EmpCount]-[Dax_EmpCount_MissingTS],[Dax_EmpCount]) * 100
```

**Annotations:**  
- `PBI_FormatHint`: {"isGeneralNumber":true}

#### Measure: `MSR_%_Budget_Used`

### Measure: MSR_%_Budget_Used

**Purpose:**  
This measure calculates the percentage of the budget that has been utilized based on the total sales amount recorded in the timesheet compared to the total budget allocated for the project.

**Formula:**  
```DAX
DIVIDE(SUM(vw_Timesheet[SalesAmount]), SUM('tbl_Project'[SalesPriceBaseCurrency]), 0)
```

**Format:**  
0.00%;-0.00%;0.00%

#### Measure: `MSR_AVG_HOURLY_RATE`

### DAX Measure: MSR_AVG_HOURLY_RATE

**Purpose:**  
Calculates the average hourly rate by dividing the total sales amount by the total hours worked.

**Formula:**  
```DAX
SUM(vw_Timesheet[SalesAmount]) / SUM(vw_Timesheet[Hours])
```

**Annotations:**  
- Format Hint: `{"isGeneralNumber":true}`

#### Measure: `MSR_Cumulative Cost`

### Measure: MSR_Cumulative Cost

**Purpose:**  
The `MSR_Cumulative Cost` measure calculates the cumulative total of costs incurred up to the selected month in a visual context. This allows users to track the total costs over time, providing insights into spending patterns.

**Formula:**  
```DAX
VAR SelectedMonth = MAX('DimDate'[MonthNumberOfYear])  -- Get the selected month in the visual
RETURN 
CALCULATE(
    SUM(vw_Timesheet[CostAmount]),
    FILTER(
        ALLSELECTED('DimDate'),  
        'DimDate'[MonthNumberOfYear] <= SelectedMonth  -- Include all months up to the current one
    )
)
```

**Format Hint:**  
- General Number: `{"isGeneralNumber":true}`

#### Measure: `MSR_Cumulative Sales`

### DAX Measure: MSR_Cumulative Sales

**Purpose:**  
The `MSR_Cumulative Sales` measure calculates the cumulative sales amount up to the selected month in a visual context. This allows users to see the total sales accumulated over time, providing insights into sales performance.

**Formula:**  
```DAX
VAR SelectedMonth = MAX('DimDate'[MonthNumberOfYear])  -- Get the selected month in the visual
RETURN 
CALCULATE(
    SUM(vw_Timesheet[SalesAmount]),
    FILTER(
        ALLSELECTED('DimDate'),  
        'DimDate'[MonthNumberOfYear] <= SelectedMonth  -- Include all months up to the current one
    )
)
```

**Format Hint:**  
- The measure is formatted as a general number.

#### Measure: `MSR_Cumulative_Revenue`

### DAX Measure: MSR_Cumulative_Revenue

**Purpose:**  
Calculates the cumulative revenue from sales amounts over time, allowing for analysis of revenue trends up to the current date in the selected context.

**Formula:**  
```DAX
CALCULATE(
    SUM(vw_Timesheet[SalesAmount]),
    FILTER(
        ALLSELECTED(DimDate[ShortDate]),
        DimDate[ShortDate] <= MAX(DimDate[ShortDate])
    )
)
```

**Format Hint:**  
{"isGeneralNumber":true}

#### Measure: `MSR_PROJECT_%_REALIZATION`

### DAX Measure: MSR_PROJECT_%_REALIZATION

**Purpose:**  
The measure calculates the percentage realization of project sales against the total sales price in the base currency. It provides insight into how much of the contracted sales price has been realized through actual sales.

**Formula:**  
```DAX
IF(
    SUM(tbl_Project[SalesPriceBaseCurrency]) <> 0, 
    SUM(vw_Timesheet[SalesAmount]) / SUM(tbl_Project[SalesPriceBaseCurrency])
)
```

**Format:**  
- Format String: 0.00%;-0.00%;0.00%  
This format displays the result as a percentage with two decimal places.

#### Measure: `MSR_ProjectMargin`

### DAX Measure: MSR_ProjectMargin

**Purpose:**  
The `MSR_ProjectMargin` measure calculates the profit margin for projects by subtracting the total cost from the total sales amount.

**Formula:**  
```DAX
MSR_ProjectMargin = SUM(vw_Timesheet[SalesAmount]) - SUM(vw_Timesheet[CostAmount])
```

**Format Hint:**  
This measure is formatted as a general number.

#### Measure: `MissingHoursOut`

### DAX Measure: MissingHoursOut

**Purpose:**  
The `MissingHoursOut` measure calculates the difference between the maximum contracted hours and the maximum hours worked for employees in the `vw_missing_timesheet` table. This measure helps identify the total missing hours for employees based on their contractual obligations versus actual hours logged.

**Formula:**  
```DAX
MissingHoursOut = MAX(vw_missing_timesheet[ContractHours]) - MAX(vw_missing_timesheet[Hours_])
```

**Format Hint:**  
- The measure is formatted as a general number.

#### Measure: `Msr_ActiveContacts`

### Measure: Msr_ActiveContacts

**Purpose:**  
The `Msr_ActiveContacts` measure calculates the number of active contacts (employees) based on their contract dates within a specified date range.

**Formula:**  
```DAX
VAR _MaxDate =
    MAX ( DimDate[ShortDate])
VAR _MinDate =
    MIN ( DimDate[ShortDate] )
VAR _StartsBeforeMonthEnd =
    CALCULATETABLE ( VALUES ( vw_Timesheet[EmployeeID] ), DimDate[ShortDate] <= _MaxDate )
VAR _notEndAfterMonthEnd =
    CALCULATETABLE (
        VALUES ( vw_Timesheet[EmployeeID] ),
        DimDate[ShortDate] >= _MinDate
            || ISBLANK ( DimDate[ShortDate] ),
        USERELATIONSHIP ( DimDate[ShortDate], vw_Timesheet[ContractEndDate] )
    )
RETURN
    COUNTROWS ( INTERSECT ( _notEndAfterMonthEnd, _StartsBeforeMonthEnd ) )
```

This measure uses the maximum and minimum dates from the `DimDate` table to filter employee IDs from the `vw_Timesheet` table, ensuring that only those whose contracts are active within the specified date range are counted.

#### Measure: `Msr_Budget`

### Measure: Msr_Budget

**Purpose:**  
The `Msr_Budget` measure calculates the current budget value based on the selected week, dynamically retrieving the most recent available budget value if the current budget is not available.

**Formula:**  
```DAX
VAR CurrentWeek = SELECTEDVALUE(DimDate[WeekNumberOfYear])

-- Find the most recent available budget value dynamically
VAR PrevBudget = 
    CALCULATE(
        [Msr_SalesPriceBaseCurrency],  -- Use the measure directly
        FILTER(
            ALLSELECTED(DimDate),  
            DimDate[WeekNumberOfYear] < CurrentWeek
        )
    )

-- Return current measure if available; otherwise, use the previous budget value
RETURN
    IF(
        NOT(ISBLANK([Msr_SalesPriceBaseCurrency])),
        [Msr_SalesPriceBaseCurrency],  -- Use the measure directly
        PrevBudget
    )
```

**Format String:**  
""\ #,0.00;-""\ #,0.00;""\ #,0.00

#### Measure: `Msr_HoursPercentage`

### Measure: Msr_HoursPercentage

**Purpose:**  
The `Msr_HoursPercentage` measure calculates the percentage of hours worked by an employee relative to the total hours worked across selected categories, projects, and employees.

**Formula:**  
```DAX
VAR TotalValue = 
    CALCULATE(SUM(vw_Timesheet[Hours]), 
        ALLSELECTED(vw_Timesheet[GroupCat], vw_Timesheet[Project], vw_Timesheet[EmployeeName])
    )
RETURN 
    DIVIDE(SUM(vw_Timesheet[Hours]), TotalValue, 0)
```

**Format String:**  
0.00%;-0.00%;0.00%

#### Measure: `Msr_SalesPriceBaseCurrency`

### Measure: Msr_SalesPriceBaseCurrency

**Purpose:**  
The `Msr_SalesPriceBaseCurrency` measure calculates the total sales price in the base currency for each project and client by aggregating the selected sales price values from the `tbl_Project` table.

**Formula:**  
```DAX
SUMX(
    SUMMARIZE(
        vw_Timesheet, 
        vw_Timesheet[ProjectProfile], 
        vw_Timesheet[Client], 
        "MeasureValue", SELECTEDVALUE(tbl_Project[SalesPriceBaseCurrency])
    ), 
    [MeasureValue]
)
```

**Format:**  
- Currency format: `$#,0.###############;($#,0.###############);$#,0.###############`
- Culture: `en-US`

#### Measure: `PercentageCompleteness`

### Measure: PercentageCompleteness

**Purpose:**  
The `PercentageCompleteness` measure calculates the completeness percentage of missing hours compared to the expected contracted hours for a given period.

**Formula:**  
```DAX
DIVIDE(
    SUM(vw_missing_timesheet[MissingHours]) - [ExpectedContractHoursWeekly],
    [ExpectedContractHoursWeekly],
    0
)
```

**Format Hint:**  
- General Number

#### Measure: `Static Total Employees`

### DAX Measure: 'Static Total Employees'

**Purpose:**  
The 'Static Total Employees' measure calculates the total number of distinct employees whose contract status is currently valid, regardless of any filters applied to the `vw_Timesheet` table.

**Formula:**  
```DAX
CALCULATE(
    DISTINCTCOUNT(vw_Timesheet[EmployeeName]), 
    ALL(vw_Timesheet),
    vw_Timesheet[ContractStatusToday] = "Valid"
)
```

**Format:**  
- Format String: 0 (General Number)

#### Measure: `TotalActualHours`

### DAX Measure: TotalActualHours

**Purpose:**  
The `TotalActualHours` measure calculates the total number of hours recorded in the `vw_Timesheet` table.

**Formula:**  
```DAX
TotalActualHours = SUM(vw_Timesheet[Hours])
```

**Format Hint:**  
- This measure is formatted as a general number.

#### Measure: `TotalContractedHours`

### Measure: TotalContractedHours

**Purpose:**  
Calculates the total contracted hours for each employee by summing the maximum hours per week across all employees.

**Formula:**  
```DAX
SUMX(
    VALUES(vw_Timesheet[EmployeeName]),
    MAX(vw_Timesheet[HoursPerWeek])
)
```

**Format:**  
0 (General Number)

#### Measure: `TotalHoursDeltaComplete`

### DAX Measure: TotalHoursDeltaComplete

**Purpose:**  
The `TotalHoursDeltaComplete` measure calculates the ratio of actual hours worked to contracted hours, providing insight into the completion status of hours relative to what was contracted.

**Formula:**  
```DAX
TotalHoursDeltaComplete = 
    DIVIDE(
        [TotalActualHours],
        [TotalContractedHours],
        0
    )
```

**Format:**  
- Displayed as a percentage with two decimal places: `0.00%;-0.00%;0.00%`

#### Measure: `TotalHoursDeltaCompleteNr`

### DAX Measure: TotalHoursDeltaCompleteNr

**Purpose:**  
The measure `TotalHoursDeltaCompleteNr` calculates the difference between the total actual hours worked and the total contracted hours for employees. This measure helps in assessing whether the actual hours worked exceed or fall short of the contracted hours.

**Formula:**  
```DAX
[TotalActualHours] - [TotalContractedHours]
```

**Format Hint:**  
- General Number (isGeneralNumber: true)

#### Measure: `TotalHoursTracked`

### DAX Measure: TotalHoursTracked

**Purpose:**  
The `TotalHoursTracked` measure calculates the total hours tracked from the `vw_Timesheet` table. It ensures that if there are no hours recorded, the measure returns zero instead of a blank value.

**Formula:**  
```DAX
IF (
    ISBLANK(SUM(vw_Timesheet[Hours])),
    0,
    SUM(vw_Timesheet[Hours])
)
```

**Format Hint:**  
- General Number (isGeneralNumber: true)

#### Measure: `TotalHoursTrackedMissing`

### DAX Measure: TotalHoursTrackedMissing

**Purpose:**  
The measure `TotalHoursTrackedMissing` is designed to evaluate the total hours tracked in the `vw_Timesheet` table. It specifically checks if the sum of hours is blank and returns a specific message if it is.

**Formula:**  
```DAX
IF (
    ISBLANK(SUM(vw_Timesheet[Hours])),
    "Empty",
    SUM(vw_Timesheet[Hours])
)
```

**Format Hint:**  
This measure is formatted as a general number.

#### Measure: `UTILIZATION_New`

### DAX Measure: `UTILIZATION_New`

**Purpose:**  
Calculates the Billable Hour Ratio for active employees, providing insight into the utilization of hours worked on billable projects.

**Formula:**  
```DAX
VAR _TotalBillableHours = [UTI_TotalBillableHours]
VAR _TotalHours = [UTI_TOTALHOURS]

RETURN
    IF(NOT(ISBLANK([Msr_ActiveContacts])), 
        IF(NOT(ISBLANK([UTI_TOTALHOURS])), 
            IF(ISBLANK(DIVIDE(_TotalBillableHours, _TotalHours)), 0, DIVIDE(_TotalBillableHours, _TotalHours))
        )
    )
```

**Format String:**  
0.00%;-0.00%;0.00%

#### Measure: `UTI_TOTALHOURS`

### DAX Measure: UTI_TOTALHOURS

**Purpose:**  
The `UTI_TOTALHOURS` measure calculates the total hours worked by employees on projects that qualify as billable, specifically filtering for projects marked with `QualifyPrj = 1`.

**Formula:**  
```DAX
UTI_TOTALHOURS = CALCULATE(SUM(vw_Timesheet[Hours]), vw_Timesheet[QualifyPrj] = 1)
```

**Format Hint:**  
- General Number: `{"isGeneralNumber":true}`

#### Measure: `UTI_TotalBillableHours`

### DAX Measure: `UTI_TotalBillableHours`

**Purpose:**  
Calculates the total billable hours from the `vw_Timesheet` table, filtering for specific project criteria.

**Formula:**
```DAX
Var FilteredHours =
    Filter(
        vw_Timesheet,
        (
        vw_Timesheet[QualifyPrj] = 1 && 
        vw_Timesheet[BillablePrj] = 1) ||
            SEARCH("Customer Success Services", vw_Timesheet[Project], 1, 0) > 0
    )
RETURN 
    SUMX(FilteredHours, vw_Timesheet[Hours])
```

**Format:**  
- Format String: `0` (General Number)

#### Measure: `UniqueEmployeesPerUnit`

### DAX Measure: UniqueEmployeesPerUnit

**Purpose:**  
The `UniqueEmployeesPerUnit` measure calculates the number of unique employees per unit based on their weekly records in the `vw_missing_timesheet` table, specifically focusing on whether they have incomplete flags.

**Formula:**  
```DAX
SUMX(
    SUMMARIZE(
        vw_missing_timesheet,
        vw_missing_timesheet[Week_],
        vw_missing_timesheet[EmployeeName],
        vw_missing_timesheet[MAIN_UNIT],
        "IncompleteFlag", MAX(vw_missing_timesheet[IncompleteFlag])
    ),
    [IncompleteFlag]
)
```

**Format:**  
- Format String: 0 (General Number)

#### Measure: `trackedDiff`

### DAX Measure: `trackedDiff`

**Purpose:**  
The `trackedDiff` measure calculates the difference between the total hours tracked for an employee and the maximum hours per week recorded for that employee, excluding any filters on the `HoursPerWeek` column.

**Formula:**  
```DAX
[TotalHoursTracked] - 
    CALCULATE(
        MAXX(DISTINCT(vw_Timesheet[HoursPerWeek]), vw_Timesheet[HoursPerWeek]),
        ALLEXCEPT(vw_Timesheet, vw_Timesheet[EmployeeID])
    )
```

**Format Hint:**  
- General Number

#### Measure: `trackedDiff2`

### DAX Measure: `trackedDiff2`

**Purpose:**  
The `trackedDiff2` measure calculates the difference between the total hours tracked and the maximum hours per week for each employee, while removing filters on the `HoursPerWeek` column and preserving the context of the `EmployeeID`.

**Formula:**  
```DAX
[TotalHoursTracked] - 
    CALCULATE(
        MAXX(
            DISTINCT(vw_Timesheet[HoursPerWeek]), 
            vw_Timesheet[HoursPerWeek]
        ),
        REMOVEFILTERS(vw_Timesheet[HoursPerWeek]),
        ALLEXCEPT(vw_Timesheet, vw_Timesheet[EmployeeID])
    )
```

**Format Hint:**  
- General Number

### 2.3 Relationships

The following relationships were identified:

vw_Timesheet.Project
lkp_Project.Project
One-to-Many
Active
vw_Timesheet.Unit
lkp_Unit.'Organisatorische eenheid
One-to-Many
Active
vw_Timesheet.TimesheetCode
lkp_Code.Code
One-to-Many
Active
vw_Timesheet.TimesheetDate
DimDate.ShortDate
One-to-Many
Active
vw_missing_timesheet.ShortDate
DimDate.ShortDate
One-to-Many
Active
vw_missing_timesheet.TimesheetCode
lkp_Code.Code
One-to-Many
Active
vw_missing_timesheet.SubUnit
lkp_Unit.'Organisatorische eenheid
One-to-Many
Active
vw_missing_timesheet.Project
lkp_Project.Project
One-to-Many
Active
vw_Timesheet.ContractStartDate
DimDate.ShortDate
One-to-Many
Inactive
vw_Timesheet.ContractEndDate
DimDate.ShortDate
One-to-Many
Inactive
vw_Timesheet.ProjectCode
tbl_Project.Project
One-to-Many
Active

## 3. Report Pages & Visuals

### <a id='page-000_customer-analysis'>Page: 000_Customer Analysis</a>

#### Visual: `000_Customer Analysis`

# Customer Analysis Report

## Extracted Visual Details
* **Type:** N/A
* **Data Fields Used:** N/A
* **Visual-Level Filters:** None Defined

## Extracted Page/Report-Level Filters
None Found in Context

#### Visual: `00000_Unit`

# Customer Analysis - Unit Visual Documentation

## Visual Details
* **Type:** N/A
* **Data Fields Used:** N/A

## Visual-Level Filters
* None Defined

## Page/Report-Level Filters
* None Found in Context

#### Visual: `01000_TimeSpan`

# Customer Analysis - Time Span Visual Documentation

## Extracted Visual Details
* **Type:** N/A
* **Data Fields Used:** N/A
* **Visual-Level Filters:** None Defined

## Extracted Page/Report-Level Filters
None Found in Context

#### Visual: `02000_Year`

# Customer Analysis - Year Visual Documentation

## Extracted Visual Details
* **Type:** N/A
* **Data Fields Used:** N/A

## Visual-Level Filters
* None Defined

## Page/Report-Level Filters
* None Found in Context

#### Visual: `03000_Client`

# Visual Documentation for Client Analysis

## Visual Details
* **Type:** N/A
* **Data Fields Used:** N/A

## Filters
* No visual-level or page/report-level filters defined.

#### Visual: `04000_Company`

# Visual Documentation for Company Analysis

## Visual Details
- **Type:** N/A
- **Data Fields Used:** N/A

## Visual-Level Filters
- None Defined

## Page/Report-Level Filters
- None Found in Context

#### Visual: `05000_Employee`

# Visual Documentation: Employee Analysis

## Visual Details
- **Type:** N/A
- **Data Fields Used:** N/A

## Filters
- No filters defined at the visual, page, or report level.

#### Visual: `06000_pivotTable (8a02e)`

# Customer Analysis - Visual Documentation

## Visual: 06000_pivotTable (8a02e)

- **Type:** N/A
- **Data Fields Used:** N/A


#### Visual: `07000_Project Name`

# Customer Analysis - Project Name Visual Documentation

## Visual Details
* **Type:** N/A
* **Data Fields Used:** N/A

## Visual-Level Filters
* None Defined

## Page/Report-Level Filters
* None Found in Context

#### Visual: `08000_Sub-Own-Ext`

# Customer Analysis - Visual Documentation

## Visual: 08000_Sub-Own-Ext
- **Type:** N/A
- **Data Fields Used:** N/A

### Visual-Level Filters
- None Defined

### Page/Report-Level Filters
- None Found in Context

#### Visual: `09000_Project Type`

# Customer Analysis - Project Type Visual Documentation

## Visual Details
* **Type:** N/A
* **Data Fields Used:** N/A

## Visual-Level Filters
* None Defined

## Page/Report-Level Filters
* None Found in Context

#### Visual: `10000_Revenue%2FWeek`

# Customer Analysis - Revenue/Week Visual Documentation

## Visual Details
* **Type:** N/A
* **Data Fields Used:** N/A

## Visual-Level Filters
* None Defined

## Page/Report-Level Filters
* None Found in Context

#### Visual: `11000_pivotTable (48569)`

# Customer Analysis - Visual Documentation

## Visual: Pivot Table
* **Type:** N/A
* **Data Fields Used:** N/A

## Filters
* No visual-level or page/report-level filters defined.

#### Visual: `12000_SubUnit`

# Customer Analysis - SubUnit Visual Documentation

## Visual Details
- **Type:** N/A
- **Data Fields Used:** N/A

## Visual-Level Filters
- None Defined

## Page/Report-Level Filters
- None Found in Context

#### Visual: `13000_image (6f358)`

# Visual Documentation

## Visual: 13000_image (6f358)
* **Type:** N/A
* **Data Fields Used:** N/A
* **Visual-Level Filters:** None Defined

## Page/Report-Level Filters
None Found in Context

#### Visual: `14000_actionButton (88e87)`

# Visual Documentation

## Visual: 14000_actionButton
- **Type:** N/A
- **Data Fields Used:** N/A


### <a id='page-001_project-details'>Page: 001_Project Details</a>

#### Visual: `001_Project Details`

# Project Details Visual Documentation

**Extracted Visual Details:**
- **Type:** N/A
- **Data Fields Used:** N/A

**Extracted Page/Report-Level Filters:**
- None Found in Context

#### Visual: `00000_Pillar`

# Visual Documentation for 'Pillar'

## Extracted Visual Details
* **Type:** N/A
* **Data Fields Used:** N/A
* **Visual-Level Filters:** None Defined

## Extracted Page/Report-Level Filters
None Found in Context

#### Visual: `01000_TimeSpan`

# Visual Documentation for TimeSpan

**Visual Details:**
- **Type:** N/A
- **Data Fields Used:** N/A

**Page/Report-Level Filters:**
- None Found in Context

#### Visual: `02000_Year`

# Visual Documentation for '02000_Year'

## Extracted Visual Details
* **Type:** N/A
* **Data Fields Used:** N/A

## Extracted Page/Report-Level Filters
* None Found in Context

#### Visual: `03000_Client`

# Visual Documentation for Client Visual

**Visual Details:**
- **Type:** N/A
- **Data Fields Used:** N/A

**Page/Report-Level Filters:**
- None Found in Context

#### Visual: `04000_Company`

# Visual Documentation for '04000_Company'

- **Type:** N/A
- **Data Fields Used:** N/A
- **Visual-Level Filters:** None Defined

- **Page/Report-Level Filters:** None Found in Context

#### Visual: `05000_Status`

# Visual Documentation for Status Visual

**Visual Path:** C:/Users/Devoteam/Desktop/MY AI/2.0_MyLangAgent/Input Folder/Cust+Proj/Report/sections/001_Project Details/visualContainers/05000_Status

* **Type:** N/A
* **Data Fields Used:** N/A

#### Visual: `06000_Employee`

# Visual Documentation for Employee Visual

**Visual Details:**
- **Type:** N/A
- **Data Fields Used:** N/A

**Page/Report-Level Filters:**
- None Found in Context

#### Visual: `07000_pivotTable (08915)`

# Visual Documentation for Pivot Table

## Visual Details
* **Type:** N/A
* **Data Fields Used:** N/A

## Filters
* No filters defined at the visual, page, or report level.

#### Visual: `08000_Project Name`

# Project Name Visual Documentation

## Extracted Visual Details
* **Type:** N/A
* **Data Fields Used:** N/A

## Extracted Page/Report-Level Filters
* None Found in Context

#### Visual: `09000_Sub-Own-Ext`

# Visual Documentation

## Visual: 09000_Sub-Own-Ext

- **Type:** N/A
- **Data Fields Used:** N/A
- **Visual-Level Filters:** None Defined

## Page/Report-Level Filters

- None Found in Context

#### Visual: `10000_Project Type`

# Project Type Visual Documentation

**Extracted Visual Details:**
- **Type:** N/A
- **Data Fields Used:** N/A

**Extracted Page/Report-Level Filters:**
- None Found in Context

#### Visual: `11000_Actual vs Budget`

# Visual Documentation: Actual vs Budget

**Visual Details:**
- **Type:** N/A
- **Data Fields Used:** N/A

**Filters:**
- No visual-level or page/report-level filters defined.

#### Visual: `12000_image (3e3f0)`

# Visual Documentation

## Visual: 12000_image (3e3f0)
* **Type:** N/A
* **Data Fields Used:** N/A
* **Visual-Level Filters:** None Defined

## Page/Report-Level Filters
None Found in Context

#### Visual: `13000_Project Leader`

# Project Leader Visual Documentation

**Visual Details:**
- **Type:** N/A
- **Data Fields Used:** N/A

**Visual-Level Filters:**
- None Defined

**Page/Report-Level Filters:**
- None Found in Context

#### Visual: `14000_actionButton (f3f38)`

# Visual Documentation for Action Button

**Visual Details:**
- **Type:** N/A
- **Data Fields Used:** N/A
- **Visual-Level Filters:** None Defined

**Page/Report-Level Filters:** None Found in Context

