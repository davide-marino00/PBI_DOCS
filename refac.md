# Power BI Solution Documentation

Generated by Langchain Documentation Agent (V4.4)
Date: 2025-04-25 17:24:54

## Table of Contents

* [1. Overview](#1-overview)
* [2. Data Model](#2-data-model)
  * [2.1 Tables (incl. Columns & Measures)](#21-tables-columns-measures)
  * [2.2 Relationships](#22-relationships)

---

## <a name="1-overview"></a>1. Overview

This documentation provides a high-level overview of a reporting model designed to analyze timesheet data, focusing on key metrics such as hours worked, revenue generated, and average hourly rates. The primary purpose of this model is to facilitate the tracking and reporting of employee performance and project profitability over time, allowing stakeholders to make informed decisions based on comprehensive data analysis.

The model comprises several components, including various data sources such as `vw_Timesheet`, `DimDate`, and `tbl_Project`, which are utilized to derive essential metrics. Key items within the model include aggregated measures like total hours (`Sum(vw_Timesheet.Hours)`), total revenue (`Sum(vw_Timesheet.SalesAmount)`), and average hourly rates (`vw_Timesheet.MSR_AVG_HOURLY_RATE`). The report focuses on visualizing this data through pivot tables that categorize information by year, week, project, and employee, enabling users to drill down into specific details and trends. The complexity of the model is reflected in its ability to handle multiple dimensions and measures, providing a robust framework for performance analysis.

---

## <a name="2-data-model"></a>2. Data Model

### <a name="21-tables-columns-measures"></a>2.1 Tables (incl. Columns & Measures)

#### Table: `DimDate`

The `DimDate` table is a dimension table typically used in data warehousing to provide date-related attributes for analysis. It includes various columns that represent different aspects of dates, such as day names, week numbers, and year indicators. This table is likely used for time-based analysis in reports and dashboards.

##### Regular Columns
- `CalendarQuarter` (string)
- `CalendarYear` (int64)
- `DateKey` (int64)
- `DayName` (string)
- `DayNumberOfMonth` (int64)
- `DayNumberOfWeek` (int64)
- `DayNumberOfYear` (int64)
- `MonthName` (string)
- `MonthNumberOfYear` (int64)
- `ShortDate` (dateTime)
- `WeekNumberOfYear` (int64)

##### Calculated Columns
- **`CurrentYearFlag`**:
```dax

```

---

#### Table: `Hours_nd_Percentage`

The 'Hours_nd_Percentage' table is designed to hold data related to hours and their corresponding percentages. It includes columns for values, fields, and an order for sorting. The table does not summarize data by default and has hidden columns that support its structure.

##### Regular Columns
- `Hours_nd_Percentage` (Unknown type)
- `Hours_nd_Percentage Fields` (Unknown type)
- `Hours_nd_Percentage Order` (Unknown type)

##### Calculated Columns
- **`Hours_nd_Percentage`**:
```dax

```

---

#### Table: `lkp_Code`

The `lkp_Code` table is designed to serve as a lookup table, containing codes, qualification values, and sorting information. It is sourced from an Excel workbook and includes data transformation steps to ensure the data is clean and properly typed.

##### Regular Columns
- `Code` (string)
- `Qualify` (int64)
- `Sort` (string)

---

#### Table: `lkp_fltr_Employee`

The `lkp_fltr_Employee` table is designed to provide a lookup for employee information, specifically their IDs and names. The data is imported from an Excel workbook located on a SharePoint site, and it includes steps to clean and format the data before it is loaded into Power BI.

##### Regular Columns
- `EmployeeId` (string)
- `EmployeeName` (string)

---

#### Table: `lkp_Project`

The `lkp_Project` table is designed to provide a lookup for project-related data, including project names, qualification metrics, billing amounts, and associated groups. The data is imported from an Excel workbook hosted on SharePoint, and the table is structured to facilitate analysis in Power BI.

##### Regular Columns
- `Billing` (int64)
- `Group` (string)
- `Project` (string)
- `Qualify` (int64)

---

#### Table: `lkp_Unit`

The `lkp_Unit` table is designed to provide a lookup for organizational units, including details about billable departments and unit identifiers. The data is imported from an Excel workbook hosted on SharePoint, and it includes several columns with specific data types and summarization settings.

##### Regular Columns
- `BillableDep` (int64)
- `OWN-Sub-ExtT` (string)
- `Organisatorische eenheid` (string)
- `Unit` (string)

---

#### Table: `tbl_Project`

The `tbl_Project` table contains information related to various projects, including their identifiers, descriptions, financial details, and status. It is structured to facilitate reporting and analysis within Power BI, with specific formatting for currency and date fields.

##### Regular Columns
- `ActualDateCompleted` (dateTime)
- `Administration` (string)
- `Changed_on` (dateTime)
- `ClientName` (string)
- `ClientNumber` (string)
- `Created_on` (dateTime)
- `Currency` (string)
- `DateCreated` (dateTime)
- `DevoteamPillar` (string)
- `PlannedCompletionDate` (dateTime)
- `Project` (string)
- `ProjectDescription` (string)
- `ProjectGroup` (string)
- `ProjectGroupDescription` (string)
- `ProjectKey` (int64)
- `ProjectleaderId` (string)
- `SalesPriceBaseCurrency` (decimal)
- `Startdate` (dateTime)
- `Status` (string)
- `Statuscode` (string)
- `TotalContractSum` (decimal)

---

#### Table: `vw_missing_timesheet`

The `vw_missing_timesheet` table is designed to track missing timesheet entries for employees, capturing various metrics related to hours worked, contract details, and employee status. It includes measures to calculate counts of negative hours, expected contract hours, and completeness percentages, among others.

##### Regular Columns
- `ActualHours` (double)
- `Approved` (boolean)
- `ContractEndDate` (dateTime)
- `ContractHours` (int64)
- `ContractStartDate` (dateTime)
- `ContractStatusToday` (string)
- `EmployeeID` (string)
- `EmployeeName` (string)
- `Hours_` (double)
- `IngestDatetime` (dateTime)
- `ManagerID` (string)
- `ManagerName` (string)
- `MissingHours` (double)
- `Project` (string)
- `ProjectCode` (string)
- `Rejected` (boolean)
- `ReportReady` (boolean)
- `SalesAmount` (double)
- `SalesPrice` (double)
- `ShortDate` (dateTime)
- `SubUnit` (string)
- `TimesheetCode` (string)
- `TimesheetDescription` (string)
- `Week_` (int64)
- `Year_` (int64)

##### Calculated Columns
- **`BillableDep`**:
```dax

```

- **`CC_ActiveEmployees`**:
```dax

```

- **`IncompleteFlag`**:
```dax

```

- **`MAIN_UNIT`**:
```dax

```

- **`YearWeek`**:
```dax

```

##### Measures (defined in this table file)
- **`CountNegativeMissingHours`**:
```dax

```

- **`Count_Negative_Consultant`**:
```dax

```

- **`Dax_EmpCount`**:
```dax

```

- **`Dax_EmpCount_MissingTS`**:
```dax

```

- **`Dax_MissingHours`**:
```dax

```

- **`ExpectedContractHoursWeekly`**:
```dax

```

- **`MISSING%`**:
```dax

```

- **`MissingHoursOut`**:
```dax

```

- **`PercentageCompleteness`**:
```dax

```

- **`UniqueEmployeesPerUnit`**:
```dax

```

---

#### Table: `vw_Timesheet`

The `vw_Timesheet` table is designed to capture and analyze timesheet data, including hours worked, project details, employee information, and contract statuses. It includes various measures for calculating hours, contract statuses, and financial metrics related to projects and employees.

##### Regular Columns
- `Approved` (boolean)
- `Client` (string)
- `Code2` (string)
- `ContractEndDate` (dateTime)
- `ContractStartDate` (dateTime)
- `ContractStatusToday` (string)
- `ContractStatusTodayPBI` (string)
- `ContractTransferDate` (dateTime)
- `CostAmount` (double)
- `CostPrice` (double)
- `Currency` (string)
- `DebtorName` (string)
- `EmployeeID` (string)
- `EmployeeIDName` (string)
- `EmployeeKey` (int64)
- `EmployeeName` (string)
- `Employer` (string)
- `EmployerCode` (int64)
- `ExtraDetails` (string)
- `FinancialYear` (int64)
- `Hours` (double)
- `HoursType` (string)
- `HoursTypeCode` (string)
- `HoursperWeek` (int64)
- `IPMIDName` (string)
- `IPM_ManagerName` (string)
- `IngestDatetime` (dateTime)
- `InternalPMID` (string)
- `InternalPMKey` (int64)
- `JobTitle` (string)
- `Join_Key` (string)
- `ManagerID` (string)
- `ManagerIDName` (string)
- `ManagerKey` (int64)
- `ManagerName` (string)
- `OHWWorkBookings` (string)
- `Project` (string)
- `ProjectCode` (string)
- `ProjectProfile` (string)
- `ProjectProfileCode` (int64)
- `ProjectType` (string)
- `Rejected` (boolean)
- `ReportReady` (boolean)
- `ReportingEntity` (string)
- `SalesAmount` (double)
- `SalesPrice` (double)
- `Status` (string)
- `Taxed` (boolean)
- `Tier` (string)
- `TimesheetCode` (string)
- `TimesheetDate` (dateTime)
- `TimesheetDescription` (string)
- `Unit` (string)
- `UnitCode` (string)
- `WorkEmail` (string)
- `YearWeek` (string)
- `cc_Employer` (string)

##### Calculated Columns
- **`BillableDep`**:
```dax

```

- **`BillablePrj`**:
```dax

```

- **`Employee_WeeklyHours`**:
```dax

```

- **`GroupCat`**:
```dax

```

- **`MAIN_UNIT`**:
```dax

```

- **`MonthNumber`**:
```dax

```

- **`Own-Sub-ExtT`**:
```dax

```

- **`QualifyPrj`**:
```dax

```

- **`RReady_With_V_Z`**:
```dax

```

##### Measures (defined in this table file)
- **`ContractStatus2`**:
```dax

```

- **`ContractStatusMeasure`**:
```dax

```

- **`CurrentWeekCard`**:
```dax

```

- **`DISTINCT_COUNT_EMP`**:
```dax

```

- **`Dax_EmpCount_Approved`**:
```dax

```

- **`Dax_EmpCount_RReady`**:
```dax

```

- **`HoursDifference`**:
```dax

```

- **`MSR_%_Budget_Used`**:
```dax

```

- **`MSR_AVG_HOURLY_RATE`**:
```dax

```

- **`MSR_Cumulative Cost`**:
```dax

```

- **`MSR_Cumulative Sales`**:
```dax

```

- **`MSR_Cumulative_Revenue`**:
```dax

```

- **`MSR_PROJECT_%_REALIZATION`**:
```dax

```

- **`MSR_ProjectMargin`**:
```dax

```

- **`Msr_ActiveContacts`**:
```dax

```

- **`Msr_Budget`**:
```dax

```

- **`Msr_HoursPercentage`**:
```dax

```

- **`Msr_SalesPriceBaseCurrency`**:
```dax

```

- **`Static Total Employees`**:
```dax

```

- **`TotalActualHours`**:
```dax

```

- **`TotalContractedHours`**:
```dax

```

- **`TotalHoursDeltaComplete`**:
```dax

```

- **`TotalHoursDeltaCompleteNr`**:
```dax

```

- **`TotalHoursTracked`**:
```dax

```

- **`TotalHoursTrackedMissing`**:
```dax

```

- **`UTILIZATION_New`**:
```dax

```

- **`UTI_TOTALHOURS`**:
```dax

```

- **`UTI_TotalBillableHours`**:
```dax

```

- **`trackedDiff`**:
```dax

```

- **`trackedDiff2`**:
```dax

```

---

### <a name="22-relationships"></a>2.2 Relationships

The following relationships were identified based on explicit TMDL definitions:

* `vw_Timesheet`.[`TimesheetDate`] **->** `DimDate`.[`ShortDate`]
* `vw_Timesheet`.[`ContractStartDate`] **->** `DimDate`.[`ShortDate`] _(Inactive)_
* `vw_Timesheet`.[`ContractEndDate`] **->** `DimDate`.[`ShortDate`] _(Inactive)_
* `vw_Timesheet`.[`TimesheetCode`] **->** `lkp_Code`.[`Code`]
* `vw_Timesheet`.[`Project`] **->** `lkp_Project`.[`Project`]
* `vw_Timesheet`.[`Unit`] **->** `lkp_Unit`.[`Organisatorische eenheid`]
* `vw_Timesheet`.[`ProjectCode`] **->** `tbl_Project`.[`Project`] _(Filter: bothDirections)_
* `vw_missing_timesheet`.[`ShortDate`] **->** `DimDate`.[`ShortDate`]
* `vw_missing_timesheet`.[`TimesheetCode`] **->** `lkp_Code`.[`Code`]
* `vw_missing_timesheet`.[`Project`] **->** `lkp_Project`.[`Project`]
* `vw_missing_timesheet`.[`SubUnit`] **->** `lkp_Unit`.[`Organisatorische eenheid`]

