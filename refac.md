# Power BI Solution Documentation

Generated by Langchain Documentation Agent (V4.5)
Date: 2025-04-25 17:51:25

## Table of Contents

* [1. Overview](#1-overview)
* [2. Data Model](#2-data-model)
  * [2.1 Tables (incl. Columns & Measures)](#21-tables-columns-measures)
  * [2.2 Relationships](#22-relationships)

---

## <a name="1-overview"></a>1. Overview

The Power BI solution is designed to provide comprehensive insights into timesheet data, focusing on key metrics such as hours worked, revenue generated, and average hourly rates. It utilizes a variety of data sources, including a SQL database, to aggregate and analyze information from multiple tables, such as `vw_Timesheet`, `tbl_Project`, and `DimDate`. The solution features a pivot table visualization that allows users to explore data by different dimensions, including project, employee, and time periods, facilitating detailed reporting and analysis.

Key metrics displayed in the solution include total hours worked, total sales amount, and average hourly rates, which are calculated using DAX measures. The visual elements are designed to support interactive filtering and drilling down into specific data points, enhancing the user experience. The solution also incorporates various formatting options and grid properties to ensure clarity and usability, making it a powerful tool for project management and financial analysis within organizations.

---

## <a name="2-data-model"></a>2. Data Model

### <a name="21-tables-columns-measures"></a>2.1 Tables (incl. Columns & Measures)

#### Table: `DimDate`

The `DimDate` table is a dimension table typically used in data warehousing to provide date-related attributes for analysis. It includes various columns that represent different aspects of dates, such as day names, week numbers, and year indicators. This table is essential for time-based analysis in reporting and business intelligence.

##### Regular Columns
- `CalendarQuarter` (string)
- `CalendarYear` (int64)
- `DateKey` (int64)
- `DayName` (string)
- `DayNumberOfMonth` (int64)
- `DayNumberOfWeek` (int64)
- `DayNumberOfYear` (int64)
- `MonthName` (string)
- `MonthNumberOfYear` (int64)
- `ShortDate` (dateTime)
- `WeekNumberOfYear` (int64)

##### Calculated Columns
- **`CurrentYearFlag`**:
```dax

```

---

#### Table: `Hours_nd_Percentage`

The 'Hours_nd_Percentage' table is designed to summarize and analyze hours and percentage data related to timesheets. It includes columns for hours, percentage of hours, and an order for sorting the data. The table is structured to allow for calculations and aggregations based on the source data from a view named 'vw_Timesheet'.

##### Regular Columns
- `Hours_nd_Percentage` (Unknown type)
- `Hours_nd_Percentage Fields` (Unknown type)
- `Hours_nd_Percentage Order` (Unknown type)

##### Calculated Columns
- **`Hours_nd_Percentage`**:
```dax

```

---

#### Table: `lkp_Code`

The `lkp_Code` table is designed to serve as a lookup table, containing codes, qualification values, and sorting information. It is imported from an Excel workbook and includes data transformation steps to ensure the data is clean and properly formatted.

##### Regular Columns
- `Code` (string)
- `Qualify` (int64)
- `Sort` (string)

---

#### Table: `lkp_fltr_Employee`

The `lkp_fltr_Employee` table is designed to provide a lookup for employee information, specifically their IDs and names. The data is imported from an Excel workbook located on a SharePoint site, and it includes a process to clean and format the data before it is used in Power BI.

##### Regular Columns
- `EmployeeId` (string)
- `EmployeeName` (string)

---

#### Table: `lkp_Project`

The `lkp_Project` table is designed to provide a lookup for project-related data, including project names, qualification metrics, billing amounts, and associated groups. The data is imported from an Excel workbook and includes various transformations to ensure the data is clean and properly formatted.

##### Regular Columns
- `Billing` (int64)
- `Group` (string)
- `Project` (string)
- `Qualify` (int64)

---

#### Table: `lkp_Unit`

The `lkp_Unit` table is designed to provide a lookup for organizational units, including details about billable departments and other related attributes. The data is imported from an Excel workbook hosted on SharePoint, and it includes various columns that capture both textual and numerical information.

##### Regular Columns
- `BillableDep` (int64)
- `OWN-Sub-ExtT` (string)
- `Organisatorische eenheid` (string)
- `Unit` (string)

---

#### Table: `tbl_Project`

The `tbl_Project` table contains information related to various projects, including their identifiers, descriptions, statuses, financial details, and relevant dates. This table is structured to facilitate reporting and analysis of project-related data.

##### Regular Columns
- `ActualDateCompleted` (dateTime)
- `Administration` (string)
- `Changed_on` (dateTime)
- `ClientName` (string)
- `ClientNumber` (string)
- `Created_on` (dateTime)
- `Currency` (string)
- `DateCreated` (dateTime)
- `DevoteamPillar` (string)
- `PlannedCompletionDate` (dateTime)
- `Project` (string)
- `ProjectDescription` (string)
- `ProjectGroup` (string)
- `ProjectGroupDescription` (string)
- `ProjectKey` (int64)
- `ProjectleaderId` (string)
- `SalesPriceBaseCurrency` (decimal)
- `Startdate` (dateTime)
- `Status` (string)
- `Statuscode` (string)
- `TotalContractSum` (decimal)

---

#### Table: `vw_missing_timesheet`

The `vw_missing_timesheet` table is designed to track missing timesheet entries for employees, capturing various metrics related to hours worked, contract details, and employee status. It includes measures to analyze the completeness of timesheet submissions and identify employees with negative missing hours.

##### Regular Columns
- `ActualHours` (double): The actual hours worked by the employee.
- `Approved` (boolean): Indicates if the timesheet is approved.
- `BillableDep` (int64): Indicates if the department is billable, defaults to 1 if not found.
- `CC_ActiveEmployees` (int64): A flag indicating if the employee is active based on contract dates.
- `ContractEndDate` (dateTime): The end date of the employee's contract.
- `ContractHours` (int64): The total hours contracted for the employee.
- `ContractStartDate` (dateTime): The start date of the employee's contract.
- `ContractStatusToday` (string)
- `EmployeeID` (string)
- `EmployeeName` (string)
- `Hours_` (double): The total hours recorded for the employee.
- `IncompleteFlag` (int64): A flag indicating if there are missing hours.
- `IngestDatetime` (dateTime): The date and time when the data was ingested.
- `MAIN_UNIT` (string): The main unit associated with the employee, defaults to "Unknown" if not found.
- `ManagerID` (string)
- `ManagerName` (string)
- `MissingHours` (double): The total hours missing from the timesheet.
- `Project` (string)
- `ProjectCode` (string)
- `Rejected` (boolean): Indicates if the timesheet is rejected.
- `ReportReady` (boolean): Indicates if the report is ready.
- `SalesAmount` (double): The total sales amount associated with the employee's work.
- `SalesPrice` (double): The sales price associated with the employee's work.
- `ShortDate` (dateTime): Represents the date in a short format.
- `SubUnit` (string)
- `TimesheetCode` (string)
- `TimesheetDescription` (string)
- `Week_` (int64)
- `YearWeek` (string): A concatenation of the year and week number of the contract end date.
- `Year_` (int64)

##### Calculated Columns
- **`BillableDep`**:
```dax

```

- **`CC_ActiveEmployees`**:
```dax

```

- **`IncompleteFlag`**:
```dax

```

- **`MAIN_UNIT`**:
```dax

```

- **`YearWeek`**:
```dax

```

##### Measures (defined in this table file)
- **`CountNegativeMissingHours`**:
```dax

```

- **`Count_Negative_Consultant`**:
```dax

```

- **`Dax_EmpCount`**:
```dax

```

- **`Dax_EmpCount_MissingTS`**:
```dax

```

- **`Dax_MissingHours`**:
```dax

```

- **`ExpectedContractHoursWeekly`**:
```dax

```

- **`MISSING%`**:
```dax

```

- **`MissingHoursOut`**:
```dax

```

- **`PercentageCompleteness`**:
```dax

```

- **`UniqueEmployeesPerUnit`**:
```dax

```

---

#### Table: `vw_Timesheet`

The `vw_Timesheet` table is a view that aggregates timesheet data, including hours worked, project details, employee information, and contract statuses. It contains various measures and calculated columns to analyze employee utilization, billing, and project management metrics.

##### Regular Columns
- `Approved` (boolean)
- `Approved_With_V_Z` (Unknown type)
- `BillableDep` (Unknown type)
- `BillablePrj` (Unknown type)
- `Client` (string)
- `Code2` (string)
- `ContractEndDate` (dateTime)
- `ContractStartDate` (dateTime)
- `ContractStatusToday` (string)
- `ContractStatusTodayPBI` (string)
- `ContractTransferDate` (dateTime)
- `CostAmount` (double)
- `CostPrice` (double)
- `Currency` (string)
- `DebtorName` (string)
- `EmployeeID` (string)
- `EmployeeIDName` (string)
- `EmployeeKey` (int64)
- `EmployeeName` (string)
- `Employee_WeeklyHours` (Unknown type)
- `Employer` (string)
- `EmployerCode` (int64)
- `ExtraDetails` (string)
- `FinancialYear` (int64)
- `GroupCat` (Unknown type)
- `Hours` (double)
- `HoursType` (string)
- `HoursTypeCode` (string)
- `HoursperWeek` (int64)
- `IPMIDName` (string)
- `IPM_ManagerName` (string)
- `Index` (int64)
- `IngestDatetime` (dateTime)
- `InternalPMID` (string)
- `InternalPMKey` (int64)
- `IsContractActive` (Unknown type)
- `JobTitle` (string)
- `Join_Key` (string)
- `MAIN_UNIT` (Unknown type)
- `ManagerID` (string)
- `ManagerIDName` (string)
- `ManagerKey` (int64)
- `ManagerName` (string)
- `MonthNumber` (Unknown type)
- `NR_EMP_COLUMN` (Unknown type)
- `OHWWorkBookings` (string)
- `Own-Sub-ExtT` (Unknown type)
- `Project` (string)
- `ProjectCode` (string)
- `ProjectProfile` (string)
- `ProjectProfileCode` (int64)
- `ProjectType` (string)
- `QualifyPrj` (Unknown type)
- `RReady_With_V_Z` (Unknown type)
- `Rejected` (boolean)
- `ReportReady` (boolean)
- `ReportingEntity` (Unknown type)
- `SalesAmount` (double)
- `SalesPrice` (double)
- `Status` (string)
- `Taxed` (boolean)
- `Tier` (string)
- `TimesheetCode` (string)
- `TimesheetDate` (dateTime)
- `TimesheetDescription` (string)
- `Unit` (string)
- `UnitCode` (string)
- `WorkEmail` (string)
- `YearWeek` (string)
- `cc_Employer` (Unknown type)

##### Calculated Columns
- **`BillableDep`**:
```dax

```

- **`BillablePrj`**:
```dax

```

- **`GroupCat`**:
```dax

```

- **`IsContractActive`**:
```dax

```

- **`MAIN_UNIT`**:
```dax

```

- **`MonthNumber`**:
```dax

```

- **`QualifyPrj`**:
```dax

```

- **`ReportingEntity`**:
```dax

```

- **`cc_Employer`**:
```dax

```

##### Measures (defined in this table file)
- **`ContractStatus2`**:
```dax

```

- **`ContractStatusMeasure`**:
```dax

```

- **`CurrentWeekCard`**:
```dax

```

- **`DISTINCT_COUNT_EMP`**:
```dax

```

- **`Dax_EmpCount_Approved`**:
```dax

```

- **`Dax_EmpCount_RReady`**:
```dax

```

- **`HoursDifference`**:
```dax

```

- **`MSR_%_Budget_Used`**:
```dax

```

- **`MSR_AVG_HOURLY_RATE`**:
```dax

```

- **`MSR_Cumulative Cost`**:
```dax

```

- **`MSR_Cumulative Sales`**:
```dax

```

- **`MSR_Cumulative_Revenue`**:
```dax

```

- **`MSR_PROJECT_%_REALIZATION`**:
```dax

```

- **`MSR_ProjectMargin`**:
```dax

```

- **`Msr_ActiveContacts`**:
```dax

```

- **`Msr_Budget`**:
```dax

```

- **`Msr_HoursPercentage`**:
```dax

```

- **`Msr_SalesPriceBaseCurrency`**:
```dax

```

- **`Static Total Employees`**:
```dax

```

- **`TotalActualHours`**:
```dax

```

- **`TotalContractedHours`**:
```dax

```

- **`TotalHoursDeltaComplete`**:
```dax

```

- **`TotalHoursDeltaCompleteNr`**:
```dax

```

- **`TotalHoursTracked`**:
```dax

```

- **`TotalHoursTrackedMissing`**:
```dax

```

- **`UTILIZATION_New`**:
```dax

```

- **`UTI_TOTALHOURS`**:
```dax

```

- **`UTI_TotalBillableHours`**:
```dax

```

- **`trackedDiff`**:
```dax

```

- **`trackedDiff2`**:
```dax

```

---

### <a name="22-relationships"></a>2.2 Relationships

The following relationships were identified based on explicit TMDL definitions:

* `vw_Timesheet`.[`ProjectCode`] **->** `tbl_Project`.[`Project`] _(Inactive, Filter: bothDirections)_

