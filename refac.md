# Power BI Solution Documentation

Generated by Langchain Documentation Agent
Date: 2025-04-25 16:24:42

## Table of Contents

* [1. Overview](#1-overview)
* [2. Data Model](#2-data-model)
  * [2.1 Tables & Columns](#21-tables--columns)
  * [2.2 Measures](#22-measures)
  * [2.3 Relationships](#23-relationships)

---

## 1. Overview

This documentation provides a high-level overview of a data model designed for reporting and analysis within a business intelligence context, specifically utilizing Power BI. The primary purpose of this model is to aggregate and summarize key financial and operational metrics, such as sales amounts, hours worked, and employee activity, to facilitate informed decision-making and performance tracking.

The model comprises several components, including various data columns and measures that capture essential metrics. Key items include the summation of sales prices and amounts, active employee calculations, and various measures for project margins and realization percentages. The report focuses on visualizing these metrics through pivot tables, allowing users to analyze data across different dimensions such as time (calendar year and week), project details, and employee contributions. The model also incorporates complex calculations, such as cumulative sales and budget utilization, to provide deeper insights into financial performance and resource allocation.

---

## 2. Data Model

### 2.1 Tables & Columns

#### Table: `database`

Purpose not clear from context.

_(No regular columns identified for this table.)_

_(No calculated columns identified for this table.)_

---

#### Table: `DimDate`

The 'DimDate' table is likely designed to serve as a date dimension in a data model, providing various attributes related to dates such as day names, week numbers, month names, and year indicators. This table facilitates time-based analysis and reporting by allowing users to filter and group data based on different time periods.

##### Regular Columns

- `CalendarQuarter` (string): The quarter of the year (e.g., Q1, Q2).
- `CalendarYear` (int64): The numerical representation of the year.
- `CurrentYearFlag` (int64): A flag indicating if the year is the current year (1 for yes, 0 for no).
- `DateKey` (int64): A unique key representing each date.
- `DayName` (string): The name of the day (e.g., Monday, Tuesday).
- `DayNumberOfMonth` (int64): The numerical representation of the day in the month (1-31).
- `DayNumberOfWeek` (int64): The numerical representation of the day in the week (1-7).
- `DayNumberOfYear` (int64): The numerical representation of the day in the year (1-365).
- `MonthName` (string): The name of the month (e.g., January, February).
- `MonthNumberOfYear` (int64): The numerical representation of the month in the year (1-12).
- `ShortDate` (dateTime): The date in a long date format.
- `WeekNumberOfYear` (int64): The numerical representation of the week in the year.

##### Calculated Columns

- **`CurrentYearFlag`**
  ```dax
  dax
IF(YEAR(DimDate[ShortDate]) <= YEAR(TODAY()), 1, 0)
  ```


---

#### Table: `Hours_nd_Percentage`

The 'Hours_nd_Percentage' table likely serves to summarize and analyze hours worked and their corresponding percentages, as suggested by its name and the presence of columns related to actual hours and percentage calculations.

##### Regular Columns

- `Hours_nd_Percentage` (DataType not specified): Represents a value related to hours and percentages, sourced from [Value1].
- `Hours_nd_Percentage Fields` (DataType not specified): A field related to the categorization of hours and percentages, sourced from [Value2].
- `Hours_nd_Percentage Order` (DataType not specified): A numeric field used for sorting, sourced from [Value3].

_(No calculated columns identified for this table.)_

---

#### Table: `lkp_Code`

The table 'lkp_Code' appears to serve as a lookup table, likely providing a mapping of codes to their corresponding qualification values and sort orders. This is inferred from the presence of columns named 'Code', 'Qualify', and 'Sort', which suggest a structure for categorizing and organizing data based on specific codes.

##### Regular Columns

- `Code` (string): Represents a unique identifier or code.
- `Qualify` (int64): Represents a qualification value associated with the code, summarized by sum.
- `Sort` (string): Represents a sorting value or order for the codes.

_(No calculated columns identified for this table.)_

---

#### Table: `lkp_fltr_Employee`

The table 'lkp_fltr_Employee' appears to serve as a lookup table for employee information, specifically containing identifiers and names of employees. This is inferred from the column names 'EmployeeId' and 'EmployeeName', which suggest that the table is used to filter or reference employee data in reports or analyses.

_(No regular columns identified for this table.)_

_(No calculated columns identified for this table.)_

---

#### Table: `lkp_Project`

The `lkp_Project` table appears to serve as a lookup table for project-related data, containing information about projects, their qualification status, billing amounts, and associated groups. This is inferred from the column names and their data types, which suggest a focus on project management and financial tracking.

##### Regular Columns

- `Billing` (int64): Represents the billing amount associated with the project.
- `Group` (string): Represents the group associated with the project.
- `Project` (string): Represents the name or identifier of the project.
- `Qualify` (int64): Represents a qualification metric, likely used for categorizing or scoring projects.

_(No calculated columns identified for this table.)_

---

#### Table: `lkp_Unit`

The table 'lkp_Unit' appears to serve as a lookup table for organizational units, containing details such as the name of the organizational unit, a billable department identifier, and additional unit-related information. This is inferred from the column names and their data types.

##### Regular Columns

- `BillableDep` (int64): Represents a numeric identifier for the billable department, which can be summed.
- `OWN-Sub-ExtT` (string): Represents additional information related to the organizational unit.
- `Organisatorische eenheid` (string): Represents the name of the organizational unit.
- `Unit` (string): Represents the unit associated with the organizational structure.

_(No calculated columns identified for this table.)_

---

#### Table: `model`

Purpose not clear from context.

_(No regular columns identified for this table.)_

_(No calculated columns identified for this table.)_

---

#### Table: `tbl_Project`

The `tbl_Project` table appears to serve as a repository for project-related data, including details such as project identifiers, descriptions, statuses, financial information, and key dates. This suggests it is likely used for project management or reporting purposes within an organization.

##### Regular Columns

- `ActualDateCompleted` (dateTime): Date when the project was actually completed.
- `Administration` (string): Administrative details related to the project.
- `Changed_on` (dateTime): Timestamp for when the project record was last changed.
- `ClientName` (string): Name of the client associated with the project.
- `ClientNumber` (string): Identifier for the client associated with the project.
- `Created_on` (dateTime): Timestamp for when the project record was created.
- `Currency` (string): Currency used for financial transactions.
- `DateCreated` (dateTime): Date when the project was created.
- `DevoteamPillar` (string): Pillar or category under which the project falls.
- `PlannedCompletionDate` (dateTime): Date when the project is planned to be completed.
- `Project` (string): Name of the project.
- `ProjectDescription` (string): Description of the project.
- `ProjectGroup` (string): Group to which the project belongs.
- `ProjectGroupDescription` (string): Description of the project group.
- `ProjectKey` (int64): Unique identifier for each project.
- `ProjectleaderId` (string): Identifier for the project leader.
- `SalesPriceBaseCurrency` (decimal): Sales price in the base currency.
- `Startdate` (dateTime): Date when the project is scheduled to start.
- `Status` (string): Current status of the project.
- `Statuscode` (string): Code representing the status of the project.
- `TotalContractSum` (decimal): Total sum of the contract associated with the project.

_(No calculated columns identified for this table.)_

---

#### Table: `vw_missing_timesheet`

The `vw_missing_timesheet` table appears to serve the purpose of tracking and analyzing missing timesheet entries for employees, including details about their hours worked, contract status, and various flags indicating the completeness of their timesheets.

##### Regular Columns

- `ActualHours` (double): Represents the actual hours worked by the employee.
- `Approved` (boolean): Indicates whether the timesheet has been approved.
- `BillableDep` (calculated based on related unit): Indicates whether the department is billable.
- `CC_ActiveEmployees` (calculated as 1 or 0 based on contract dates): Indicates whether an employee is active based on their contract start and end dates.
- `ContractEndDate` (dateTime): Represents the end date of the employee's contract.
- `ContractHours` (int64): Represents the total hours defined in the employee's contract.
- `ContractStartDate` (dateTime): Represents the start date of the employee's contract.
- `ContractStatusToday` (string): Indicates the current status of the contract.
- `EmployeeID` (string): Represents the unique identifier for the employee.
- `EmployeeName` (string): Represents the name of the employee.
- `Hours_` (double): Represents the total hours worked as recorded in the timesheet.
- `Hours_` (double): Represents the total hours worked as recorded in the timesheet.
- `IncompleteFlag` (calculated as 1 or 0 based on missing hours): Indicates whether there are incomplete hours.
- `IngestDatetime` (dateTime): Represents the date and time when the data was ingested.
- `MAIN_UNIT` (calculated based on related unit): Represents the main unit associated with the employee.
- `ManagerID` (string): Represents the ID of the manager associated with the employee.
- `ManagerName` (string): Represents the name of the manager associated with the employee.
- `MissingHours` (double): Represents the hours that are missing from the timesheet.
- `Project` (string): Provides the name of the project associated with the timesheet.
- `ProjectCode` (string): Represents the code for the project associated with the timesheet.
- `Rejected` (boolean): Indicates whether the timesheet has been rejected.
- `ReportReady` (boolean): Indicates whether the report is ready.
- `SalesAmount` (double): Represents the total sales amount related to the timesheet entries.
- `SalesPrice` (double): Represents the sales price associated with the timesheet entries.
- `ShortDate` (dateTime): Represents a shortened date format for the timesheet entry.
- `SubUnit` (string): Represents the sub-unit associated with the employee.
- `TimesheetCode` (string): Represents the code associated with the timesheet.
- `TimesheetDescription` (string): Provides a description of the timesheet.
- `Week_` (int64): Represents the week number of the timesheet entry.
- `YearWeek` (calculated based on contract end date): Represents the year and week number of the contract end date.
- `Year_` (int64): Represents the year of the timesheet entry.

##### Calculated Columns

- **`BillableDep`**
  ```dax
  dax
IF(
    ISBLANK(RELATED(lkp_Unit[BillableDep])), 
    IF(RELATED(lkp_Unit[BillableDep]) <> 0, 1, 0)
  ```

- **`IncompleteFlag`**
  ```dax
  dax
  ```

- **`MAIN_UNIT`**
  ```dax
  dax
IF(
    ISBLANK(RELATED(lkp_Unit[Unit])), 
    RELATED(lkp_Unit[Unit])
  ```

- **`YearWeek`**
  ```dax
  dax
  ```


---

#### Table: `vw_Timesheet`

The `vw_Timesheet` table appears to serve the purpose of tracking timesheet data for employees, including hours worked, project details, and contract statuses. It includes various measures for calculating hours, billing, and employee statuses, suggesting its use in financial and resource management within an organization.

##### Regular Columns

- `Approved` (boolean): Indicates if the entry is approved.
- `Client` (string): Name of the client.
- `Code2` (string): Additional code.
- `ContractEndDate` (dateTime): End date of the contract.
- `ContractStartDate` (dateTime): Start date of the contract.
- `ContractTransferDate` (dateTime): Transfer date of the contract.
- `CostAmount` (double): Total cost amount.
- `CostPrice` (double): Cost price associated with the timesheet.
- `Currency` (string): Currency used.
- `DebtorName` (string): Name of the debtor.
- `EmployeeID` (string): Employee's ID.
- `EmployeeKey` (int64): Identifier for the employee.
- `EmployeeName` (string): Name of the employee.
- `Employer` (string): Name of the employer.
- `EmployerCode` (int64): Code for the employer.
- `ExtraDetails` (string): Additional details.
- `FinancialYear` (int64): Financial year associated with the timesheet.
- `Hours` (double): Total hours worked.
- `HoursType` (string): Type of hours worked.
- `HoursTypeCode` (string): Code for the type of hours.
- `HoursperWeek` (int64): Hours worked per week.
- `InternalPMID` (string): Internal project manager's ID.
- `InternalPMKey` (int64): Identifier for the internal project manager.
- `JobTitle` (string): Job title of the employee.
- `ManagerID` (string): Manager's ID.
- `ManagerKey` (int64): Identifier for the manager.
- `OHWWorkBookings` (string): Work bookings related to OHW.
- `Project` (string): Name of the project.
- `ProjectCode` (string): Code for the project.
- `ProjectProfile` (string): Name of the project profile.
- `ProjectProfileCode` (int64): Code for the project profile.
- `ProjectType` (string): Type of the project.
- `Rejected` (boolean): Indicates if the entry is rejected.
- `ReportReady` (boolean): Indicates if the report is ready.
- `SalesAmount` (double): Total sales amount.
- `SalesPrice` (double): Sales price associated with the timesheet.
- `Status` (string): Status of the timesheet entry.
- `Taxed` (boolean): Indicates if the entry is taxed.
- `Tier` (string): Tier classification.
- `TimesheetCode` (string): Code for the timesheet.
- `TimesheetDate` (dateTime): Date of the timesheet entry.
- `TimesheetDescription` (string): Description of the timesheet.
- `Unit` (string): Name of the unit.
- `UnitCode` (string): Code for the unit.
- `WorkEmail` (string): Work email of the employee.

##### Calculated Columns

- **`BillableDep`**
  ```dax
  dax
IF(
    ISBLANK(RELATED(lkp_Unit[BillableDep])), 
    IF(RELATED(lkp_Unit[BillableDep]) <> 0, 1, 0)
  ```

- **`BillablePrj`**
  ```dax
  dax
IF(
    vw_Timesheet[ProjectProfileCode] = 81 ||
  ```

- **`GroupCat`**
  ```dax
  dax
IF(
    IF(
        vw_Timesheet[BillablePrj] = 1,
  ```

- **`IsContractActive`**
  ```dax
  dax
IF(
  ```

- **`MAIN_UNIT`**
  ```dax
  dax
IF(
    ISBLANK(RELATED(lkp_Unit[Unit])), 
    RELATED(lkp_Unit[Unit])
  ```

- **`MonthNumber`**
  ```dax
  dax
  ```

- **`QualifyPrj`**
  ```dax
  dax
IF(
    ISBLANK(RELATED(lkp_Project[Qualify])), 
    RELATED(lkp_Project[Qualify])
  ```


---

### 2.2 Measures

#### Measure: `ContractStatus2`

### DAX Measure: `ContractStatus2`

**Purpose:**  
The `ContractStatus2` measure evaluates the contract status of employees based on their activity and the difference in hours worked. It returns the hours difference for active contracts or indicates that the contract is "Not Active."

**Formula:**  
```DAX
IF(
    [ContractStatusMeasure] = "Active",
    [HoursDifference],
    "Not Active"
)
```

**Context:**  
- The measure relies on the `ContractStatusMeasure`, which determines if a contract is "Active" based on the contract end date.
- It also uses the `HoursDifference` measure, which calculates the difference between total hours worked and the maximum hours per week.

**Output:**  
- Returns the value of `HoursDifference` if the contract is active.
- Returns the string "Not Active" if the contract is not active.

#### Measure: `ContractStatusMeasure`

### DAX Measure: `ContractStatusMeasure`

**Purpose:**  
The `ContractStatusMeasure` is designed to determine the current status of a contract based on its end date. It categorizes contracts as either "Active" or "Not Active" depending on whether the contract has ended or is still valid.

**Formula:**  
```DAX
IF(
    ISBLANK(MAX('vw_Timesheet'[ContractEndDate])) || MAX('vw_Timesheet'[ContractEndDate]) > TODAY(),
    "Active",
    "Not Active"
)
```

**Explanation:**  
- The measure checks the maximum `ContractEndDate` from the `vw_Timesheet` table.
- If the `ContractEndDate` is blank or greater than today's date, it returns "Active".
- Otherwise, it returns "Not Active".

#### Measure: `Count_Negative_Consultant`

### DAX Measure: Count_Negative_Consultant

**Purpose:**  
The `Count_Negative_Consultant` measure calculates the number of distinct consultants (employees) who have reported negative missing hours in the `vw_missing_timesheet` table. This measure is useful for identifying consultants with discrepancies in their reported hours.

**Formula:**  
```DAX
Count_Negative_Consultant = 
CALCULATE(
    DISTINCTCOUNT('vw_missing_timesheet'[EmployeeName]),
    'vw_missing_timesheet'[MissingHours] < 0
)
```

**Format:**  
- **Format String:** 0 (integer format)

This measure leverages the `CALCULATE` function to modify the filter context, counting only those employees whose `MissingHours` are less than zero. The use of `DISTINCTCOUNT` ensures that each consultant is counted only once, regardless of how many times they appear with negative hours.

#### Measure: `CountNegativeMissingHours`

### Measure: CountNegativeMissingHours

**Purpose:**  
The `CountNegativeMissingHours` measure calculates the distinct count of employees who have reported negative missing hours in the `vw_missing_timesheet` table. This measure is useful for identifying employees with discrepancies in their reported hours, specifically those who have negative values for missing hours.

**Formula:**  
```DAX
CountNegativeMissingHours = 
CALCULATE(
    DISTINCTCOUNT('vw_missing_timesheet'[EmployeeID]),
    'vw_missing_timesheet'[MissingHours] < 0
)
```

**Format String:**  
0 (integer format)

#### Measure: `CurrentWeekCard`

### DAX Measure: CurrentWeekCard

**Purpose:**  
The `CurrentWeekCard` measure is designed to return the current week number of the year based on the current date. This can be useful for reporting and analysis that requires tracking or displaying data by week.

**Formula:**  
```DAX
CurrentWeekCard = WEEKNUM(TODAY())
```

**Format:**  
- Format String: 0

This measure utilizes the `WEEKNUM` function, which calculates the week number from the date returned by `TODAY()`, effectively providing the week number for the current date.

#### Measure: `Dax_EmpCount`

### DAX Measure: `Dax_EmpCount`

**Purpose:**  
The `Dax_EmpCount` measure calculates the distinct count of employees from the `vw_missing_timesheet` table. This measure is used to assess the total number of unique employees recorded in the dataset.

**Formula:**  
```DAX
Dax_EmpCount = 
    CALCULATE(
        DISTINCTCOUNT(vw_missing_timesheet[EmployeeName])
    )
```

**Format:**  
- The measure is formatted as a general number (`formatString: 0`).

This measure is essential for reporting and analysis related to employee attendance and timesheet management, providing insights into workforce participation.

#### Measure: `Dax_EmpCount_Approved`

### DAX Measure: `Dax_EmpCount_Approved`

**Purpose:**  
The `Dax_EmpCount_Approved` measure calculates the distinct count of employees from the `vw_Timesheet` table who have not been marked as approved. This measure is useful for identifying the number of employees whose timesheets require approval.

**Formula:**  
```DAX
Dax_EmpCount_Approved = 
CALCULATE(
    DISTINCTCOUNT(vw_Timesheet[EmployeeName]),
    vw_Timesheet[Approved] = FALSE()
)
```

**Format:**  
- Format String: `0` (displays as a whole number)

#### Measure: `Dax_EmpCount_MissingTS`

### DAX Measure: `Dax_EmpCount_MissingTS`

**Purpose:**  
The `Dax_EmpCount_MissingTS` measure calculates the count of active employees who have missing timesheet hours, specifically those whose total hours are less than their contracted hours.

**Formula:**
```DAX
VAR ActiveEmployees = 
    FILTER(
        SUMMARIZE(
            vw_missing_timesheet,
            vw_missing_timesheet[EmployeeName],
            vw_missing_timesheet[Year_],
            vw_missing_timesheet[Week_],
            lkp_Unit[Unit],
            vw_missing_timesheet[SubUnit],
            "MissingHours", SUM(vw_missing_timesheet[Hours_]) - MAX(vw_missing_timesheet[ContractHours]),
            "MinActiveEmp", MIN(vw_missing_timesheet[CC_ActiveEmployees])
        ),
        [MinActiveEmp] = 1 && [MissingHours] < 0
    )
RETURN COUNTROWS(ActiveEmployees)
```

**Details:**
- **Input Tables:** Utilizes the `vw_missing_timesheet` view.
- **Key Variables:**
  - `MissingHours`: Difference between total hours worked and contracted hours.
  - `MinActiveEmp`: Minimum active employee flag.
- **Conditions:** Filters for employees with:
  - `MinActiveEmp` equal to 1 (indicating they are active).
  - `MissingHours` less than 0 (indicating they have not met their contracted hours).
- **Output:** Returns the count of rows that meet the criteria, representing the number of active employees with missing timesheet hours. 

**Format:** General number (0).

#### Measure: `Dax_EmpCount_RReady`

### DAX Measure: `Dax_EmpCount_RReady`

**Purpose:**  
The `Dax_EmpCount_RReady` measure calculates the distinct count of employees whose reports are not marked as ready. This measure is useful for tracking the number of employees who have not yet completed their reporting obligations.

**Formula:**  
```DAX
Dax_EmpCount_RReady = 
CALCULATE(
    DISTINCTCOUNT(vw_Timesheet[EmployeeName]),
    vw_Timesheet[ReportReady] = FALSE()
)
```

**Format String:**  
0

This measure leverages the `CALCULATE` function to modify the filter context, counting only those employees in the `vw_Timesheet` table where the `ReportReady` column is set to FALSE.

#### Measure: `Dax_MissingHours`

### DAX Measure: `Dax_MissingHours`

**Purpose:**  
The `Dax_MissingHours` measure calculates the total number of missing hours for active employees who have reported negative missing hours in a given context. It identifies employees with insufficient hours logged compared to their contracted hours.

**Formula:**
```DAX
VAR ActiveEmployees = 
    FILTER(
        SUMMARIZE(
            vw_missing_timesheet,
            vw_missing_timesheet[EmployeeName],
            vw_missing_timesheet[Year_],
            vw_missing_timesheet[Week_],
            lkp_Unit[Unit],
            vw_missing_timesheet[SubUnit],
            "MissingHours", SUM(vw_missing_timesheet[Hours_]) - MAX(vw_missing_timesheet[ContractHours]),
            "MinActiveEmp", MIN(vw_missing_timesheet[CC_ActiveEmployees])
        ),
        [MinActiveEmp] = 1 && [MissingHours] < 0
    )

RETURN 
    SUMX(ActiveEmployees, [MissingHours])
```

**Contextual Notes:**
- The measure uses the `vw_missing_timesheet` table to summarize employee data by name, year, week, unit, and subunit.
- It filters for employees who are active (`MinActiveEmp = 1`) and have negative missing hours (`MissingHours < 0`).
- The final output is the sum of missing hours for the filtered active employees. 

**Format:**  
The measure is formatted as a general number.

#### Measure: `DISTINCT_COUNT_EMP`

### DAX Measure: `DISTINCT_COUNT_EMP`

**Purpose:**  
The `DISTINCT_COUNT_EMP` measure calculates the total number of unique employees based on their names from the `vw_Timesheet` table. This measure is useful for reporting and analysis where understanding the distinct count of employees is necessary, such as in workforce analytics or project management.

**Formula:**  
```DAX
DISTINCT_COUNT_EMP = DISTINCTCOUNT(vw_Timesheet[EmployeeName])
```

**Format:**  
- The result is formatted as a whole number (0). 

This measure provides a straightforward count of distinct employee names, which can be utilized in various reports and dashboards to assess employee engagement, project participation, or resource allocation.

#### Measure: `ExpectedContractHoursWeekly`

### DAX Measure: ExpectedContractHoursWeekly

**Purpose:**  
The `ExpectedContractHoursWeekly` measure calculates the total expected contracted hours for each employee on a weekly basis, based on the maximum contract hours recorded in the `vw_missing_timesheet` table.

**Formula:**  
```DAX
ExpectedContractHoursWeekly = 
SUMX(
    SUMMARIZE(
        vw_missing_timesheet,
        vw_missing_timesheet[Week_],
        vw_missing_timesheet[EmployeeID],
        "ContractHours", MAX(vw_missing_timesheet[ContractHours])
    ),
    [ContractHours]
)
```

**Explanation:**  
- The measure uses `SUMX` to iterate over a summarized table created by `SUMMARIZE`.
- The summarized table groups data by `Week_` and `EmployeeID`, calculating the maximum `ContractHours` for each combination.
- Finally, it sums the calculated `ContractHours` to provide the total expected contracted hours for the week across all employees. 

**Annotation:**  
- `PBI_FormatHint = {"isGeneralNumber":true}` indicates that the output is formatted as a general number.

#### Measure: `HoursDifference`

### DAX Measure: `HoursDifference`

**Purpose:**  
The `HoursDifference` measure calculates the difference between the total hours recorded in the `vw_Timesheet` table and the maximum contracted hours per week for employees. This measure helps assess whether employees are exceeding or falling short of their contracted hours.

**Formula:**  
```DAX
HoursDifference = 
    SUM('vw_Timesheet'[Hours]) - MAX('vw_Timesheet'[HoursperWeek])
```

**Contextual Use:**  
This measure is utilized in conjunction with other measures, such as `ContractStatusMeasure` and `ContractStatus2`, to determine the hours difference specifically for active contracts. If an employee's contract is active, the `HoursDifference` value is returned; otherwise, it indicates "Not Active". 

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `MISSING%`

### DAX Measure: MISSING%

**Purpose:**  
The `MISSING%` measure calculates the percentage of employees who are missing timesheet entries compared to the total distinct count of employees. This measure helps in assessing the completeness of timesheet submissions.

**Formula:**  
```DAX
MISSING% = DIVIDE([Dax_EmpCount] - [Dax_EmpCount_MissingTS], [Dax_EmpCount]) * 100
```

**Components:**
- **[Dax_EmpCount]**: Total distinct count of employees from the `vw_missing_timesheet` table.
- **[Dax_EmpCount_MissingTS]**: Count of employees with missing timesheet entries, calculated by filtering the `vw_missing_timesheet` for specific conditions.

**Format:**  
The result is formatted as a percentage.

#### Measure: `MissingHoursOut`

### DAX Measure: MissingHoursOut

**Purpose:**  
The `MissingHoursOut` measure calculates the difference between the maximum contracted hours and the maximum hours worked for employees in the `vw_missing_timesheet` table. This measure helps identify the total missing hours for employees based on their contractual obligations versus actual hours logged.

**Formula:**  
```DAX
MissingHoursOut = MAX(vw_missing_timesheet[ContractHours]) - MAX(vw_missing_timesheet[Hours_])
```

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `MSR_%_Budget_Used`

### DAX Measure: MSR_%_Budget_Used

**Purpose:**  
The measure `MSR_%_Budget_Used` calculates the percentage of the budget that has been utilized based on the total sales amount recorded in the timesheet compared to the total budget allocated for the project.

**Formula:**  
```DAX
DIVIDE(SUM(vw_Timesheet[SalesAmount]), SUM('tbl_Project'[SalesPriceBaseCurrency]), 0)
```

**Format:**  
- Displayed as a percentage with two decimal places: `0.00%;-0.00%;0.00%` 

This measure provides insights into budget utilization, helping stakeholders assess financial performance against planned budgets.

#### Measure: `Msr_ActiveContacts`

### DAX Measure: Msr_ActiveContacts

**Purpose:**  
The `Msr_ActiveContacts` measure calculates the number of active contacts (employees) based on their contract dates relative to a selected date range. It identifies employees whose contracts are active within the specified date range.

**Formula:**
```DAX
VAR _MaxDate =
    MAX(DimDate[ShortDate])
VAR _MinDate =
    MIN(DimDate[ShortDate])
VAR _StartsBeforeMonthEnd =
    CALCULATETABLE(VALUES(vw_Timesheet[EmployeeID]), DimDate[ShortDate] <= _MaxDate)
VAR _notEndAfterMonthEnd =
    CALCULATETABLE(
        VALUES(vw_Timesheet[EmployeeID]),
        DimDate[ShortDate] >= _MinDate || ISBLANK(DimDate[ShortDate]),
        USERELATIONSHIP(DimDate[ShortDate], vw_Timesheet[ContractEndDate])
    )
RETURN
    COUNTROWS(INTERSECT(_notEndAfterMonthEnd, _StartsBeforeMonthEnd))
```

**Explanation of Components:**
- `_MaxDate`: Captures the maximum date from the `DimDate` table.
- `_MinDate`: Captures the minimum date from the `DimDate` table.
- `_StartsBeforeMonthEnd`: Retrieves unique employee IDs whose start dates are on or before the maximum date.
- `_notEndAfterMonthEnd`: Retrieves unique employee IDs whose end dates are on or after the minimum date or are blank, using a user-defined relationship to the `ContractEndDate`.
- The final result counts the rows in the intersection of the two sets, yielding the number of active contacts.

#### Measure: `MSR_AVG_HOURLY_RATE`

### DAX Measure: MSR_AVG_HOURLY_RATE

**Purpose:**  
The measure `MSR_AVG_HOURLY_RATE` calculates the average hourly rate based on the total sales amount and total hours worked. This measure is useful for assessing the revenue generated per hour of work, providing insights into profitability and efficiency.

**Formula:**  
```DAX
MSR_AVG_HOURLY_RATE = SUM(vw_Timesheet[SalesAmount]) / SUM(vw_Timesheet[Hours])
```

**Contextual Notes:**  
- The measure utilizes the `SalesAmount` and `Hours` columns from the `vw_Timesheet` table.
- It is formatted as a general number, allowing for straightforward interpretation of the average hourly rate.

#### Measure: `Msr_Budget`

### DAX Measure: Msr_Budget

**Purpose:**  
The `Msr_Budget` measure calculates the current budget value based on the selected week in the context of a Power BI report. If the current budget value is not available, it retrieves the most recent available budget value from previous weeks.

**Formula:**
```DAX
VAR CurrentWeek = SELECTEDVALUE(DimDate[WeekNumberOfYear])

-- Find the most recent available budget value dynamically
VAR PrevBudget = 
    CALCULATE(
        [Msr_SalesPriceBaseCurrency],  -- Use the measure directly
        FILTER(
            ALLSELECTED(DimDate),  
            DimDate[WeekNumberOfYear] < CurrentWeek
        )
    )

-- Return current measure if available; otherwise, use the previous budget value
RETURN
    IF(
        NOT(ISBLANK([Msr_SalesPriceBaseCurrency])),
        [Msr_SalesPriceBaseCurrency],  -- Use the measure directly
        PrevBudget
    )
```

**Format String:**  
"€"\ #,0.00;-"€"\ #,0.00;"€"\ #,0.00

This measure is designed to provide a dynamic view of the budget, ensuring that users can see the most relevant budget information based on their current selection in the report.

#### Measure: `MSR_Cumulative Cost`

### DAX Measure: MSR_Cumulative Cost

**Purpose:**  
The `MSR_Cumulative Cost` measure calculates the cumulative total of costs incurred up to the selected month in a visual context. This measure is useful for tracking how costs accumulate over time, allowing for better financial analysis and project management.

**Formula:**
```DAX
VAR SelectedMonth = MAX('DimDate'[MonthNumberOfYear])  -- Get the selected month in the visual
RETURN 
CALCULATE(
    SUM(vw_Timesheet[CostAmount]),
    FILTER(
        ALLSELECTED('DimDate'),  
        'DimDate'[MonthNumberOfYear] <= SelectedMonth  -- Include all months up to the current one
    )
)
```

**Annotations:**  
- `PBI_FormatHint`: {"isGeneralNumber":true}

#### Measure: `MSR_Cumulative Sales`

### DAX Measure: MSR_Cumulative Sales

**Purpose:**  
The `MSR_Cumulative Sales` measure calculates the cumulative sales amount up to the selected month in a Power BI visual. This allows users to analyze sales performance over time, providing insights into trends and growth.

**Formula:**
```DAX
VAR SelectedMonth = MAX('DimDate'[MonthNumberOfYear])  -- Get the selected month in the visual
RETURN 
CALCULATE(
    SUM(vw_Timesheet[SalesAmount]),
    FILTER(
        ALLSELECTED('DimDate'),  
        'DimDate'[MonthNumberOfYear] <= SelectedMonth  -- Include all months up to the current one
    )
)
```

**Key Components:**
- **SelectedMonth:** Captures the maximum month number from the 'DimDate' table based on the current context.
- **CALCULATE:** Modifies the filter context to sum the `SalesAmount` from the `vw_Timesheet` table.
- **FILTER:** Ensures that only months up to and including the selected month are considered in the cumulative total.

**Format Hint:**  
The measure is formatted as a general number, allowing for straightforward numerical representation in reports.

#### Measure: `MSR_Cumulative_Revenue`

### DAX Measure: MSR_Cumulative_Revenue

**Purpose:**  
The `MSR_Cumulative_Revenue` measure calculates the cumulative revenue from sales over time, allowing for analysis of revenue trends up to the current date in the selected context.

**Formula:**  
```DAX
MSR_Cumulative_Revenue =
CALCULATE(
    SUM(vw_Timesheet[SalesAmount]),
    FILTER(
        ALLSELECTED(DimDate[ShortDate]),
        DimDate[ShortDate] <= MAX(DimDate[ShortDate])
    )
)
```

**Explanation:**  
- **CALCULATE:** This function modifies the filter context to compute the sum of `SalesAmount`.
- **SUM(vw_Timesheet[SalesAmount]):** Sums the sales amounts from the `vw_Timesheet` table.
- **FILTER:** This function creates a table that includes all dates up to the maximum date in the current context.
- **ALLSELECTED(DimDate[ShortDate]):** Removes filters from the `ShortDate` column while retaining other filters in the report, allowing for cumulative calculations across selected dates.
- **DimDate[ShortDate] <= MAX(DimDate[ShortDate]):** Ensures that only dates up to the current maximum date are included in the calculation.

**Format Hint:**  
The measure is formatted as a general number.

#### Measure: `Msr_HoursPercentage`

### DAX Measure: Msr_HoursPercentage

**Purpose:**  
The `Msr_HoursPercentage` measure calculates the percentage of actual hours worked by employees relative to the total hours worked across selected categories, projects, and employees. This measure helps in understanding the contribution of specific hours to the overall workload.

**Formula:**  
```DAX
VAR TotalValue = 
    CALCULATE(SUM(vw_Timesheet[Hours]), 
        ALLSELECTED(vw_Timesheet[GroupCat], vw_Timesheet[Project], vw_Timesheet[EmployeeName])
    )
RETURN 
    DIVIDE(SUM(vw_Timesheet[Hours]), TotalValue, 0)
```

**Format:**  
- Displayed as a percentage with two decimal places (0.00%;-0.00%;0.00%).

#### Measure: `MSR_PROJECT_%_REALIZATION`

### DAX Measure: MSR_PROJECT_%_REALIZATION

**Purpose:**  
The measure `MSR_PROJECT_%_REALIZATION` calculates the percentage of sales amount realized against the total sales price for a project. This metric helps assess the financial performance of a project by comparing actual revenue generated to the expected revenue.

**Formula:**  
```DAX
IF(
    SUM(tbl_Project[SalesPriceBaseCurrency]) <> 0, 
    SUM(vw_Timesheet[SalesAmount]) / SUM(tbl_Project[SalesPriceBaseCurrency])
)
```

**Format:**  
- Displayed as a percentage with a format string of `0.00%;-0.00%;0.00%`. 

This measure is crucial for project management and financial analysis, providing insights into revenue realization efficiency.

#### Measure: `MSR_ProjectMargin`

### DAX Measure: MSR_ProjectMargin

**Purpose:**  
The `MSR_ProjectMargin` measure calculates the profit margin for projects by determining the difference between total sales revenue and total costs associated with the project.

**Formula:**  
```DAX
MSR_ProjectMargin = SUM(vw_Timesheet[SalesAmount]) - SUM(vw_Timesheet[CostAmount])
```

**Context:**  
- **SalesAmount:** Represents the total revenue generated from the project.
- **CostAmount:** Represents the total costs incurred for the project.

This measure is essential for assessing the financial performance of projects, allowing stakeholders to understand profitability at a glance. The result is formatted as a general number.

#### Measure: `Msr_SalesPriceBaseCurrency`

### DAX Measure: Msr_SalesPriceBaseCurrency

**Purpose:**  
The measure `Msr_SalesPriceBaseCurrency` calculates the total sales price in the base currency for each project and client combination from the `vw_Timesheet` table. It is used to aggregate the sales price values based on the selected project profiles and clients.

**Formula:**  
```DAX
SUMX(
    SUMMARIZE(
        vw_Timesheet, 
        vw_Timesheet[ProjectProfile], 
        vw_Timesheet[Client], 
        "MeasureValue", SELECTEDVALUE(tbl_Project[SalesPriceBaseCurrency])
    ), 
    [MeasureValue]
)
```

**Explanation:**
- `SUMMARIZE` creates a table that groups the `vw_Timesheet` data by `ProjectProfile` and `Client`, while also retrieving the corresponding `SalesPriceBaseCurrency` from the `tbl_Project` table.
- `SELECTEDVALUE` is used to get the sales price for the current context.
- `SUMX` iterates over the summarized table and sums the `MeasureValue`, resulting in the total sales price in the base currency.

**Formatting:**  
- The measure is formatted as currency with the format string: `\$#,0.###############;(\$#,0.###############);\$#,0.###############`.
- It is annotated with `PBI_FormatHint` to specify the currency culture as "en-US".

#### Measure: `PercentageCompleteness`

### DAX Measure: PercentageCompleteness

**Purpose:**  
The `PercentageCompleteness` measure calculates the completeness of reported hours against expected contracted hours for employees. It provides insight into how much of the expected workload has been accounted for in terms of missing hours.

**Formula:**  
```DAX
DIVIDE(
    SUM(vw_missing_timesheet[MissingHours]) - [ExpectedContractHoursWeekly],
    [ExpectedContractHoursWeekly],
    0
)
```

**Explanation:**  
- **Numerator:** The measure subtracts the expected contracted hours (calculated by the `ExpectedContractHoursWeekly` measure) from the total missing hours (summed from the `vw_missing_timesheet` table).
- **Denominator:** The expected contracted hours for the week.
- **Division:** The result is divided to yield a percentage, with a fallback of 0 in case of division by zero.

**Format:**  
The measure is formatted as a general number, allowing for easy interpretation of the completeness percentage.

#### Measure: `Static Total Employees`

### DAX Measure: 'Static Total Employees'

**Purpose:**  
The 'Static Total Employees' measure calculates the distinct count of employees whose contract status is currently valid, disregarding any filters applied to the `vw_Timesheet` table. This measure is useful for obtaining a consistent count of active employees regardless of the current report context.

**Formula:**  
```DAX
CALCULATE(
    DISTINCTCOUNT(vw_Timesheet[EmployeeName]), 
    ALL(vw_Timesheet),
    vw_Timesheet[ContractStatusToday] = "Valid"
)
```

**Format:**  
- Format String: 0 (integer format)

#### Measure: `TotalActualHours`

### DAX Measure: TotalActualHours

**Purpose:**  
The `TotalActualHours` measure calculates the total number of hours recorded in the `vw_Timesheet` table. This measure is essential for analyzing actual work hours against contracted hours and for various performance metrics.

**Formula:**  
```DAX
TotalActualHours = SUM(vw_Timesheet[Hours])
```

**Format Hint:**  
The measure is formatted as a general number, allowing for straightforward numerical representation in reports and dashboards.

#### Measure: `TotalContractedHours`

### DAX Measure: TotalContractedHours

**Purpose:**  
The `TotalContractedHours` measure calculates the total number of contracted hours for all employees by summing the maximum hours per week for each employee. This measure is essential for comparing against actual hours worked to assess performance and utilization.

**Formula:**  
```DAX
TotalContractedHours = 
SUMX(
    VALUES(vw_Timesheet[EmployeeName]),
    MAX(vw_Timesheet[HoursPerWeek])
)
```

**Contextual Relevance:**  
This measure is used in conjunction with other measures such as `TotalActualHours` and `TotalHoursDeltaComplete` to evaluate the difference between actual hours worked and contracted hours, providing insights into employee productivity and contract compliance.

#### Measure: `TotalHoursDeltaComplete`

### DAX Measure: TotalHoursDeltaComplete

**Purpose:**  
The `TotalHoursDeltaComplete` measure calculates the ratio of actual hours worked to contracted hours, providing insight into the completion status of hours relative to what was contracted. This measure is useful for assessing employee productivity and contract adherence.

**Formula:**  
```DAX
TotalHoursDeltaComplete =
    DIVIDE(
        [TotalActualHours],
        [TotalContractedHours],
        0
    )
```

**Format:**  
- Displayed as a percentage with two decimal places (0.00%;-0.00%;0.00%).

**Contextual Dependencies:**  
- **[TotalActualHours]:** This measure sums the total hours recorded in the `vw_Timesheet` table.
- **[TotalContractedHours]:** This measure calculates the maximum contracted hours per week for each employee.

The `DIVIDE` function is used to handle division safely, returning 0 if the denominator is zero.

#### Measure: `TotalHoursDeltaCompleteNr`

### DAX Measure: TotalHoursDeltaCompleteNr

**Purpose:**  
The measure `TotalHoursDeltaCompleteNr` calculates the difference between the total actual hours worked and the total contracted hours for employees. This measure helps in assessing whether the actual hours worked exceed or fall short of the contracted hours.

**Formula:**  
```DAX
[TotalActualHours] - [TotalContractedHours]
```

**Context:**  
- `TotalActualHours` is defined as the sum of hours recorded in the `vw_Timesheet` table.
- `TotalContractedHours` is calculated using `SUMX` to determine the maximum hours per week for each employee.

**Annotation:**  
- PBI_FormatHint: `{"isGeneralNumber":true}` indicates that the measure is formatted as a general number.

#### Measure: `TotalHoursTracked`

### DAX Measure: TotalHoursTracked

**Purpose:**  
The `TotalHoursTracked` measure calculates the total hours recorded in the `vw_Timesheet` table. It ensures that if there are no hours recorded, the measure returns zero instead of a blank value.

**Formula:**  
```DAX
TotalHoursTracked = 
IF (
    ISBLANK(SUM(vw_Timesheet[Hours])),
    0,
    SUM(vw_Timesheet[Hours])
)
```

**Annotation:**  
- **PBI_FormatHint:** `{"isGeneralNumber":true}`

This measure is essential for tracking the total hours worked, providing a clear numeric output for reporting and analysis.

#### Measure: `TotalHoursTrackedMissing`

### DAX Measure: TotalHoursTrackedMissing

**Purpose:**  
The `TotalHoursTrackedMissing` measure is designed to evaluate the total hours tracked in the `vw_Timesheet` table. It specifically checks if the sum of hours is blank and returns a user-friendly message if no hours are recorded.

**Formula:**  
```DAX
TotalHoursTrackedMissing = 
IF (
    ISBLANK(SUM(vw_Timesheet[Hours])),
    "Empty",
    SUM(vw_Timesheet[Hours])
)
```

**Explanation:**  
- The measure uses the `SUM` function to calculate the total hours from the `Hours` column in the `vw_Timesheet` table.
- The `ISBLANK` function checks if the result of the `SUM` is blank (i.e., no hours tracked).
- If the sum is blank, it returns the string "Empty"; otherwise, it returns the total hours tracked. 

This measure is useful for reporting and visualizations where it is important to indicate whether any hours have been recorded or not.

#### Measure: `trackedDiff`

### DAX Measure: `trackedDiff`

**Purpose:**  
The `trackedDiff` measure calculates the difference between the total hours tracked for an employee and the maximum hours per week recorded for that employee, excluding any filters on the `HoursPerWeek` column.

**Formula:**  
```DAX
trackedDiff = 
    [TotalHoursTracked] - 
    CALCULATE(
        MAXX(DISTINCT(vw_Timesheet[HoursPerWeek]), vw_Timesheet[HoursPerWeek]),
        ALLEXCEPT(vw_Timesheet, vw_Timesheet[EmployeeID])
    )
```

**Explanation:**  
- `[TotalHoursTracked]`: This measure sums the hours recorded in the `vw_Timesheet` table, returning 0 if the sum is blank.
- `CALCULATE(...)`: This function modifies the filter context to compute the maximum hours per week for the employee, while ignoring filters on `HoursPerWeek` but retaining filters on `EmployeeID`.
- `MAXX(DISTINCT(...))`: This retrieves the maximum distinct value of `HoursPerWeek` for the employee.

The result of `trackedDiff` indicates how many hours tracked exceed or fall short of the maximum hours per week for that employee.

#### Measure: `trackedDiff2`

### DAX Measure: `trackedDiff2`

**Purpose:**  
The `trackedDiff2` measure calculates the difference between the total hours tracked for an employee and the maximum hours per week recorded in the timesheet, while removing filters on the `HoursPerWeek` column and retaining context for the specific employee.

**Formula:**  
```DAX
trackedDiff2 = 
    [TotalHoursTracked] - 
        CALCULATE(
            MAXX(
                DISTINCT(vw_Timesheet[HoursPerWeek]), 
                vw_Timesheet[HoursPerWeek]
            ),
            REMOVEFILTERS(vw_Timesheet[HoursPerWeek]),
            ALLEXCEPT(vw_Timesheet, vw_Timesheet[EmployeeID])
        )
```

**Key Components:**
- **[TotalHoursTracked]:** Represents the total hours tracked for the employee.
- **CALCULATE:** Modifies the filter context to compute the maximum hours per week.
- **MAXX & DISTINCT:** Retrieves the maximum distinct hours per week.
- **REMOVEFILTERS:** Clears filters on `HoursPerWeek` to ensure the calculation considers all weeks.
- **ALLEXCEPT:** Maintains the filter context for the specific `EmployeeID`.

This measure is useful for assessing discrepancies between tracked hours and the maximum allowable hours per week for each employee.

#### Measure: `UniqueEmployeesPerUnit`

### DAX Measure: UniqueEmployeesPerUnit

**Purpose:**  
The `UniqueEmployeesPerUnit` measure calculates the count of unique employees per unit who have incomplete timesheet entries, as indicated by the `IncompleteFlag`.

**Formula:**  
```DAX
SUMX(
    SUMMARIZE(
        vw_missing_timesheet,
        vw_missing_timesheet[Week_],
        vw_missing_timesheet[EmployeeName],
        vw_missing_timesheet[MAIN_UNIT],
        "IncompleteFlag", MAX(vw_missing_timesheet[IncompleteFlag])
    ),
    [IncompleteFlag]
)
```

**Context:**  
- The measure uses the `SUMMARIZE` function to group data by week, employee name, and main unit, while also capturing the maximum value of the `IncompleteFlag` for each group.
- The `SUMX` function then sums the `IncompleteFlag` values, effectively counting unique employees with incomplete timesheet entries across the specified units.

**Format:**  
- The measure is formatted as a general number (0).

#### Measure: `UTI_TotalBillableHours`

### DAX Measure: `UTI_TotalBillableHours`

**Purpose:**  
The `UTI_TotalBillableHours` measure calculates the total billable hours from the `vw_Timesheet` table, specifically for projects that are marked as billable or qualify for billing. It is used to assess the productivity and utilization of employees on billable projects.

**Formula:**
```DAX
Var FilteredHours =
    Filter(
        vw_Timesheet,
        (
            vw_Timesheet[QualifyPrj] = 1 && 
            vw_Timesheet[BillablePrj] = 1
        ) ||
        SEARCH("Customer Success Services", vw_Timesheet[Project], 1, 0) > 0
    )
RETURN 
    SUMX(FilteredHours, vw_Timesheet[Hours])
```

**Explanation:**
- The measure first creates a variable `FilteredHours` that filters the `vw_Timesheet` table to include only those entries where:
  - The project qualifies for billing (`QualifyPrj = 1`) and is marked as billable (`BillablePrj = 1`), or
  - The project name contains "Customer Success Services".
- It then uses `SUMX` to iterate over the filtered table and sum the `Hours` for the qualifying entries. 

**Format:**  
The result is formatted as a general number (integer).

#### Measure: `UTI_TOTALHOURS`

### Measure: UTI_TOTALHOURS

**Purpose:**  
The `UTI_TOTALHOURS` measure calculates the total hours worked by employees on projects that qualify for specific criteria, specifically where the `QualifyPrj` column is equal to 1.

**Formula:**  
```DAX
UTI_TOTALHOURS = CALCULATE(SUM(vw_Timesheet[Hours]), vw_Timesheet[QualifyPrj] = 1)
```

**Format Hint:**  
- Annotation: `{"isGeneralNumber":true}`

This measure is used to assess the total hours contributed to qualifying projects, aiding in performance and utilization analysis.

#### Measure: `UTILIZATION_New`

### DAX Measure: `UTILIZATION_New`

**Purpose:**  
The `UTILIZATION_New` measure calculates the ratio of billable hours to total hours for active employees, providing insight into employee utilization rates.

**Formula:**
```DAX
VAR _TotalBillableHours = [UTI_TotalBillableHours]
VAR _TotalHours = [UTI_TOTALHOURS]

RETURN
    IF(NOT(ISBLANK([Msr_ActiveContacts])), 
        IF(NOT(ISBLANK([UTI_TOTALHOURS])), 
            IF(ISBLANK(DIVIDE(_TotalBillableHours, _TotalHours)), 0, DIVIDE(_TotalBillableHours, _TotalHours))
        )
    )
```

**Details:**
- **_TotalBillableHours:** This variable retrieves the total billable hours from the `UTI_TotalBillableHours` measure.
- **_TotalHours:** This variable retrieves the total hours from the `UTI_TOTALHOURS` measure.
- The measure checks if there are active contacts and if total hours are not blank before calculating the utilization ratio.
- If the division results in a blank, it returns 0; otherwise, it returns the calculated ratio of billable hours to total hours.

**Format:**  
0.00%;-0.00%;0.00%

### 2.3 Relationships

The following relationships were identified based on explicit definitions:

* `vw_Timesheet`.[`Project`] -> `lkp_Project`.[`Project`]
* `vw_Timesheet`.[`Unit`] -> `lkp_Unit`.[`Organisatorische eenheid`]
* `vw_Timesheet`.[`ProjectCode`] -> `tbl_Project`.[`Project](Type: manyToOne`]
* `vw_Timesheet`.[`TimesheetCode`] -> `lkp_Code`.[`Code`]
* `vw_Timesheet`.[`TimesheetDate`] -> `DimDate`.[`ShortDate`]
* `vw_missing_timesheet`.[`ShortDate`] -> `DimDate`.[`ShortDate`]
* `vw_missing_timesheet`.[`TimesheetCode`] -> `lkp_Code`.[`Code`]
* `vw_missing_timesheet`.[`SubUnit`] -> `lkp_Unit`.[`Organisatorische eenheid`]
* `vw_missing_timesheet`.[`Project`] -> `lkp_Project`.[`Project`]
* `vw_Timesheet`.[`ContractStartDate`] -> `DimDate`.[`ShortDate`]
* `vw_Timesheet`.[`ContractEndDate`] -> `DimDate`.[`ShortDate`]

---

## 3. Visuals (Based on Configuration)

No visuals discovered or documented.

